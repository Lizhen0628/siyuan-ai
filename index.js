"use strict";var rc=Object.defineProperty;var sc=(n,e,t)=>e in n?rc(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Re=(n,e,t)=>sc(n,typeof e!="symbol"?e+"":e,t);const lt=require("siyuan");async function bn(n,e){let t=await lt.fetchSyncPost(n,e);return t.code===0?t.data:null}async function ic(n,e,t,r,s){return bn("/api/block/insertBlock",{dataType:n,data:e,nextID:t,previousID:r,parentID:s})}async function ac(n,e,t){return bn("/api/block/appendBlock",{dataType:n,data:e,parentID:t})}async function oc(n){return bn("/api/block/deleteBlock",{id:n})}async function Ba(n,e=7e3){return bn("/api/notification/pushMsg",{msg:n,timeout:e})}async function La(n,e=7e3){return bn("/api/notification/pushErrMsg",{msg:n,timeout:e})}function Se(){}const $a=n=>n;function Qn(n,e){for(const t in e)n[t]=e[t];return n}function Ua(n){return n()}function bi(){return Object.create(null)}function we(n){n.forEach(Ua)}function hn(n){return typeof n=="function"}function Ae(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let Mn;function lc(n,e){return n===e?!0:(Mn||(Mn=document.createElement("a")),Mn.href=e,n===Mn.href)}function cc(n){return Object.keys(n).length===0}function xs(n,e,t,r){if(n){const s=ja(n,e,t,r);return n[0](s)}}function ja(n,e,t,r){return n[1]&&r?Qn(t.ctx.slice(),n[1](r(e))):t.ctx}function Ms(n,e,t,r){if(n[2]&&r){const s=n[2](r(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const i=[],a=Math.max(e.dirty.length,s.length);for(let o=0;o<a;o+=1)i[o]=e.dirty[o]|s[o];return i}return e.dirty|s}return e.dirty}function Os(n,e,t,r,s,i){if(s){const a=ja(e,t,r,i);n.p(a,s)}}function Ts(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let r=0;r<t;r++)e[r]=-1;return e}return-1}function Si(n){const e={};for(const t in n)t[0]!=="$"&&(e[t]=n[t]);return e}const uc=["",!0,1,"true","contenteditable"],qa=typeof window<"u";let fc=qa?()=>window.performance.now():()=>Date.now(),Is=qa?n=>requestAnimationFrame(n):Se;const Ft=new Set;function Ha(n){Ft.forEach(e=>{e.c(n)||(Ft.delete(e),e.f())}),Ft.size!==0&&Is(Ha)}function dc(n){let e;return Ft.size===0&&Is(Ha),{promise:new Promise(t=>{Ft.add(e={c:n,f:t})}),abort(){Ft.delete(e)}}}function _(n,e){n.appendChild(e)}function Wa(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function hc(n){const e=k("style");return e.textContent="/* empty */",mc(Wa(n),e),e.sheet}function mc(n,e){return _(n.head||n,e),e.sheet}function te(n,e,t){n.insertBefore(e,t||null)}function Z(n){n.parentNode&&n.parentNode.removeChild(n)}function Zn(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function k(n){return document.createElement(n)}function ye(n){return document.createTextNode(n)}function I(){return ye(" ")}function Ns(){return ye("")}function Y(n,e,t,r){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}function pc(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function E(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}const gc=["width","height"];function Ei(n,e){const t=Object.getOwnPropertyDescriptors(n.__proto__);for(const r in e)e[r]==null?n.removeAttribute(r):r==="style"?n.style.cssText=e[r]:r==="__value"?n.value=n[r]=e[r]:t[r]&&t[r].set&&gc.indexOf(r)===-1?n[r]=e[r]:E(n,r,e[r])}function ns(n){return n===""?null:+n}function _c(n){return Array.from(n.childNodes)}function je(n,e){e=""+e,n.data!==e&&(n.data=e)}function yc(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function wc(n,e,t){~uc.indexOf(t)?yc(n,e):je(n,e)}function Fe(n,e){n.value=e??""}function R(n,e,t,r){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,"")}function vi(n,e,t){for(let r=0;r<n.options.length;r+=1){const s=n.options[r];if(s.__value===e){s.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function bc(n){const e=n.querySelector(":checked");return e&&e.__value}function ce(n,e,t){n.classList.toggle(e,!!t)}function Va(n,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:r})}const er=new Map;let tr=0;function Sc(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function Ec(n,e){const t={stylesheet:hc(e),rules:{}};return er.set(n,t),t}function ki(n,e,t,r,s,i,a,o=0){const l=16.666/r;let c=`{
`;for(let g=0;g<=1;g+=l){const A=e+(t-e)*i(g);c+=g*100+`%{${a(A,1-A)}}
`}const f=c+`100% {${a(t,1-t)}}
}`,u=`__svelte_${Sc(f)}_${o}`,h=Wa(n),{stylesheet:m,rules:d}=er.get(h)||Ec(h,n);d[u]||(d[u]=!0,m.insertRule(`@keyframes ${u} ${f}`,m.cssRules.length));const p=n.style.animation||"";return n.style.animation=`${p?`${p}, `:""}${u} ${r}ms linear ${s}ms 1 both`,tr+=1,u}function vc(n,e){const t=(n.style.animation||"").split(", "),r=t.filter(e?i=>i.indexOf(e)<0:i=>i.indexOf("__svelte")===-1),s=t.length-r.length;s&&(n.style.animation=r.join(", "),tr-=s,tr||kc())}function kc(){Is(()=>{tr||(er.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&Z(e)}),er.clear())})}let mn;function cn(n){mn=n}function Fs(){if(!mn)throw new Error("Function called outside component initialization");return mn}function Ja(n){Fs().$$.on_mount.push(n)}function Ac(n){Fs().$$.after_update.push(n)}function mr(){const n=Fs();return(e,t,{cancelable:r=!1}={})=>{const s=n.$$.callbacks[e];if(s){const i=Va(e,t,{cancelable:r});return s.slice().forEach(a=>{a.call(n,i)}),!i.defaultPrevented}return!0}}function Pc(n,e){const t=n.$$.callbacks[e.type];t&&t.slice().forEach(r=>r.call(this,e))}const xt=[],he=[];let Dt=[];const rs=[],Cc=Promise.resolve();let ss=!1;function Rc(){ss||(ss=!0,Cc.then(za))}function vt(n){Dt.push(n)}function xe(n){rs.push(n)}const Tr=new Set;let At=0;function za(){if(At!==0)return;const n=mn;do{try{for(;At<xt.length;){const e=xt[At];At++,cn(e),xc(e.$$)}}catch(e){throw xt.length=0,At=0,e}for(cn(null),xt.length=0,At=0;he.length;)he.pop()();for(let e=0;e<Dt.length;e+=1){const t=Dt[e];Tr.has(t)||(Tr.add(t),t())}Dt.length=0}while(xt.length);for(;rs.length;)rs.pop()();ss=!1,Tr.clear(),cn(n)}function xc(n){if(n.fragment!==null){n.update(),we(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(vt)}}function Mc(n){const e=[],t=[];Dt.forEach(r=>n.indexOf(r)===-1?e.push(r):t.push(r)),t.forEach(r=>r()),Dt=e}let Kt;function Oc(){return Kt||(Kt=Promise.resolve(),Kt.then(()=>{Kt=null})),Kt}function Ir(n,e,t){n.dispatchEvent(Va(`${e?"intro":"outro"}${t}`))}const qn=new Set;let st;function bt(){st={r:0,c:[],p:st}}function St(){st.r||we(st.c),st=st.p}function V(n,e){n&&n.i&&(qn.delete(n),n.i(e))}function X(n,e,t,r){if(n&&n.o){if(qn.has(n))return;qn.add(n),st.c.push(()=>{qn.delete(n),r&&(t&&n.d(1),r())}),n.o(e)}else r&&r()}const Tc={duration:0};function nr(n,e,t,r){let i=e(n,t,{direction:"both"}),a=r?0:1,o=null,l=null,c=null,f;function u(){c&&vc(n,c)}function h(d,p){const g=d.b-a;return p*=Math.abs(g),{a,b:d.b,d:g,duration:p,start:d.start,end:d.start+p,group:d.group}}function m(d){const{delay:p=0,duration:g=300,easing:A=$a,tick:w=Se,css:y}=i||Tc,S={start:fc()+p,b:d};d||(S.group=st,st.r+=1),"inert"in n&&(d?f!==void 0&&(n.inert=f):(f=n.inert,n.inert=!0)),o||l?l=S:(y&&(u(),c=ki(n,a,d,g,p,A,y)),d&&w(0,1),o=h(S,g),vt(()=>Ir(n,d,"start")),dc(b=>{if(l&&b>l.start&&(o=h(l,g),l=null,Ir(n,o.b,"start"),y&&(u(),c=ki(n,a,o.b,o.duration,0,A,i.css))),o){if(b>=o.end)w(a=o.b,1-a),Ir(n,o.b,"end"),l||(o.b?u():--o.group.r||we(o.group.c)),o=null;else if(b>=o.start){const x=b-o.start;a=o.a+o.d*A(x/o.duration),w(a,1-a)}}return!!(o||l)}))}return{run(d){hn(i)?Oc().then(()=>{i=i({direction:d?"in":"out"}),m(d)}):m(d)},end(){u(),o=l=null}}}function He(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Ic(n,e){n.d(1),e.delete(n.key)}function Nc(n,e){X(n,1,1,()=>{e.delete(n.key)})}function Xa(n,e,t,r,s,i,a,o,l,c,f,u){let h=n.length,m=i.length,d=h;const p={};for(;d--;)p[n[d].key]=d;const g=[],A=new Map,w=new Map,y=[];for(d=m;d--;){const C=u(s,i,d),T=t(C);let $=a.get(T);$?y.push(()=>$.p(C,e)):($=c(T,C),$.c()),A.set(T,g[d]=$),T in p&&w.set(T,Math.abs(d-p[T]))}const S=new Set,b=new Set;function x(C){V(C,1),C.m(o,f),a.set(C.key,C),f=C.first,m--}for(;h&&m;){const C=g[m-1],T=n[h-1],$=C.key,N=T.key;C===T?(f=C.first,h--,m--):A.has(N)?!a.has($)||S.has($)?x(C):b.has(N)?h--:w.get($)>w.get(N)?(b.add($),x(C)):(S.add(N),h--):(l(T,a),h--)}for(;h--;){const C=n[h];A.has(C.key)||l(C,a)}for(;m;)x(g[m-1]);return we(y),g}function Fc(n,e){const t={},r={},s={$$scope:1};let i=n.length;for(;i--;){const a=n[i],o=e[i];if(o){for(const l in a)l in o||(r[l]=1);for(const l in o)s[l]||(t[l]=o[l],s[l]=1);n[i]=o}else for(const l in a)s[l]=1}for(const a in r)a in t||(t[a]=void 0);return t}function Me(n,e,t){const r=n.$$.props[e];r!==void 0&&(n.$$.bound[r]=t,t(n.$$.ctx[r]))}function de(n){n&&n.c()}function ue(n,e,t){const{fragment:r,after_update:s}=n.$$;r&&r.m(e,t),vt(()=>{const i=n.$$.on_mount.map(Ua).filter(hn);n.$$.on_destroy?n.$$.on_destroy.push(...i):we(i),n.$$.on_mount=[]}),s.forEach(vt)}function fe(n,e){const t=n.$$;t.fragment!==null&&(Mc(t.after_update),we(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Dc(n,e){n.$$.dirty[0]===-1&&(xt.push(n),Rc(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Pe(n,e,t,r,s,i,a=null,o=[-1]){const l=mn;cn(n);const c=n.$$={fragment:null,ctx:[],props:i,update:Se,not_equal:s,bound:bi(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:bi(),dirty:o,skip_bound:!1,root:e.target||l.$$.root};a&&a(c.root);let f=!1;if(c.ctx=t?t(n,e.props||{},(u,h,...m)=>{const d=m.length?m[0]:h;return c.ctx&&s(c.ctx[u],c.ctx[u]=d)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](d),f&&Dc(n,u)),h}):[],c.update(),f=!0,we(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){const u=_c(e.target);c.fragment&&c.fragment.l(u),u.forEach(Z)}else c.fragment&&c.fragment.c();e.intro&&V(n.$$.fragment),ue(n,e.target,e.anchor),za()}cn(l)}class Ce{constructor(){Re(this,"$$");Re(this,"$$set")}$destroy(){fe(this,1),this.$destroy=Se}$on(e,t){if(!hn(t))return Se;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!cc(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Bc="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Bc);const is="RFC3986",as={RFC1738:n=>String(n).replace(/%20/g,"+"),RFC3986:n=>String(n)},Lc="RFC1738",$c=Array.isArray,Ye=(()=>{const n=[];for(let e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n})(),Nr=1024,Uc=(n,e,t,r,s)=>{if(n.length===0)return n;let i=n;if(typeof n=="symbol"?i=Symbol.prototype.toString.call(n):typeof n!="string"&&(i=String(n)),t==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let a="";for(let o=0;o<i.length;o+=Nr){const l=i.length>=Nr?i.slice(o,o+Nr):i,c=[];for(let f=0;f<l.length;++f){let u=l.charCodeAt(f);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||s===Lc&&(u===40||u===41)){c[c.length]=l.charAt(f);continue}if(u<128){c[c.length]=Ye[u];continue}if(u<2048){c[c.length]=Ye[192|u>>6]+Ye[128|u&63];continue}if(u<55296||u>=57344){c[c.length]=Ye[224|u>>12]+Ye[128|u>>6&63]+Ye[128|u&63];continue}f+=1,u=65536+((u&1023)<<10|l.charCodeAt(f)&1023),c[c.length]=Ye[240|u>>18]+Ye[128|u>>12&63]+Ye[128|u>>6&63]+Ye[128|u&63]}a+=c.join("")}return a};function jc(n){return!n||typeof n!="object"?!1:!!(n.constructor&&n.constructor.isBuffer&&n.constructor.isBuffer(n))}function Ai(n,e){if($c(n)){const t=[];for(let r=0;r<n.length;r+=1)t.push(e(n[r]));return t}return e(n)}const qc=Object.prototype.hasOwnProperty,Ka={brackets(n){return String(n)+"[]"},comma:"comma",indices(n,e){return String(n)+"["+e+"]"},repeat(n){return String(n)}},Ze=Array.isArray,Hc=Array.prototype.push,Ga=function(n,e){Hc.apply(n,Ze(e)?e:[e])},Wc=Date.prototype.toISOString,ge={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Uc,encodeValuesOnly:!1,format:is,formatter:as[is],indices:!1,serializeDate(n){return Wc.call(n)},skipNulls:!1,strictNullHandling:!1};function Vc(n){return typeof n=="string"||typeof n=="number"||typeof n=="boolean"||typeof n=="symbol"||typeof n=="bigint"}const Fr={};function Ya(n,e,t,r,s,i,a,o,l,c,f,u,h,m,d,p,g,A){let w=n,y=A,S=0,b=!1;for(;(y=y.get(Fr))!==void 0&&!b;){const N=y.get(n);if(S+=1,typeof N<"u"){if(N===S)throw new RangeError("Cyclic object value");b=!0}typeof y.get(Fr)>"u"&&(S=0)}if(typeof c=="function"?w=c(e,w):w instanceof Date?w=h==null?void 0:h(w):t==="comma"&&Ze(w)&&(w=Ai(w,function(N){return N instanceof Date?h==null?void 0:h(N):N})),w===null){if(i)return l&&!p?l(e,ge.encoder,g,"key",m):e;w=""}if(Vc(w)||jc(w)){if(l){const N=p?e:l(e,ge.encoder,g,"key",m);return[(d==null?void 0:d(N))+"="+(d==null?void 0:d(l(w,ge.encoder,g,"value",m)))]}return[(d==null?void 0:d(e))+"="+(d==null?void 0:d(String(w)))]}const x=[];if(typeof w>"u")return x;let C;if(t==="comma"&&Ze(w))p&&l&&(w=Ai(w,l)),C=[{value:w.length>0?w.join(",")||null:void 0}];else if(Ze(c))C=c;else{const N=Object.keys(w);C=f?N.sort(f):N}const T=o?String(e).replace(/\./g,"%2E"):String(e),$=r&&Ze(w)&&w.length===1?T+"[]":T;if(s&&Ze(w)&&w.length===0)return $+"[]";for(let N=0;N<C.length;++N){const F=C[N],P=typeof F=="object"&&typeof F.value<"u"?F.value:w[F];if(a&&P===null)continue;const oe=u&&o?F.replace(/\./g,"%2E"):F,U=Ze(w)?typeof t=="function"?t($,oe):$:$+(u?"."+oe:"["+oe+"]");A.set(n,S);const M=new WeakMap;M.set(Fr,A),Ga(x,Ya(P,U,t,r,s,i,a,o,t==="comma"&&p&&Ze(w)?null:l,c,f,u,h,m,d,p,g,M))}return x}function Jc(n=ge){if(typeof n.allowEmptyArrays<"u"&&typeof n.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof n.encodeDotInKeys<"u"&&typeof n.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(n.encoder!==null&&typeof n.encoder<"u"&&typeof n.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=n.charset||ge.charset;if(typeof n.charset<"u"&&n.charset!=="utf-8"&&n.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=is;if(typeof n.format<"u"){if(!qc.call(as,n.format))throw new TypeError("Unknown format option provided.");t=n.format}const r=as[t];let s=ge.filter;(typeof n.filter=="function"||Ze(n.filter))&&(s=n.filter);let i;if(n.arrayFormat&&n.arrayFormat in Ka?i=n.arrayFormat:"indices"in n?i=n.indices?"indices":"repeat":i=ge.arrayFormat,"commaRoundTrip"in n&&typeof n.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const a=typeof n.allowDots>"u"?n.encodeDotInKeys?!0:ge.allowDots:!!n.allowDots;return{addQueryPrefix:typeof n.addQueryPrefix=="boolean"?n.addQueryPrefix:ge.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof n.allowEmptyArrays=="boolean"?!!n.allowEmptyArrays:ge.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof n.charsetSentinel=="boolean"?n.charsetSentinel:ge.charsetSentinel,commaRoundTrip:!!n.commaRoundTrip,delimiter:typeof n.delimiter>"u"?ge.delimiter:n.delimiter,encode:typeof n.encode=="boolean"?n.encode:ge.encode,encodeDotInKeys:typeof n.encodeDotInKeys=="boolean"?n.encodeDotInKeys:ge.encodeDotInKeys,encoder:typeof n.encoder=="function"?n.encoder:ge.encoder,encodeValuesOnly:typeof n.encodeValuesOnly=="boolean"?n.encodeValuesOnly:ge.encodeValuesOnly,filter:s,format:t,formatter:r,serializeDate:typeof n.serializeDate=="function"?n.serializeDate:ge.serializeDate,skipNulls:typeof n.skipNulls=="boolean"?n.skipNulls:ge.skipNulls,sort:typeof n.sort=="function"?n.sort:null,strictNullHandling:typeof n.strictNullHandling=="boolean"?n.strictNullHandling:ge.strictNullHandling}}function zc(n,e={}){let t=n;const r=Jc(e);let s,i;typeof r.filter=="function"?(i=r.filter,t=i("",t)):Ze(r.filter)&&(i=r.filter,s=i);const a=[];if(typeof t!="object"||t===null)return"";const o=Ka[r.arrayFormat],l=o==="comma"&&r.commaRoundTrip;s||(s=Object.keys(t)),r.sort&&s.sort(r.sort);const c=new WeakMap;for(let h=0;h<s.length;++h){const m=s[h];r.skipNulls&&t[m]===null||Ga(a,Ya(t[m],m,o,l,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,c))}const f=a.join(r.delimiter);let u=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?u+="utf8=%26%2310003%3B&":u+="utf8=%E2%9C%93&"),f.length>0?u+f:""}const Mt="4.78.1";let Pi=!1,un,Qa,Za,os,eo,to,no,ro,so;function Xc(n,e={auto:!1}){if(Pi)throw new Error(`you must \`import 'openai/shims/${n.kind}'\` before importing anything else from openai`);if(un)throw new Error(`can't \`import 'openai/shims/${n.kind}'\` after \`import 'openai/shims/${un}'\``);Pi=e.auto,un=n.kind,Qa=n.fetch,Za=n.FormData,os=n.File,eo=n.ReadableStream,to=n.getMultipartRequestOptions,no=n.getDefaultAgent,ro=n.fileFromPath,so=n.isFsReadStream}let Kc=class{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};function Gc({manuallyImported:n}={}){const e=n?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,r,s,i;try{t=fetch,r=Request,s=Response,i=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:t,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new Kc(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:a=>!1}}un||Xc(Gc(),{auto:!0});class G extends Error{}let De=class ls extends G{constructor(e,t,r,s){super(`${ls.makeMessage(e,t,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"],this.error=t;const i=t;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,t,r){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,r,s){if(!e||!s)return new pr({message:r,cause:fs(t)});const i=t==null?void 0:t.error;return e===400?new io(e,i,r,s):e===401?new ao(e,i,r,s):e===403?new oo(e,i,r,s):e===404?new lo(e,i,r,s):e===409?new co(e,i,r,s):e===422?new uo(e,i,r,s):e===429?new fo(e,i,r,s):e>=500?new ho(e,i,r,s):new ls(e,i,r,s)}},Je=class extends De{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},pr=class extends De{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}},Ds=class extends pr{constructor({message:e}={}){super({message:e??"Request timed out."})}},io=class extends De{},ao=class extends De{},oo=class extends De{},lo=class extends De{},co=class extends De{},uo=class extends De{},fo=class extends De{},ho=class extends De{};class mo extends G{constructor(){super("Could not parse response content as the length limit was reached")}}class po extends G{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}let gr=class cs{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const r=cs.NEWLINE_CHARS.has(t[t.length-1]||"");let s=t.split(cs.NEWLINE_REGEXP);return r&&s.pop(),s.length===1&&!r?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),r||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new G(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new G(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new G("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}};gr.NEWLINE_CHARS=new Set([`
`,"\r"]);gr.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let pn=class tn{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const a of Yc(e,t))if(!i){if(a.data.startsWith("[DONE]")){i=!0;continue}if(a.event===null){let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(o&&o.error)throw new De(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(a.event=="error")throw new De(void 0,o.error,o.message,void 0);yield{event:a.event,data:o}}}i=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{i||t.abort()}}return new tn(s,t)}static fromReadableStream(e,t){let r=!1;async function*s(){const a=new gr,o=go(e);for await(const l of o)for(const c of a.decode(l))yield c;for(const l of a.flush())yield l}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(const o of s())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||t.abort()}}return new tn(i,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const a=r.next();e.push(a),t.push(a)}return i.shift()}});return[new tn(()=>s(e),this.controller),new tn(()=>s(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new eo({async start(){t=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:a}=await t.next();if(a)return s.close();const o=r.encode(JSON.stringify(i)+`
`);s.enqueue(o)}catch(i){s.error(i)}},async cancel(){var s;await((s=t.return)==null?void 0:s.call(t))}})}};async function*Yc(n,e){if(!n.body)throw e.abort(),new G("Attempted to iterate over a response with no body");const t=new eu,r=new gr,s=go(n.body);for await(const i of Qc(s))for(const a of r.decode(i)){const o=t.decode(a);o&&(yield o)}for(const i of r.flush()){const a=t.decode(i);a&&(yield a)}}async function*Qc(n){let e=new Uint8Array;for await(const t of n){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=Zc(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}function Zc(n){for(let r=0;r<n.length-2;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}let eu=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,s]=tu(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}};function tu(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}function go(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const _o=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function",yo=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&_r(n),_r=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",nu=n=>yo(n)||_o(n)||so(n);async function wo(n,e,t){var s;if(n=await n,yo(n))return n;if(_o(n)){const i=await n.blob();e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=_r(i)?[await i.arrayBuffer()]:[i];return new os(a,e,t)}const r=await ru(n);if(e||(e=iu(n)??"unknown_file"),!(t!=null&&t.type)){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(t={...t,type:i})}return new os(r,e,t)}async function ru(n){var t;let e=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)e.push(n);else if(_r(n))e.push(await n.arrayBuffer());else if(au(n))for await(const r of n)e.push(r);else throw new Error(`Unexpected data type: ${typeof n}; constructor: ${(t=n==null?void 0:n.constructor)==null?void 0:t.name}; props: ${su(n)}`);return e}function su(n){return`[${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}function iu(n){var e;return Dr(n.name)||Dr(n.filename)||((e=Dr(n.path))==null?void 0:e.split(/[\\/]/).pop())}const Dr=n=>{if(typeof n=="string")return n;if(typeof Buffer<"u"&&n instanceof Buffer)return String(n)},au=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function",Ci=n=>n&&typeof n=="object"&&n.body&&n[Symbol.toStringTag]==="MultipartBody",jt=async n=>{const e=await ou(n.body);return to(e,n)},ou=async n=>{const e=new Za;return await Promise.all(Object.entries(n||{}).map(([t,r])=>us(e,t,r))),e},us=async(n,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")n.append(e,String(t));else if(nu(t)){const r=await wo(t);n.append(e,r)}else if(Array.isArray(t))await Promise.all(t.map(r=>us(n,e+"[]",r)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([r,s])=>us(n,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var lu=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},cu=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},On;async function bo(n){const{response:e}=n;if(n.options.stream)return Bt("response",e.status,e.url,e.headers,e.body),n.options.__streamClass?n.options.__streamClass.fromSSEResponse(e,n.controller):pn.fromSSEResponse(e,n.controller);if(e.status===204)return null;if(n.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const i=await e.json();return Bt("response",e.status,e.url,e.headers,i),So(i,e)}const s=await e.text();return Bt("response",e.status,e.url,e.headers,s),s}function So(n,e){return!n||typeof n!="object"||Array.isArray(n)?n:Object.defineProperty(n,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}let Eo=class vo extends Promise{constructor(e,t=bo){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new vo(this.responsePromise,async t=>So(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}},uu=class{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=Br("maxRetries",t),this.timeout=Br("timeout",r),this.httpAgent=s,this.fetch=i??Qa}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...gu(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${bu()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&_r(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:t,...s,body:i}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var p;const{method:r,path:s,query:i,headers:a={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:Ci(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(o),c=this.buildURL(s,i);"timeout"in e&&Br("timeout",e.timeout);const f=e.timeout??this.timeout,u=e.httpAgent??this.httpAgent??no(c),h=f+1e3;typeof((p=u==null?void 0:u.options)==null?void 0:p.timeout)=="number"&&h>(u.options.timeout??0)&&(u.options.timeout=h),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const m=this.buildHeaders({options:e,headers:a,contentLength:l,retryCount:t});return{req:{method:r,...o&&{body:o},headers:m,...u&&{agent:u},signal:e.signal??null},url:c,timeout:f}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:s}){const i={};r&&(i["content-length"]=r);const a=this.defaultHeaders(e);return Oi(i,a),Oi(i,t),Ci(e.body)&&un!=="node"&&delete i["content-type"],Ti(a,"x-stainless-retry-count")===void 0&&Ti(t,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),this.validateHeaders(i,t),i}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,r,s){return De.generate(e,t,r,s)}request(e,t=null){return new Eo(this.makeRequest(e,t))}async makeRequest(e,t){var u,h;const r=await e,s=r.maxRetries??this.maxRetries;t==null&&(t=s),await this.prepareOptions(r);const{req:i,url:a,timeout:o}=this.buildRequest(r,{retryCount:s-t});if(await this.prepareRequest(i,{url:a,options:r}),Bt("request",a,r,i.headers),(u=r.signal)!=null&&u.aborted)throw new Je;const l=new AbortController,c=await this.fetchWithTimeout(a,i,o,l).catch(fs);if(c instanceof Error){if((h=r.signal)!=null&&h.aborted)throw new Je;if(t)return this.retryRequest(r,t);throw c.name==="AbortError"?new Ds:new pr({cause:c})}const f=du(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const w=`retrying, ${t} attempts remaining`;return Bt(`response (error; ${w})`,c.status,a,f),this.retryRequest(r,t,f)}const m=await c.text().catch(w=>fs(w).message),d=_u(m),p=d?void 0:m;throw Bt(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,a,f,p),this.makeStatusError(c.status,d,p,f)}return{response:c,options:r,controller:l}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new fu(this,r,e)}buildURL(e,t){const r=wu(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return Ao(s)||(t={...s,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new G(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,s){const{signal:i,...a}=t||{};i&&i.addEventListener("abort",()=>s.abort());const o=setTimeout(()=>s.abort(),r),l={signal:s.signal,...a};return l.method&&(l.method=l.method.toUpperCase()),this.fetch.call(void 0,e,l).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(s=o)}const a=r==null?void 0:r["retry-after"];if(a&&!s){const o=parseFloat(a);Number.isNaN(o)?s=Date.parse(a)-Date.now():s=o*1e3}if(!(s&&0<=s&&s<60*1e3)){const o=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,o)}return await Sn(s),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const i=t-e,a=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Mt}`}},ko=class{constructor(e,t,r,s){On.set(this,void 0),lu(this,On,e,"f"),this.options=s,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new G("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);t.query=void 0,t.path=e.url.toString()}return await cu(this,On,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(On=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}},fu=class extends Eo{constructor(e,t,r){super(t,async s=>new r(e,s.response,await bo(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}};const du=n=>new Proxy(Object.fromEntries(n.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),hu={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},Be=n=>typeof n=="object"&&n!==null&&!Ao(n)&&Object.keys(n).every(e=>Po(hu,e)),mu=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Mt,"X-Stainless-OS":xi(Deno.build.os),"X-Stainless-Arch":Ri(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Mt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Mt,"X-Stainless-OS":xi(process.platform),"X-Stainless-Arch":Ri(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const n=pu();return n?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Mt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${n.browser}`,"X-Stainless-Runtime-Version":n.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Mt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function pu(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const r=t.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,a=r[3]||0;return{browser:e,version:`${s}.${i}.${a}`}}}return null}const Ri=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",xi=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Mi;const gu=()=>Mi??(Mi=mu()),_u=n=>{try{return JSON.parse(n)}catch{return}},yu=/^[a-z][a-z0-9+.-]*:/i,wu=n=>yu.test(n),Sn=n=>new Promise(e=>setTimeout(e,n)),Br=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new G(`${n} must be an integer`);if(e<0)throw new G(`${n} must be a positive integer`);return e},fs=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null)try{return new Error(JSON.stringify(n))}catch{}return new Error(n)},Tn=n=>{var e,t,r,s,i;if(typeof process<"u")return((t=(e=process.env)==null?void 0:e[n])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(i=(s=(r=Deno.env)==null?void 0:r.get)==null?void 0:s.call(r,n))==null?void 0:i.trim()};function Ao(n){if(!n)return!0;for(const e in n)return!1;return!0}function Po(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Oi(n,e){for(const t in e){if(!Po(e,t))continue;const r=t.toLowerCase();if(!r)continue;const s=e[t];s===null?delete n[r]:s!==void 0&&(n[r]=s)}}function Bt(n,...e){var t;typeof process<"u"&&((t=process==null?void 0:process.env)==null?void 0:t.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${n}`,...e)}const bu=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)}),Su=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Eu=n=>typeof(n==null?void 0:n.get)=="function",Ti=(n,e)=>{var r;const t=e.toLowerCase();if(Eu(n)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,a,o)=>a+o.toUpperCase());for(const i of[e,t,e.toUpperCase(),s]){const a=n.get(i);if(a)return a}}for(const[s,i]of Object.entries(n))if(s.toLowerCase()===t)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i};function Lr(n){return n!=null&&typeof n=="object"&&!Array.isArray(n)}let vu=class extends ko{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}};class Xe extends ko{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const t=(r=e[e.length-1])==null?void 0:r.id;return t?{params:{after:t}}:null}}let ne=class{constructor(e){this._client=e}},Co=class extends ne{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},Bs=class extends ne{constructor(){super(...arguments),this.completions=new Co(this._client)}};Bs.Completions=Co;class Ro extends ne{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}class xo extends ne{create(e,t){return this._client.post("/audio/transcriptions",jt({body:e,...t}))}}class Mo extends ne{create(e,t){return this._client.post("/audio/translations",jt({body:e,...t}))}}class En extends ne{constructor(){super(...arguments),this.transcriptions=new xo(this._client),this.translations=new Mo(this._client),this.speech=new Ro(this._client)}}En.Transcriptions=xo;En.Translations=Mo;En.Speech=Ro;let Ls=class extends ne{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return Be(e)?this.list({},e):this._client.getAPIList("/batches",$s,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}};class $s extends Xe{}Ls.BatchesPage=$s;class Us extends ne{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/assistants/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return Be(e)?this.list({},e):this._client.getAPIList("/assistants",js,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class js extends Xe{}Us.AssistantsPage=js;function Ii(n){return typeof n.parse=="function"}const Lt=n=>(n==null?void 0:n.role)==="assistant",Oo=n=>(n==null?void 0:n.role)==="function",To=n=>(n==null?void 0:n.role)==="tool";var We=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},le=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},ds,Hn,Wn,nn,rn,Vn,sn,rt,an,rr,sr,Ot,Io;class No{constructor(){ds.add(this),this.controller=new AbortController,Hn.set(this,void 0),Wn.set(this,()=>{}),nn.set(this,()=>{}),rn.set(this,void 0),Vn.set(this,()=>{}),sn.set(this,()=>{}),rt.set(this,{}),an.set(this,!1),rr.set(this,!1),sr.set(this,!1),Ot.set(this,!1),We(this,Hn,new Promise((e,t)=>{We(this,Wn,e,"f"),We(this,nn,t,"f")}),"f"),We(this,rn,new Promise((e,t)=>{We(this,Vn,e,"f"),We(this,sn,t,"f")}),"f"),le(this,Hn,"f").catch(()=>{}),le(this,rn,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},le(this,ds,"m",Io).bind(this))},0)}_connected(){this.ended||(le(this,Wn,"f").call(this),this._emit("connect"))}get ended(){return le(this,an,"f")}get errored(){return le(this,rr,"f")}get aborted(){return le(this,sr,"f")}abort(){this.controller.abort()}on(e,t){return(le(this,rt,"f")[e]||(le(this,rt,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=le(this,rt,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===t);return s>=0&&r.splice(s,1),this}once(e,t){return(le(this,rt,"f")[e]||(le(this,rt,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{We(this,Ot,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){We(this,Ot,!0,"f"),await le(this,rn,"f")}_emit(e,...t){if(le(this,an,"f"))return;e==="end"&&(We(this,an,!0,"f"),le(this,Vn,"f").call(this));const r=le(this,rt,"f")[e];if(r&&(le(this,rt,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...t))),e==="abort"){const s=t[0];!le(this,Ot,"f")&&!(r!=null&&r.length)&&Promise.reject(s),le(this,nn,"f").call(this,s),le(this,sn,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=t[0];!le(this,Ot,"f")&&!(r!=null&&r.length)&&Promise.reject(s),le(this,nn,"f").call(this,s),le(this,sn,"f").call(this,s),this._emit("end")}}_emitFinal(){}}Hn=new WeakMap,Wn=new WeakMap,nn=new WeakMap,rn=new WeakMap,Vn=new WeakMap,sn=new WeakMap,rt=new WeakMap,an=new WeakMap,rr=new WeakMap,sr=new WeakMap,Ot=new WeakMap,ds=new WeakSet,Io=function(e){if(We(this,rr,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Je),e instanceof Je)return We(this,sr,!0,"f"),this._emit("abort",e);if(e instanceof G)return this._emit("error",e);if(e instanceof Error){const t=new G(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new G(String(e)))};function Fo(n){return(n==null?void 0:n.$brand)==="auto-parseable-response-format"}function vn(n){return(n==null?void 0:n.$brand)==="auto-parseable-tool"}function ku(n,e){return!e||!Do(e)?{...n,choices:n.choices.map(t=>({...t,message:{...t.message,parsed:null,tool_calls:t.message.tool_calls??[]}}))}:qs(n,e)}function qs(n,e){const t=n.choices.map(r=>{var s;if(r.finish_reason==="length")throw new mo;if(r.finish_reason==="content_filter")throw new po;return{...r,message:{...r.message,tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(i=>Pu(e,i)))??[],parsed:r.message.content&&!r.message.refusal?Au(e,r.message.content):null}}});return{...n,choices:t}}function Au(n,e){var t,r;return((t=n.response_format)==null?void 0:t.type)!=="json_schema"?null:((r=n.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in n.response_format?n.response_format.$parseRaw(e):JSON.parse(e):null}function Pu(n,e){var r;const t=(r=n.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:vn(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function Cu(n,e){var r;if(!n)return!1;const t=(r=n.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return vn(t)||(t==null?void 0:t.function.strict)||!1}function Do(n){var e;return Fo(n.response_format)?!0:((e=n.tools)==null?void 0:e.some(t=>vn(t)||t.type==="function"&&t.function.strict===!0))??!1}function Ru(n){for(const e of n??[]){if(e.type!=="function")throw new G(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new G(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Ie=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Ee,hs,ir,ms,ps,gs,Bo,_s;const Ni=10;class Lo extends No{constructor(){super(...arguments),Ee.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(r=e.choices[0])==null?void 0:r.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(Oo(e)||To(e))&&e.content)this._emit("functionCallResult",e.content);else if(Lt(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Lt(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new G("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),Ie(this,Ee,"m",hs).call(this)}async finalMessage(){return await this.done(),Ie(this,Ee,"m",ir).call(this)}async finalFunctionCall(){return await this.done(),Ie(this,Ee,"m",ms).call(this)}async finalFunctionCallResult(){return await this.done(),Ie(this,Ee,"m",ps).call(this)}async totalUsage(){return await this.done(),Ie(this,Ee,"m",gs).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=Ie(this,Ee,"m",ir).call(this);t&&this._emit("finalMessage",t);const r=Ie(this,Ee,"m",hs).call(this);r&&this._emit("finalContent",r);const s=Ie(this,Ee,"m",ms).call(this);s&&this._emit("finalFunctionCall",s);const i=Ie(this,Ee,"m",ps).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",Ie(this,Ee,"m",gs).call(this))}async _createChatCompletion(e,t,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Ie(this,Ee,"m",Bo).call(this,t);const i=await e.chat.completions.create({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(qs(i,t))}async _runChatCompletion(e,t,r){for(const s of t.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,t,r)}async _runFunctions(e,t,r){var h;const s="function",{function_call:i="auto",stream:a,...o}=t,l=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:c=Ni}=r||{},f={};for(const m of t.functions)f[m.name||m.function.name]=m;const u=t.functions.map(m=>({name:m.name||m.function.name,parameters:m.parameters,description:m.description}));for(const m of t.messages)this._addMessage(m,!1);for(let m=0;m<c;++m){const p=(h=(await this._createChatCompletion(e,{...o,function_call:i,functions:u,messages:[...this.messages]},r)).choices[0])==null?void 0:h.message;if(!p)throw new G("missing message in ChatCompletion response");if(!p.function_call)return;const{name:g,arguments:A}=p.function_call,w=f[g];if(w){if(l&&l!==g){const x=`Invalid function_call: ${JSON.stringify(g)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:s,name:g,content:x});continue}}else{const x=`Invalid function_call: ${JSON.stringify(g)}. Available options are: ${u.map(C=>JSON.stringify(C.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:g,content:x});continue}let y;try{y=Ii(w)?await w.parse(A):A}catch(x){this._addMessage({role:s,name:g,content:x instanceof Error?x.message:String(x)});continue}const S=await w.function(y,this),b=Ie(this,Ee,"m",_s).call(this,S);if(this._addMessage({role:s,name:g,content:b}),l)return}}async _runTools(e,t,r){var m,d,p;const s="tool",{tool_choice:i="auto",stream:a,...o}=t,l=typeof i!="string"&&((m=i==null?void 0:i.function)==null?void 0:m.name),{maxChatCompletions:c=Ni}=r||{},f=t.tools.map(g=>{if(vn(g)){if(!g.$callback)throw new G("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:g.$callback,name:g.function.name,description:g.function.description||"",parameters:g.function.parameters,parse:g.$parseRaw,strict:!0}}}return g}),u={};for(const g of f)g.type==="function"&&(u[g.function.name||g.function.function.name]=g.function);const h="tools"in t?f.map(g=>g.type==="function"?{type:"function",function:{name:g.function.name||g.function.function.name,parameters:g.function.parameters,description:g.function.description,strict:g.function.strict}}:g):void 0;for(const g of t.messages)this._addMessage(g,!1);for(let g=0;g<c;++g){const w=(d=(await this._createChatCompletion(e,{...o,tool_choice:i,tools:h,messages:[...this.messages]},r)).choices[0])==null?void 0:d.message;if(!w)throw new G("missing message in ChatCompletion response");if(!((p=w.tool_calls)!=null&&p.length))return;for(const y of w.tool_calls){if(y.type!=="function")continue;const S=y.id,{name:b,arguments:x}=y.function,C=u[b];if(C){if(l&&l!==b){const F=`Invalid tool_call: ${JSON.stringify(b)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:s,tool_call_id:S,content:F});continue}}else{const F=`Invalid tool_call: ${JSON.stringify(b)}. Available options are: ${Object.keys(u).map(P=>JSON.stringify(P)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:S,content:F});continue}let T;try{T=Ii(C)?await C.parse(x):x}catch(F){const P=F instanceof Error?F.message:String(F);this._addMessage({role:s,tool_call_id:S,content:P});continue}const $=await C.function(T,this),N=Ie(this,Ee,"m",_s).call(this,$);if(this._addMessage({role:s,tool_call_id:S,content:N}),l)return}}}}Ee=new WeakSet,hs=function(){return Ie(this,Ee,"m",ir).call(this).content??null},ir=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Lt(t)){const{function_call:r,...s}=t,i={...s,content:t.content??null,refusal:t.refusal??null};return r&&(i.function_call=r),i}}throw new G("stream ended without producing a ChatCompletionMessage with role=assistant")},ms=function(){var e,t;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(Lt(s)&&(s!=null&&s.function_call))return s.function_call;if(Lt(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(t=s.tool_calls.at(-1))==null?void 0:t.function}},ps=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Oo(t)&&t.content!=null||To(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===t.tool_call_id))}))return t.content}},gs=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Bo=function(e){if(e.n!=null&&e.n>1)throw new G("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},_s=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class gn extends Lo{static runFunctions(e,t,r){const s=new gn,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,i)),s}static runTools(e,t,r){const s=new gn,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,i)),s}_addMessage(e,t=!0){super._addMessage(e,t),Lt(e)&&e.content&&this._emit("content",e.content)}}const $o=1,Uo=2,jo=4,qo=8,Ho=16,Wo=32,Vo=64,Jo=128,zo=256,Xo=Jo|zo,Ko=Ho|Wo|Xo|Vo,Go=$o|Uo|Ko,Yo=jo|qo,xu=Go|Yo,_e={STR:$o,NUM:Uo,ARR:jo,OBJ:qo,NULL:Ho,BOOL:Wo,NAN:Vo,INFINITY:Jo,MINUS_INFINITY:zo,INF:Xo,SPECIAL:Ko,ATOM:Go,COLLECTION:Yo,ALL:xu};class Mu extends Error{}class Ou extends Error{}function Tu(n,e=_e.ALL){if(typeof n!="string")throw new TypeError(`expecting str, got ${typeof n}`);if(!n.trim())throw new Error(`${n} is empty`);return Iu(n.trim(),e)}const Iu=(n,e)=>{const t=n.length;let r=0;const s=h=>{throw new Mu(`${h} at position ${r}`)},i=h=>{throw new Ou(`${h} at position ${r}`)},a=()=>(u(),r>=t&&s("Unexpected end of input"),n[r]==='"'?o():n[r]==="{"?l():n[r]==="["?c():n.substring(r,r+4)==="null"||_e.NULL&e&&t-r<4&&"null".startsWith(n.substring(r))?(r+=4,null):n.substring(r,r+4)==="true"||_e.BOOL&e&&t-r<4&&"true".startsWith(n.substring(r))?(r+=4,!0):n.substring(r,r+5)==="false"||_e.BOOL&e&&t-r<5&&"false".startsWith(n.substring(r))?(r+=5,!1):n.substring(r,r+8)==="Infinity"||_e.INFINITY&e&&t-r<8&&"Infinity".startsWith(n.substring(r))?(r+=8,1/0):n.substring(r,r+9)==="-Infinity"||_e.MINUS_INFINITY&e&&1<t-r&&t-r<9&&"-Infinity".startsWith(n.substring(r))?(r+=9,-1/0):n.substring(r,r+3)==="NaN"||_e.NAN&e&&t-r<3&&"NaN".startsWith(n.substring(r))?(r+=3,NaN):f()),o=()=>{const h=r;let m=!1;for(r++;r<t&&(n[r]!=='"'||m&&n[r-1]==="\\");)m=n[r]==="\\"?!m:!1,r++;if(n.charAt(r)=='"')try{return JSON.parse(n.substring(h,++r-Number(m)))}catch(d){i(String(d))}else if(_e.STR&e)try{return JSON.parse(n.substring(h,r-Number(m))+'"')}catch{return JSON.parse(n.substring(h,n.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},l=()=>{r++,u();const h={};try{for(;n[r]!=="}";){if(u(),r>=t&&_e.OBJ&e)return h;const m=o();u(),r++;try{const d=a();Object.defineProperty(h,m,{value:d,writable:!0,enumerable:!0,configurable:!0})}catch(d){if(_e.OBJ&e)return h;throw d}u(),n[r]===","&&r++}}catch{if(_e.OBJ&e)return h;s("Expected '}' at end of object")}return r++,h},c=()=>{r++;const h=[];try{for(;n[r]!=="]";)h.push(a()),u(),n[r]===","&&r++}catch{if(_e.ARR&e)return h;s("Expected ']' at end of array")}return r++,h},f=()=>{if(r===0){n==="-"&&_e.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n)}catch(m){if(_e.NUM&e)try{return n[n.length-1]==="."?JSON.parse(n.substring(0,n.lastIndexOf("."))):JSON.parse(n.substring(0,n.lastIndexOf("e")))}catch{}i(String(m))}}const h=r;for(n[r]==="-"&&r++;n[r]&&!",]}".includes(n[r]);)r++;r==t&&!(_e.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(n.substring(h,r))}catch{n.substring(h,r)==="-"&&_e.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n.substring(h,n.lastIndexOf("e")))}catch(d){i(String(d))}}},u=()=>{for(;r<t&&` 
\r	`.includes(n[r]);)r++};return a()},Fi=n=>Tu(n,_e.ALL^_e.NUM);var Pt=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},re=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},pe,tt,Ct,at,$r,In,Ur,jr,qr,Nn,Hr,Di;class _n extends Lo{constructor(e){super(),pe.add(this),tt.set(this,void 0),Ct.set(this,void 0),at.set(this,void 0),Pt(this,tt,e,"f"),Pt(this,Ct,[],"f")}get currentChatCompletionSnapshot(){return re(this,at,"f")}static fromReadableStream(e){const t=new _n(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){const s=new _n(t);return s._run(()=>s._runChatCompletion(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,t,r){var a;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),re(this,pe,"m",$r).call(this);const i=await e.chat.completions.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const o of i)re(this,pe,"m",Ur).call(this,o);if((a=i.controller.signal)!=null&&a.aborted)throw new Je;return this._addChatCompletion(re(this,pe,"m",Nn).call(this))}async _fromReadableStream(e,t){var a;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),re(this,pe,"m",$r).call(this),this._connected();const s=pn.fromReadableStream(e,this.controller);let i;for await(const o of s)i&&i!==o.id&&this._addChatCompletion(re(this,pe,"m",Nn).call(this)),re(this,pe,"m",Ur).call(this,o),i=o.id;if((a=s.controller.signal)!=null&&a.aborted)throw new Je;return this._addChatCompletion(re(this,pe,"m",Nn).call(this))}[(tt=new WeakMap,Ct=new WeakMap,at=new WeakMap,pe=new WeakSet,$r=function(){this.ended||Pt(this,at,void 0,"f")},In=function(t){let r=re(this,Ct,"f")[t.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},re(this,Ct,"f")[t.index]=r,r)},Ur=function(t){var s,i,a,o,l,c,f,u,h,m,d,p,g,A,w;if(this.ended)return;const r=re(this,pe,"m",Di).call(this,t);this._emit("chunk",t,r);for(const y of t.choices){const S=r.choices[y.index];y.delta.content!=null&&((s=S.message)==null?void 0:s.role)==="assistant"&&((i=S.message)!=null&&i.content)&&(this._emit("content",y.delta.content,S.message.content),this._emit("content.delta",{delta:y.delta.content,snapshot:S.message.content,parsed:S.message.parsed})),y.delta.refusal!=null&&((a=S.message)==null?void 0:a.role)==="assistant"&&((o=S.message)!=null&&o.refusal)&&this._emit("refusal.delta",{delta:y.delta.refusal,snapshot:S.message.refusal}),((l=y.logprobs)==null?void 0:l.content)!=null&&((c=S.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(f=y.logprobs)==null?void 0:f.content,snapshot:((u=S.logprobs)==null?void 0:u.content)??[]}),((h=y.logprobs)==null?void 0:h.refusal)!=null&&((m=S.message)==null?void 0:m.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(d=y.logprobs)==null?void 0:d.refusal,snapshot:((p=S.logprobs)==null?void 0:p.refusal)??[]});const b=re(this,pe,"m",In).call(this,S);S.finish_reason&&(re(this,pe,"m",qr).call(this,S),b.current_tool_call_index!=null&&re(this,pe,"m",jr).call(this,S,b.current_tool_call_index));for(const x of y.delta.tool_calls??[])b.current_tool_call_index!==x.index&&(re(this,pe,"m",qr).call(this,S),b.current_tool_call_index!=null&&re(this,pe,"m",jr).call(this,S,b.current_tool_call_index)),b.current_tool_call_index=x.index;for(const x of y.delta.tool_calls??[]){const C=(g=S.message.tool_calls)==null?void 0:g[x.index];C!=null&&C.type&&((C==null?void 0:C.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(A=C.function)==null?void 0:A.name,index:x.index,arguments:C.function.arguments,parsed_arguments:C.function.parsed_arguments,arguments_delta:((w=x.function)==null?void 0:w.arguments)??""}):(C==null||C.type,void 0))}}},jr=function(t,r){var a,o,l;if(re(this,pe,"m",In).call(this,t).done_tool_calls.has(r))return;const i=(a=t.message.tool_calls)==null?void 0:a[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const c=(l=(o=re(this,tt,"f"))==null?void 0:o.tools)==null?void 0:l.find(f=>f.type==="function"&&f.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:vn(c)?c.$parseRaw(i.function.arguments):c!=null&&c.function.strict?JSON.parse(i.function.arguments):null})}else i.type},qr=function(t){var s,i;const r=re(this,pe,"m",In).call(this,t);if(t.message.content&&!r.content_done){r.content_done=!0;const a=re(this,pe,"m",Hr).call(this);this._emit("content.done",{content:t.message.content,parsed:a?a.$parseRaw(t.message.content):null})}t.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(s=t.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(i=t.logprobs)!=null&&i.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},Nn=function(){if(this.ended)throw new G("stream has ended, this shouldn't happen");const t=re(this,at,"f");if(!t)throw new G("request ended without sending any chunks");return Pt(this,at,void 0,"f"),Pt(this,Ct,[],"f"),Nu(t,re(this,tt,"f"))},Hr=function(){var r;const t=(r=re(this,tt,"f"))==null?void 0:r.response_format;return Fo(t)?t:null},Di=function(t){var r,s,i,a;let o=re(this,at,"f");const{choices:l,...c}=t;o?Object.assign(o,c):o=Pt(this,at,{...c,choices:[]},"f");for(const{delta:f,finish_reason:u,index:h,logprobs:m=null,...d}of t.choices){let p=o.choices[h];if(p||(p=o.choices[h]={finish_reason:u,index:h,message:{},logprobs:m,...d}),m)if(!p.logprobs)p.logprobs=Object.assign({},m);else{const{content:x,refusal:C,...T}=m;Object.assign(p.logprobs,T),x&&((r=p.logprobs).content??(r.content=[]),p.logprobs.content.push(...x)),C&&((s=p.logprobs).refusal??(s.refusal=[]),p.logprobs.refusal.push(...C))}if(u&&(p.finish_reason=u,re(this,tt,"f")&&Do(re(this,tt,"f")))){if(u==="length")throw new mo;if(u==="content_filter")throw new po}if(Object.assign(p,d),!f)continue;const{content:g,refusal:A,function_call:w,role:y,tool_calls:S,...b}=f;if(Object.assign(p.message,b),A&&(p.message.refusal=(p.message.refusal||"")+A),y&&(p.message.role=y),w&&(p.message.function_call?(w.name&&(p.message.function_call.name=w.name),w.arguments&&((i=p.message.function_call).arguments??(i.arguments=""),p.message.function_call.arguments+=w.arguments)):p.message.function_call=w),g&&(p.message.content=(p.message.content||"")+g,!p.message.refusal&&re(this,pe,"m",Hr).call(this)&&(p.message.parsed=Fi(p.message.content))),S){p.message.tool_calls||(p.message.tool_calls=[]);for(const{index:x,id:C,type:T,function:$,...N}of S){const F=(a=p.message.tool_calls)[x]??(a[x]={});Object.assign(F,N),C&&(F.id=C),T&&(F.type=T),$&&(F.function??(F.function={name:$.name??"",arguments:""})),$!=null&&$.name&&(F.function.name=$.name),$!=null&&$.arguments&&(F.function.arguments+=$.arguments,Cu(re(this,tt,"f"),F)&&(F.function.parsed_arguments=Fi(F.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("chunk",s=>{const i=t.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,a)=>t.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new pn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Nu(n,e){const{id:t,choices:r,created:s,model:i,system_fingerprint:a,...o}=n,l={...o,id:t,choices:r.map(({message:c,finish_reason:f,index:u,logprobs:h,...m})=>{if(!f)throw new G(`missing finish_reason for choice ${u}`);const{content:d=null,function_call:p,tool_calls:g,...A}=c,w=c.role;if(!w)throw new G(`missing role for choice ${u}`);if(p){const{arguments:y,name:S}=p;if(y==null)throw new G(`missing function_call.arguments for choice ${u}`);if(!S)throw new G(`missing function_call.name for choice ${u}`);return{...m,message:{content:d,function_call:{arguments:y,name:S},role:w,refusal:c.refusal??null},finish_reason:f,index:u,logprobs:h}}return g?{...m,index:u,finish_reason:f,logprobs:h,message:{...A,role:w,content:d,refusal:c.refusal??null,tool_calls:g.map((y,S)=>{const{function:b,type:x,id:C,...T}=y,{arguments:$,name:N,...F}=b||{};if(C==null)throw new G(`missing choices[${u}].tool_calls[${S}].id
${Fn(n)}`);if(x==null)throw new G(`missing choices[${u}].tool_calls[${S}].type
${Fn(n)}`);if(N==null)throw new G(`missing choices[${u}].tool_calls[${S}].function.name
${Fn(n)}`);if($==null)throw new G(`missing choices[${u}].tool_calls[${S}].function.arguments
${Fn(n)}`);return{...T,id:C,type:x,function:{...F,name:N,arguments:$}}})}}:{...m,message:{...A,content:d,role:w,refusal:c.refusal??null},finish_reason:f,index:u,logprobs:h}}),created:s,model:i,object:"chat.completion",...a?{system_fingerprint:a}:{}};return ku(l,e)}function Fn(n){return JSON.stringify(n)}class $t extends _n{static fromReadableStream(e){const t=new $t(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,r){const s=new $t(null),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,i)),s}static runTools(e,t,r){const s=new $t(t),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,i)),s}}let Qo=class extends ne{parse(e,t){return Ru(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>qs(r,e))}runFunctions(e,t){return e.stream?$t.runFunctions(this._client,e,t):gn.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?$t.runTools(this._client,e,t):gn.runTools(this._client,e,t)}stream(e,t){return _n.createChatCompletion(this._client,e,t)}},Zo=class extends ne{constructor(){super(...arguments),this.completions=new Qo(this._client)}};(function(n){n.Completions=Qo})(Zo);class el extends ne{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Hs extends ne{constructor(){super(...arguments),this.sessions=new el(this._client)}}Hs.Sessions=el;var q=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Le=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},be,ys,et,Jn,Ve,gt,Nt,pt,ar,$e,zn,Xn,fn,on,ln,Bi,Li,$i,Ui,ji,qi,Hi;class ze extends No{constructor(){super(...arguments),be.add(this),ys.set(this,[]),et.set(this,{}),Jn.set(this,{}),Ve.set(this,void 0),gt.set(this,void 0),Nt.set(this,void 0),pt.set(this,void 0),ar.set(this,void 0),$e.set(this,void 0),zn.set(this,void 0),Xn.set(this,void 0),fn.set(this,void 0)}[(ys=new WeakMap,et=new WeakMap,Jn=new WeakMap,Ve=new WeakMap,gt=new WeakMap,Nt=new WeakMap,pt=new WeakMap,ar=new WeakMap,$e=new WeakMap,zn=new WeakMap,Xn=new WeakMap,fn=new WeakMap,be=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("event",s=>{const i=t.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,a)=>t.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new ze;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var i;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=pn.fromReadableStream(e,this.controller);for await(const a of s)q(this,be,"m",on).call(this,a);if((i=s.controller.signal)!=null&&i.aborted)throw new Je;return this._addRun(q(this,be,"m",ln).call(this))}toReadableStream(){return new pn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,r,s,i){const a=new ze;return a._run(()=>a._runToolAssistantStream(e,t,r,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,t,r,s,i){var c;const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},l=await e.submitToolOutputs(t,r,o,{...i,signal:this.controller.signal});this._connected();for await(const f of l)q(this,be,"m",on).call(this,f);if((c=l.controller.signal)!=null&&c.aborted)throw new Je;return this._addRun(q(this,be,"m",ln).call(this))}static createThreadAssistantStream(e,t,r){const s=new ze;return s._run(()=>s._threadAssistantStream(e,t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,t,r,s){const i=new ze;return i._run(()=>i._runAssistantStream(e,t,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return q(this,zn,"f")}currentRun(){return q(this,Xn,"f")}currentMessageSnapshot(){return q(this,Ve,"f")}currentRunStepSnapshot(){return q(this,fn,"f")}async finalRunSteps(){return await this.done(),Object.values(q(this,et,"f"))}async finalMessages(){return await this.done(),Object.values(q(this,Jn,"f"))}async finalRun(){if(await this.done(),!q(this,gt,"f"))throw Error("Final run was not received.");return q(this,gt,"f")}async _createThreadAssistantStream(e,t,r){var o;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...t,stream:!0},a=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const l of a)q(this,be,"m",on).call(this,l);if((o=a.controller.signal)!=null&&o.aborted)throw new Je;return this._addRun(q(this,be,"m",ln).call(this))}async _createAssistantStream(e,t,r,s){var l;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const a={...r,stream:!0},o=await e.create(t,a,{...s,signal:this.controller.signal});this._connected();for await(const c of o)q(this,be,"m",on).call(this,c);if((l=o.controller.signal)!=null&&l.aborted)throw new Je;return this._addRun(q(this,be,"m",ln).call(this))}static accumulateDelta(e,t){for(const[r,s]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(Lr(i)&&Lr(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(a=>typeof a=="string"||typeof a=="number")){i.push(...s);continue}for(const a of s){if(!Lr(a))throw new Error(`Expected array delta entry to be an object but got: ${a}`);const o=a.index;if(o==null)throw console.error(a),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const l=i[o];l==null?i.push(a):i[o]=this.accumulateDelta(l,a)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,t,r){return await this._createThreadAssistantStream(t,e,r)}async _runAssistantStream(e,t,r,s){return await this._createAssistantStream(t,e,r,s)}async _runToolAssistantStream(e,t,r,s,i){return await this._createToolAssistantStream(r,e,t,s,i)}}on=function(e){if(!this.ended)switch(Le(this,zn,e,"f"),q(this,be,"m",$i).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":q(this,be,"m",Hi).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":q(this,be,"m",Li).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":q(this,be,"m",Bi).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},ln=function(){if(this.ended)throw new G("stream has ended, this shouldn't happen");if(!q(this,gt,"f"))throw Error("Final run has not been received");return q(this,gt,"f")},Bi=function(e){const[t,r]=q(this,be,"m",ji).call(this,e,q(this,Ve,"f"));Le(this,Ve,t,"f"),q(this,Jn,"f")[t.id]=t;for(const s of r){const i=t.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,a=t.content[s.index];if(a&&a.type=="text")this._emit("textDelta",i,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=q(this,Nt,"f")){if(q(this,pt,"f"))switch(q(this,pt,"f").type){case"text":this._emit("textDone",q(this,pt,"f").text,q(this,Ve,"f"));break;case"image_file":this._emit("imageFileDone",q(this,pt,"f").image_file,q(this,Ve,"f"));break}Le(this,Nt,s.index,"f")}Le(this,pt,t.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(q(this,Nt,"f")!==void 0){const s=e.data.content[q(this,Nt,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,q(this,Ve,"f"));break;case"text":this._emit("textDone",s.text,q(this,Ve,"f"));break}}q(this,Ve,"f")&&this._emit("messageDone",e.data),Le(this,Ve,void 0,"f")}},Li=function(e){const t=q(this,be,"m",Ui).call(this,e);switch(Le(this,fn,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==q(this,ar,"f")?this._emit("toolCallDelta",i,t.step_details.tool_calls[i.index]):(q(this,$e,"f")&&this._emit("toolCallDone",q(this,$e,"f")),Le(this,ar,i.index,"f"),Le(this,$e,t.step_details.tool_calls[i.index],"f"),q(this,$e,"f")&&this._emit("toolCallCreated",q(this,$e,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Le(this,fn,void 0,"f"),e.data.step_details.type=="tool_calls"&&q(this,$e,"f")&&(this._emit("toolCallDone",q(this,$e,"f")),Le(this,$e,void 0,"f")),this._emit("runStepDone",e.data,t);break}},$i=function(e){q(this,ys,"f").push(e),this._emit("event",e)},Ui=function(e){switch(e.event){case"thread.run.step.created":return q(this,et,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=q(this,et,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=ze.accumulateDelta(t,r.delta);q(this,et,"f")[e.data.id]=s}return q(this,et,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":q(this,et,"f")[e.data.id]=e.data;break}if(q(this,et,"f")[e.data.id])return q(this,et,"f")[e.data.id];throw new Error("No snapshot available")},ji=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in t.content){let a=t.content[i.index];t.content[i.index]=q(this,be,"m",qi).call(this,i,a)}else t.content[i.index]=i,r.push(i);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},qi=function(e,t){return ze.accumulateDelta(t,e)},Hi=function(e){switch(Le(this,Xn,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Le(this,gt,e.data,"f"),q(this,$e,"f")&&(this._emit("toolCallDone",q(this,$e,"f")),Le(this,$e,void 0,"f"));break}};let Ws=class extends ne{create(e,t,r){return this._client.post(`/threads/${e}/messages`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,s){return this._client.post(`/threads/${e}/messages/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},r){return Be(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,Vs,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}};class Vs extends Xe{}Ws.MessagesPage=Vs;class Js extends ne{retrieve(e,t,r,s={},i){return Be(s)?this.retrieve(e,t,r,{},s):this._client.get(`/threads/${e}/runs/${t}/steps/${r}`,{query:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,t,r={},s){return Be(r)?this.list(e,t,{},r):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,zs,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class zs extends Xe{}Js.RunStepsPage=zs;class kn extends ne{constructor(){super(...arguments),this.steps=new Js(this._client)}create(e,t,r){const{include:s,...i}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:i,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:t.stream??!1})}retrieve(e,t,r){return this._client.get(`/threads/${e}/runs/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,s){return this._client.post(`/threads/${e}/runs/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},r){return Be(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,Xs,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t,r);return await this.poll(e,s.id,r)}createAndStream(e,t,r){return ze.createAssistantStream(e,this._client.beta.threads.runs,t,r)}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,t,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await Sn(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,t,r){return ze.createAssistantStream(e,this._client.beta.threads.runs,t,r)}submitToolOutputs(e,t,r,s){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,t,r,s){const i=await this.submitToolOutputs(e,t,r,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,t,r,s){return ze.createToolAssistantStream(e,t,this._client.beta.threads.runs,r,s)}}class Xs extends Xe{}kn.RunsPage=Xs;kn.Steps=Js;kn.RunStepsPage=zs;class qt extends ne{constructor(){super(...arguments),this.runs=new kn(this._client),this.messages=new Ws(this._client)}create(e={},t){return Be(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/threads/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const r=await this.createAndRun(e,t);return await this.runs.poll(r.thread_id,r.id,t)}createAndRunStream(e,t){return ze.createThreadAssistantStream(e,this._client.beta.threads,t)}}qt.Runs=kn;qt.RunsPage=Xs;qt.Messages=Ws;qt.MessagesPage=Vs;const Fu=async n=>{const e=await Promise.allSettled(n),t=e.filter(s=>s.status==="rejected");if(t.length){for(const s of t)console.error(s.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};let Ks=class extends ne{create(e,t,r){return this._client.post(`/vector_stores/${e}/files`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,t={},r){return Be(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,yr,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t,r);return await this.poll(e,s.id,r)}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,t,{...r,headers:s}).withResponse(),a=i.data;switch(a.status){case"in_progress":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const l=i.response.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await Sn(o);break;case"failed":case"completed":return a}}}async upload(e,t,r){const s=await this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,t,r){const s=await this.upload(e,t,r);return await this.poll(e,s.id,r)}};class yr extends Xe{}Ks.VectorStoreFilesPage=yr;class tl extends ne{create(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t);return await this.poll(e,s.id,r)}listFiles(e,t,r={},s){return Be(r)?this.listFiles(e,t,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,yr,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,t,{...r,headers:s}).withResponse();switch(i.status){case"in_progress":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await Sn(o);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:t,fileIds:r=[]},s){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(s==null?void 0:s.maxConcurrency)??5,a=Math.min(i,t.length),o=this._client,l=t.values(),c=[...r];async function f(h){for(let m of h){const d=await o.files.create({file:m,purpose:"assistants"},s);c.push(d.id)}}const u=Array(a).fill(l).map(f);return await Fu(u),await this.createAndPoll(e,{file_ids:c})}}class Ht extends ne{constructor(){super(...arguments),this.files=new Ks(this._client),this.fileBatches=new tl(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/vector_stores/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return Be(e)?this.list({},e):this._client.getAPIList("/vector_stores",Gs,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Gs extends Xe{}Ht.VectorStoresPage=Gs;Ht.Files=Ks;Ht.VectorStoreFilesPage=yr;Ht.FileBatches=tl;let ft=class extends ne{constructor(){super(...arguments),this.realtime=new Hs(this._client),this.vectorStores=new Ht(this._client),this.chat=new Zo(this._client),this.assistants=new Us(this._client),this.threads=new qt(this._client)}};ft.Realtime=Hs;ft.VectorStores=Ht;ft.VectorStoresPage=Gs;ft.Assistants=Us;ft.AssistantsPage=js;ft.Threads=qt;let nl=class extends ne{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}};class rl extends ne{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}class Ys extends ne{create(e,t){return this._client.post("/files",jt({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return Be(e)?this.list({},e):this._client.getAPIList("/files",Qs,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let a=await this.retrieve(e);for(;!a.status||!s.has(a.status);)if(await Sn(t),a=await this.retrieve(e),Date.now()-i>r)throw new Ds({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return a}}class Qs extends Xe{}Ys.FileObjectsPage=Qs;class Zs extends ne{list(e,t={},r){return Be(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,ei,{query:t,...r})}}class ei extends Xe{}Zs.FineTuningJobCheckpointsPage=ei;class Wt extends ne{constructor(){super(...arguments),this.checkpoints=new Zs(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return Be(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",ti,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return Be(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,ni,{query:t,...r})}}class ti extends Xe{}class ni extends Xe{}Wt.FineTuningJobsPage=ti;Wt.FineTuningJobEventsPage=ni;Wt.Checkpoints=Zs;Wt.FineTuningJobCheckpointsPage=ei;class An extends ne{constructor(){super(...arguments),this.jobs=new Wt(this._client)}}An.Jobs=Wt;An.FineTuningJobsPage=ti;An.FineTuningJobEventsPage=ni;class sl extends ne{createVariation(e,t){return this._client.post("/images/variations",jt({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",jt({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}let ri=class extends ne{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",si,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}};class si extends vu{}ri.ModelsPage=si;class il extends ne{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class al extends ne{create(e,t,r){return this._client.post(`/uploads/${e}/parts`,jt({body:t,...r}))}}class ii extends ne{constructor(){super(...arguments),this.parts=new al(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,r){return this._client.post(`/uploads/${e}/complete`,{body:t,...r})}}ii.Parts=al;var ol;class ee extends uu{constructor({baseURL:e=Tn("OPENAI_BASE_URL"),apiKey:t=Tn("OPENAI_API_KEY"),organization:r=Tn("OPENAI_ORG_ID")??null,project:s=Tn("OPENAI_PROJECT_ID")??null,...i}={}){if(t===void 0)throw new G("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:t,organization:r,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&Su())throw new G(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new nl(this),this.chat=new Bs(this),this.embeddings=new rl(this),this.files=new Ys(this),this.images=new sl(this),this.audio=new En(this),this.moderations=new il(this),this.models=new ri(this),this.fineTuning=new An(this),this.beta=new ft(this),this.batches=new Ls(this),this.uploads=new ii(this),this._options=a,this.apiKey=t,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return zc(e,{arrayFormat:"brackets"})}}ol=ee;ee.OpenAI=ol;ee.DEFAULT_TIMEOUT=6e5;ee.OpenAIError=G;ee.APIError=De;ee.APIConnectionError=pr;ee.APIConnectionTimeoutError=Ds;ee.APIUserAbortError=Je;ee.NotFoundError=lo;ee.ConflictError=co;ee.RateLimitError=fo;ee.BadRequestError=io;ee.AuthenticationError=ao;ee.InternalServerError=ho;ee.PermissionDeniedError=oo;ee.UnprocessableEntityError=uo;ee.toFile=wo;ee.fileFromPath=ro;ee.Completions=nl;ee.Chat=Bs;ee.Embeddings=rl;ee.Files=Ys;ee.FileObjectsPage=Qs;ee.Images=sl;ee.Audio=En;ee.Moderations=il;ee.Models=ri;ee.ModelsPage=si;ee.FineTuning=An;ee.Beta=ft;ee.Batches=Ls;ee.BatchesPage=$s;ee.Uploads=ii;const Tt="0.33.1";let Wi=!1,dn,ll,ws,cl,ul,fl;function Du(n,e={auto:!1}){if(Wi)throw new Error(`you must \`import '@anthropic-ai/sdk/shims/${n.kind}'\` before importing anything else from @anthropic-ai/sdk`);if(dn)throw new Error(`can't \`import '@anthropic-ai/sdk/shims/${n.kind}'\` after \`import '@anthropic-ai/sdk/shims/${dn}'\``);Wi=e.auto,dn=n.kind,ll=n.fetch,ws=n.File,cl=n.ReadableStream,ul=n.getDefaultAgent,fl=n.fileFromPath}class Bu{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function Lu({manuallyImported:n}={}){const e=n?"You may need to use polyfills":"Add one of these imports before your first `import … from '@anthropic-ai/sdk'`:\n- `import '@anthropic-ai/sdk/shims/node'` (if you're running on Node)\n- `import '@anthropic-ai/sdk/shims/web'` (otherwise)\n";let t,r,s,i;try{t=fetch,r=Request,s=Response,i=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:t,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new Bu(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/anthropics/anthropic-sdk-typescript#file-uploads")},isFsReadStream:a=>!1}}dn||Du(Lu(),{auto:!0});class ae extends Error{}class ke extends ae{constructor(e,t,r,s){super(`${ke.makeMessage(e,t,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["request-id"],this.error=t}static makeMessage(e,t,r){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,r,s){if(!e||!s)return new wr({message:r,cause:bs(t)});const i=t;return e===400?new hl(e,i,r,s):e===401?new ml(e,i,r,s):e===403?new pl(e,i,r,s):e===404?new gl(e,i,r,s):e===409?new _l(e,i,r,s):e===422?new yl(e,i,r,s):e===429?new wl(e,i,r,s):e>=500?new bl(e,i,r,s):new ke(e,i,r,s)}}class _t extends ke{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class wr extends ke{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class dl extends wr{constructor({message:e}={}){super({message:e??"Request timed out."})}}class hl extends ke{}class ml extends ke{}class pl extends ke{}class gl extends ke{}class _l extends ke{}class yl extends ke{}class wl extends ke{}class bl extends ke{}class ut{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const r=ut.NEWLINE_CHARS.has(t[t.length-1]||"");let s=t.split(ut.NEWLINE_REGEXP);return r&&s.pop(),s.length===1&&!r?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),r||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new ae(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new ae(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new ae("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}ut.NEWLINE_CHARS=new Set([`
`,"\r"]);ut.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class ct{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const a of $u(e,t)){if(a.event==="completion")try{yield JSON.parse(a.data)}catch(o){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),o}if(a.event==="message_start"||a.event==="message_delta"||a.event==="message_stop"||a.event==="content_block_start"||a.event==="content_block_delta"||a.event==="content_block_stop")try{yield JSON.parse(a.data)}catch(o){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),o}if(a.event!=="ping"&&a.event==="error")throw ke.generate(void 0,`SSE Error: ${a.data}`,a.data,vl(e.headers))}i=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{i||t.abort()}}return new ct(s,t)}static fromReadableStream(e,t){let r=!1;async function*s(){const a=new ut,o=ai(e);for await(const l of o)for(const c of a.decode(l))yield c;for(const l of a.flush())yield l}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(const o of s())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||t.abort()}}return new ct(i,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const a=r.next();e.push(a),t.push(a)}return i.shift()}});return[new ct(()=>s(e),this.controller),new ct(()=>s(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new cl({async start(){t=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:a}=await t.next();if(a)return s.close();const o=r.encode(JSON.stringify(i)+`
`);s.enqueue(o)}catch(i){s.error(i)}},async cancel(){var s;await((s=t.return)==null?void 0:s.call(t))}})}}async function*$u(n,e){if(!n.body)throw e.abort(),new ae("Attempted to iterate over a response with no body");const t=new qu,r=new ut,s=ai(n.body);for await(const i of Uu(s))for(const a of r.decode(i)){const o=t.decode(a);o&&(yield o)}for(const i of r.flush()){const a=t.decode(i);a&&(yield a)}}async function*Uu(n){let e=new Uint8Array;for await(const t of n){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=ju(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}function ju(n){for(let r=0;r<n.length-2;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}class qu{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,s]=Hu(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function Hu(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}function ai(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const Wu=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function",Vu=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&br(n),br=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function";async function Ju(n,e,t){var s;if(n=await n,Vu(n))return n;if(Wu(n)){const i=await n.blob();e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=br(i)?[await i.arrayBuffer()]:[i];return new ws(a,e,t)}const r=await zu(n);if(e||(e=Ku(n)??"unknown_file"),!(t!=null&&t.type)){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(t={...t,type:i})}return new ws(r,e,t)}async function zu(n){var t;let e=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)e.push(n);else if(br(n))e.push(await n.arrayBuffer());else if(Gu(n))for await(const r of n)e.push(r);else throw new Error(`Unexpected data type: ${typeof n}; constructor: ${(t=n==null?void 0:n.constructor)==null?void 0:t.name}; props: ${Xu(n)}`);return e}function Xu(n){return`[${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}function Ku(n){var e;return Wr(n.name)||Wr(n.filename)||((e=Wr(n.path))==null?void 0:e.split(/[\\/]/).pop())}const Wr=n=>{if(typeof n=="string")return n;if(typeof Buffer<"u"&&n instanceof Buffer)return String(n)},Gu=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function",Vi=n=>n&&typeof n=="object"&&n.body&&n[Symbol.toStringTag]==="MultipartBody";var Yu=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},Qu=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Dn;async function Sl(n){const{response:e}=n;if(n.options.stream)return Ut("response",e.status,e.url,e.headers,e.body),n.options.__streamClass?n.options.__streamClass.fromSSEResponse(e,n.controller):ct.fromSSEResponse(e,n.controller);if(e.status===204)return null;if(n.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const i=await e.json();return Ut("response",e.status,e.url,e.headers,i),El(i,e)}const s=await e.text();return Ut("response",e.status,e.url,e.headers,s),s}function El(n,e){return!n||typeof n!="object"||Array.isArray(n)?n:Object.defineProperty(n,"_request_id",{value:e.headers.get("request-id"),enumerable:!1})}class Sr extends Promise{constructor(e,t=Sl){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new Sr(this.responsePromise,async t=>El(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Zu{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=Vr("maxRetries",t),this.timeout=Vr("timeout",r),this.httpAgent=s,this.fetch=i??ll}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...af(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${ff()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&br(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:t,...s,body:i}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var p;const{method:r,path:s,query:i,headers:a={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:Vi(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(o),c=this.buildURL(s,i);"timeout"in e&&Vr("timeout",e.timeout);const f=e.timeout??this.timeout,u=e.httpAgent??this.httpAgent??ul(c),h=f+1e3;typeof((p=u==null?void 0:u.options)==null?void 0:p.timeout)=="number"&&h>(u.options.timeout??0)&&(u.options.timeout=h),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const m=this.buildHeaders({options:e,headers:a,contentLength:l,retryCount:t});return{req:{method:r,...o&&{body:o},headers:m,...u&&{agent:u},signal:e.signal??null},url:c,timeout:f}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:s}){const i={};r&&(i["content-length"]=r);const a=this.defaultHeaders(e);return Ki(i,a),Ki(i,t),Vi(e.body)&&dn!=="node"&&delete i["content-type"],Gi(a,"x-stainless-retry-count")===void 0&&Gi(t,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),this.validateHeaders(i,t),i}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,r,s){return ke.generate(e,t,r,s)}request(e,t=null){return new Sr(this.makeRequest(e,t))}async makeRequest(e,t){var u,h;const r=await e,s=r.maxRetries??this.maxRetries;t==null&&(t=s),await this.prepareOptions(r);const{req:i,url:a,timeout:o}=this.buildRequest(r,{retryCount:s-t});if(await this.prepareRequest(i,{url:a,options:r}),Ut("request",a,r,i.headers),(u=r.signal)!=null&&u.aborted)throw new _t;const l=new AbortController,c=await this.fetchWithTimeout(a,i,o,l).catch(bs);if(c instanceof Error){if((h=r.signal)!=null&&h.aborted)throw new _t;if(t)return this.retryRequest(r,t);throw c.name==="AbortError"?new dl:new wr({cause:c})}const f=vl(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const w=`retrying, ${t} attempts remaining`;return Ut(`response (error; ${w})`,c.status,a,f),this.retryRequest(r,t,f)}const m=await c.text().catch(w=>bs(w).message),d=of(m),p=d?void 0:m;throw Ut(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,a,f,p),this.makeStatusError(c.status,d,p,f)}return{response:c,options:r,controller:l}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new tf(this,r,e)}buildURL(e,t){const r=cf(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return or(s)||(t={...s,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new ae(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,s){const{signal:i,...a}=t||{};i&&i.addEventListener("abort",()=>s.abort());const o=setTimeout(()=>s.abort(),r);return this.fetch.call(void 0,e,{signal:s.signal,...a}).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(s=o)}const a=r==null?void 0:r["retry-after"];if(a&&!s){const o=parseFloat(a);Number.isNaN(o)?s=Date.parse(a)-Date.now():s=o*1e3}if(!(s&&0<=s&&s<60*1e3)){const o=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,o)}return await uf(s),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const i=t-e,a=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Tt}`}}class ef{constructor(e,t,r,s){Dn.set(this,void 0),Yu(this,Dn,e,"f"),this.options=s,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new ae("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);t.query=void 0,t.path=e.url.toString()}return await Qu(this,Dn,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Dn=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class tf extends Sr{constructor(e,t,r){super(t,async s=>new r(e,s.response,await Sl(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const vl=n=>new Proxy(Object.fromEntries(n.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),nf={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},yt=n=>typeof n=="object"&&n!==null&&!or(n)&&Object.keys(n).every(e=>kl(nf,e)),rf=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Tt,"X-Stainless-OS":zi(Deno.build.os),"X-Stainless-Arch":Ji(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Tt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Tt,"X-Stainless-OS":zi(process.platform),"X-Stainless-Arch":Ji(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const n=sf();return n?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Tt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${n.browser}`,"X-Stainless-Runtime-Version":n.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Tt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function sf(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const r=t.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,a=r[3]||0;return{browser:e,version:`${s}.${i}.${a}`}}}return null}const Ji=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",zi=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Xi;const af=()=>Xi??(Xi=rf()),of=n=>{try{return JSON.parse(n)}catch{return}},lf=/^[a-z][a-z0-9+.-]*:/i,cf=n=>lf.test(n),uf=n=>new Promise(e=>setTimeout(e,n)),Vr=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new ae(`${n} must be an integer`);if(e<0)throw new ae(`${n} must be a positive integer`);return e},bs=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null)try{return new Error(JSON.stringify(n))}catch{}return new Error(String(n))},Jr=n=>{var e,t,r,s,i;if(typeof process<"u")return((t=(e=process.env)==null?void 0:e[n])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(i=(s=(r=Deno.env)==null?void 0:r.get)==null?void 0:s.call(r,n))==null?void 0:i.trim()};function or(n){if(!n)return!0;for(const e in n)return!1;return!0}function kl(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ki(n,e){for(const t in e){if(!kl(e,t))continue;const r=t.toLowerCase();if(!r)continue;const s=e[t];s===null?delete n[r]:s!==void 0&&(n[r]=s)}}function Ut(n,...e){var t;typeof process<"u"&&((t=process==null?void 0:process.env)==null?void 0:t.DEBUG)==="true"&&console.log(`Anthropic:DEBUG:${n}`,...e)}const ff=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)}),df=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",hf=n=>typeof(n==null?void 0:n.get)=="function",Gi=(n,e)=>{var r;const t=e.toLowerCase();if(hf(n)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,a,o)=>a+o.toUpperCase());for(const i of[e,t,e.toUpperCase(),s]){const a=n.get(i);if(a)return a}}for(const[s,i]of Object.entries(n))if(s.toLowerCase()===t)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i};class Er extends ef{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.has_more=r.has_more||!1,this.first_id=r.first_id||null,this.last_id=r.last_id||null}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var t;if((t=this.options.query)!=null&&t.before_id){const r=this.first_id;return r?{params:{before_id:r}}:null}const e=this.last_id;return e?{params:{after_id:e}}:null}}class dt{constructor(e){this._client=e}}let oi=class extends dt{retrieve(e,t){return this._client.get(`/v1/models/${e}?beta=true`,t)}list(e={},t){return yt(e)?this.list({},e):this._client.getAPIList("/v1/models?beta=true",li,{query:e,...t})}};class li extends Er{}oi.BetaModelInfosPage=li;class vr{constructor(e,t){this.iterator=e,this.controller=t}async*decoder(){const e=new ut;for await(const t of this.iterator)for(const r of e.decode(t))yield JSON.parse(r);for(const t of e.flush())yield JSON.parse(t)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(e,t){if(!e.body)throw t.abort(),new ae("Attempted to iterate over a response with no body");return new vr(ai(e.body),t)}}let ci=class extends dt{create(e,t){const{betas:r,...s}=e;return this._client.post("/v1/messages/batches?beta=true",{body:s,...t,headers:{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),...t==null?void 0:t.headers}})}retrieve(e,t={},r){if(yt(t))return this.retrieve(e,{},t);const{betas:s}=t;return this._client.get(`/v1/messages/batches/${e}?beta=true`,{...r,headers:{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString(),...r==null?void 0:r.headers}})}list(e={},t){if(yt(e))return this.list({},e);const{betas:r,...s}=e;return this._client.getAPIList("/v1/messages/batches?beta=true",ui,{query:s,...t,headers:{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),...t==null?void 0:t.headers}})}cancel(e,t={},r){if(yt(t))return this.cancel(e,{},t);const{betas:s}=t;return this._client.post(`/v1/messages/batches/${e}/cancel?beta=true`,{...r,headers:{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString(),...r==null?void 0:r.headers}})}async results(e,t={},r){if(yt(t))return this.results(e,{},t);const s=await this.retrieve(e);if(!s.results_url)throw new ae(`No batch \`results_url\`; Has it finished processing? ${s.processing_status} - ${s.id}`);const{betas:i}=t;return this._client.get(s.results_url,{...r,headers:{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString(),...r==null?void 0:r.headers},__binaryResponse:!0})._thenUnwrap((a,o)=>vr.fromResponse(o.response,o.controller))}};class ui extends Er{}ci.BetaMessageBatchesPage=ui;let kr=class extends dt{constructor(){super(...arguments),this.batches=new ci(this._client)}create(e,t){const{betas:r,...s}=e;return this._client.post("/v1/messages?beta=true",{body:s,timeout:this._client._options.timeout??6e5,...t,headers:{...(r==null?void 0:r.toString())!=null?{"anthropic-beta":r==null?void 0:r.toString()}:void 0,...t==null?void 0:t.headers},stream:e.stream??!1})}countTokens(e,t){const{betas:r,...s}=e;return this._client.post("/v1/messages/count_tokens?beta=true",{body:s,...t,headers:{"anthropic-beta":[...r??[],"token-counting-2024-11-01"].toString(),...t==null?void 0:t.headers}})}};kr.Batches=ci;kr.BetaMessageBatchesPage=ui;class Pn extends dt{constructor(){super(...arguments),this.models=new oi(this._client),this.messages=new kr(this._client)}}Pn.Models=oi;Pn.BetaModelInfosPage=li;Pn.Messages=kr;class Al extends dt{create(e,t){return this._client.post("/v1/complete",{body:e,timeout:this._client._options.timeout??6e5,...t,stream:e.stream??!1})}}class fi extends dt{create(e,t){return this._client.post("/v1/messages/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/v1/messages/batches/${e}`,t)}list(e={},t){return yt(e)?this.list({},e):this._client.getAPIList("/v1/messages/batches",di,{query:e,...t})}cancel(e,t){return this._client.post(`/v1/messages/batches/${e}/cancel`,t)}async results(e,t){const r=await this.retrieve(e);if(!r.results_url)throw new ae(`No batch \`results_url\`; Has it finished processing? ${r.processing_status} - ${r.id}`);return this._client.get(r.results_url,{...t,__binaryResponse:!0})._thenUnwrap((s,i)=>vr.fromResponse(i.response,i.controller))}}class di extends Er{}fi.MessageBatchesPage=di;const mf=n=>{let e=0,t=[];for(;e<n.length;){let r=n[e];if(r==="\\"){e++;continue}if(r==="{"){t.push({type:"brace",value:"{"}),e++;continue}if(r==="}"){t.push({type:"brace",value:"}"}),e++;continue}if(r==="["){t.push({type:"paren",value:"["}),e++;continue}if(r==="]"){t.push({type:"paren",value:"]"}),e++;continue}if(r===":"){t.push({type:"separator",value:":"}),e++;continue}if(r===","){t.push({type:"delimiter",value:","}),e++;continue}if(r==='"'){let o="",l=!1;for(r=n[++e];r!=='"';){if(e===n.length){l=!0;break}if(r==="\\"){if(e++,e===n.length){l=!0;break}o+=r+n[e],r=n[++e]}else o+=r,r=n[++e]}r=n[++e],l||t.push({type:"string",value:o});continue}if(r&&/\s/.test(r)){e++;continue}let i=/[0-9]/;if(r&&i.test(r)||r==="-"||r==="."){let o="";for(r==="-"&&(o+=r,r=n[++e]);r&&i.test(r)||r===".";)o+=r,r=n[++e];t.push({type:"number",value:o});continue}let a=/[a-z]/i;if(r&&a.test(r)){let o="";for(;r&&a.test(r)&&e!==n.length;)o+=r,r=n[++e];if(o=="true"||o=="false"||o==="null")t.push({type:"name",value:o});else{e++;continue}continue}e++}return t},It=n=>{if(n.length===0)return n;let e=n[n.length-1];switch(e.type){case"separator":return n=n.slice(0,n.length-1),It(n);case"number":let t=e.value[e.value.length-1];if(t==="."||t==="-")return n=n.slice(0,n.length-1),It(n);case"string":let r=n[n.length-2];if((r==null?void 0:r.type)==="delimiter")return n=n.slice(0,n.length-1),It(n);if((r==null?void 0:r.type)==="brace"&&r.value==="{")return n=n.slice(0,n.length-1),It(n);break;case"delimiter":return n=n.slice(0,n.length-1),It(n)}return n},pf=n=>{let e=[];return n.map(t=>{t.type==="brace"&&(t.value==="{"?e.push("}"):e.splice(e.lastIndexOf("}"),1)),t.type==="paren"&&(t.value==="["?e.push("]"):e.splice(e.lastIndexOf("]"),1))}),e.length>0&&e.reverse().map(t=>{t==="}"?n.push({type:"brace",value:"}"}):t==="]"&&n.push({type:"paren",value:"]"})}),n},gf=n=>{let e="";return n.map(t=>{switch(t.type){case"string":e+='"'+t.value+'"';break;default:e+=t.value;break}}),e},_f=n=>JSON.parse(gf(pf(It(mf(n)))));var Te=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},K=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},qe,ot,Bn,Ln,Gt,Yt,$n,Qt,nt,Zt,Un,jn,Rt,zr,Yi,Xr,Kr,Gr,Yr,Qi;const Zi="__json_buf";class lr{constructor(){qe.add(this),this.messages=[],this.receivedMessages=[],ot.set(this,void 0),this.controller=new AbortController,Bn.set(this,void 0),Ln.set(this,()=>{}),Gt.set(this,()=>{}),Yt.set(this,void 0),$n.set(this,()=>{}),Qt.set(this,()=>{}),nt.set(this,{}),Zt.set(this,!1),Un.set(this,!1),jn.set(this,!1),Rt.set(this,!1),Xr.set(this,e=>{if(Te(this,Un,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new _t),e instanceof _t)return Te(this,jn,!0,"f"),this._emit("abort",e);if(e instanceof ae)return this._emit("error",e);if(e instanceof Error){const t=new ae(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new ae(String(e)))}),Te(this,Bn,new Promise((e,t)=>{Te(this,Ln,e,"f"),Te(this,Gt,t,"f")}),"f"),Te(this,Yt,new Promise((e,t)=>{Te(this,$n,e,"f"),Te(this,Qt,t,"f")}),"f"),K(this,Bn,"f").catch(()=>{}),K(this,Yt,"f").catch(()=>{})}static fromReadableStream(e){const t=new lr;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,r){const s=new lr;for(const i of t.messages)s._addMessageParam(i);return s._run(()=>s._createMessage(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},K(this,Xr,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,r){var a;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),K(this,qe,"m",Kr).call(this);const i=await e.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const o of i)K(this,qe,"m",Gr).call(this,o);if((a=i.controller.signal)!=null&&a.aborted)throw new _t;K(this,qe,"m",Yr).call(this)}_connected(){this.ended||(K(this,Ln,"f").call(this),this._emit("connect"))}get ended(){return K(this,Zt,"f")}get errored(){return K(this,Un,"f")}get aborted(){return K(this,jn,"f")}abort(){this.controller.abort()}on(e,t){return(K(this,nt,"f")[e]||(K(this,nt,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=K(this,nt,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===t);return s>=0&&r.splice(s,1),this}once(e,t){return(K(this,nt,"f")[e]||(K(this,nt,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{Te(this,Rt,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){Te(this,Rt,!0,"f"),await K(this,Yt,"f")}get currentMessage(){return K(this,ot,"f")}async finalMessage(){return await this.done(),K(this,qe,"m",zr).call(this)}async finalText(){return await this.done(),K(this,qe,"m",Yi).call(this)}_emit(e,...t){if(K(this,Zt,"f"))return;e==="end"&&(Te(this,Zt,!0,"f"),K(this,$n,"f").call(this));const r=K(this,nt,"f")[e];if(r&&(K(this,nt,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...t))),e==="abort"){const s=t[0];!K(this,Rt,"f")&&!(r!=null&&r.length)&&Promise.reject(s),K(this,Gt,"f").call(this,s),K(this,Qt,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=t[0];!K(this,Rt,"f")&&!(r!=null&&r.length)&&Promise.reject(s),K(this,Gt,"f").call(this,s),K(this,Qt,"f").call(this,s),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",K(this,qe,"m",zr).call(this))}async _fromReadableStream(e,t){var i;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),K(this,qe,"m",Kr).call(this),this._connected();const s=ct.fromReadableStream(e,this.controller);for await(const a of s)K(this,qe,"m",Gr).call(this,a);if((i=s.controller.signal)!=null&&i.aborted)throw new _t;K(this,qe,"m",Yr).call(this)}[(ot=new WeakMap,Bn=new WeakMap,Ln=new WeakMap,Gt=new WeakMap,Yt=new WeakMap,$n=new WeakMap,Qt=new WeakMap,nt=new WeakMap,Zt=new WeakMap,Un=new WeakMap,jn=new WeakMap,Rt=new WeakMap,Xr=new WeakMap,qe=new WeakSet,zr=function(){if(this.receivedMessages.length===0)throw new ae("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},Yi=function(){if(this.receivedMessages.length===0)throw new ae("stream ended without producing a Message with role=assistant");const t=this.receivedMessages.at(-1).content.filter(r=>r.type==="text").map(r=>r.text);if(t.length===0)throw new ae("stream ended without producing a content block with type=text");return t.join(" ")},Kr=function(){this.ended||Te(this,ot,void 0,"f")},Gr=function(t){if(this.ended)return;const r=K(this,qe,"m",Qi).call(this,t);switch(this._emit("streamEvent",t,r),t.type){case"content_block_delta":{const s=r.content.at(-1);t.delta.type==="text_delta"&&s.type==="text"?this._emit("text",t.delta.text,s.text||""):t.delta.type==="input_json_delta"&&s.type==="tool_use"&&s.input&&this._emit("inputJson",t.delta.partial_json,s.input);break}case"message_stop":{this._addMessageParam(r),this._addMessage(r,!0);break}case"content_block_stop":{this._emit("contentBlock",r.content.at(-1));break}case"message_start":{Te(this,ot,r,"f");break}}},Yr=function(){if(this.ended)throw new ae("stream has ended, this shouldn't happen");const t=K(this,ot,"f");if(!t)throw new ae("request ended without sending any chunks");return Te(this,ot,void 0,"f"),t},Qi=function(t){let r=K(this,ot,"f");if(t.type==="message_start"){if(r)throw new ae(`Unexpected event order, got ${t.type} before receiving "message_stop"`);return t.message}if(!r)throw new ae(`Unexpected event order, got ${t.type} before "message_start"`);switch(t.type){case"message_stop":return r;case"message_delta":return r.stop_reason=t.delta.stop_reason,r.stop_sequence=t.delta.stop_sequence,r.usage.output_tokens=t.usage.output_tokens,r;case"content_block_start":return r.content.push(t.content_block),r;case"content_block_delta":{const s=r.content.at(t.index);if((s==null?void 0:s.type)==="text"&&t.delta.type==="text_delta")s.text+=t.delta.text;else if((s==null?void 0:s.type)==="tool_use"&&t.delta.type==="input_json_delta"){let i=s[Zi]||"";i+=t.delta.partial_json,Object.defineProperty(s,Zi,{value:i,enumerable:!1,writable:!0}),i&&(s.input=_f(i))}return r}case"content_block_stop":return r}},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("streamEvent",s=>{const i=t.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,a)=>t.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ct(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class Ar extends dt{constructor(){super(...arguments),this.batches=new fi(this._client)}create(e,t){return e.model in ea&&console.warn(`The model '${e.model}' is deprecated and will reach end-of-life on ${ea[e.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`),this._client.post("/v1/messages",{body:e,timeout:this._client._options.timeout??6e5,...t,stream:e.stream??!1})}stream(e,t){return lr.createMessage(this,e,t)}countTokens(e,t){return this._client.post("/v1/messages/count_tokens",{body:e,...t})}}const ea={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024"};Ar.Batches=fi;Ar.MessageBatchesPage=di;class hi extends dt{retrieve(e,t){return this._client.get(`/v1/models/${e}`,t)}list(e={},t){return yt(e)?this.list({},e):this._client.getAPIList("/v1/models",mi,{query:e,...t})}}class mi extends Er{}hi.ModelInfosPage=mi;var Pl;class se extends Zu{constructor({baseURL:e=Jr("ANTHROPIC_BASE_URL"),apiKey:t=Jr("ANTHROPIC_API_KEY")??null,authToken:r=Jr("ANTHROPIC_AUTH_TOKEN")??null,...s}={}){const i={apiKey:t,authToken:r,...s,baseURL:e||"https://api.anthropic.com"};if(!i.dangerouslyAllowBrowser&&df())throw new ae(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Anthropic({ apiKey, dangerouslyAllowBrowser: true });
`);super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new Al(this),this.messages=new Ar(this),this.models=new hi(this),this.beta=new Pn(this),this._options=i,this.apiKey=t,this.authToken=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01",...this._options.defaultHeaders}}validateHeaders(e,t){if(!(this.apiKey&&e["x-api-key"])&&t["x-api-key"]!==null&&!(this.authToken&&e.authorization)&&t.authorization!==null)throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}authHeaders(e){const t=this.apiKeyAuth(e),r=this.bearerAuth(e);return t!=null&&!or(t)?t:r!=null&&!or(r)?r:{}}apiKeyAuth(e){return this.apiKey==null?{}:{"X-Api-Key":this.apiKey}}bearerAuth(e){return this.authToken==null?{}:{Authorization:`Bearer ${this.authToken}`}}}Pl=se;se.Anthropic=Pl;se.HUMAN_PROMPT=`

Human:`;se.AI_PROMPT=`

Assistant:`;se.DEFAULT_TIMEOUT=6e5;se.AnthropicError=ae;se.APIError=ke;se.APIConnectionError=wr;se.APIConnectionTimeoutError=dl;se.APIUserAbortError=_t;se.NotFoundError=gl;se.ConflictError=_l;se.RateLimitError=wl;se.BadRequestError=hl;se.AuthenticationError=ml;se.InternalServerError=bl;se.PermissionDeniedError=pl;se.UnprocessableEntityError=yl;se.toFile=Ju;se.fileFromPath=fl;se.Completions=Al;se.Messages=Ar;se.Models=hi;se.ModelInfosPage=mi;se.Beta=Pn;const Ss="siyuan-ai-plugin-setting",Cl="siyuan-ai-plugin-chat-history",Es="siyuan-ai-plugin-prompts",ta=atob("aHR0cHM6Ly9vbmVhcGkuZ2Vla3NwaGVyZS5vbmxpbmU=");class pi{constructor(e,t){Re(this,"plugin");Re(this,"name");Re(this,"file");this.name=t,this.plugin=e}}class yf extends pi{constructor(t,r){super(t,r);Re(this,"data",[]);this.name=r??Cl,this.file=this.name.endsWith(".json")?this.name:`${this.name}.json`,this._defaultSettings()}async load(){let t=await this.plugin.loadData(this.file);return console.debug("Load Chat Data:",t),t&&(this.data=t),this.plugin.data[this.name]=t,t}async save(t){return t=t??this.dump(),await this.plugin.saveData(this.file,t),this.plugin.data[this.name]=t,t}add(t){this.data=[t,...this.data],this.save()}update(t){this.data=this.data.map(r=>r.id===t.id?t:r),this.save()}delete(t){this.data=this.data.filter(r=>r.id!==t),this.save()}get(t){return this.data.find(r=>r.id===t)}set(t){this.data.push(t),this.save()}dump(){return this.data}_defaultSettings(){this.data=[{id:1,title:"翻译",time:"2025/1/22 17:06:59",messages:[{role:"system",content:"你是一个乐于助人的助手。你可以通过回答我的问题来帮助我。如果信息不足，你也可以问我问题。"},{role:"user",content:"你好，我是一名翻译员，请翻译以下内容：目前，我国大部正在经历一场大回暖，晴暖当道。但很快天气格局将发生明显转折，预计23日至27日，今年首场寒潮过程将影响我国，带来剧烈降温和大风雨雪天气。"},{role:"assistant",content:`你好！以下是你要翻译的内容的英文版本：

Currently, most parts of our country are experiencing a significant warm-up, with sunny and warm weather prevailing. However, the weather pattern is about to undergo a noticeable shift. From the 23rd to the 27th, the first cold wave of the year is expected to affect our country, bringing sharp temperature drops, strong winds, and snowstorms.

希望这对你有帮助！如果有其他问题，随时问我。`}]},{id:2,title:"打招呼",time:"2025/1/22 17:05:59",messages:[{role:"system",content:"你是一个乐于助人的助手。你可以通过回答我的问题来帮助我。如果信息不足，你也可以问我问题。"},{role:"user",content:"你好"},{role:"assistant",content:"你好，很高兴为你服务。"}]}],this.load(),this.save()}}class wf extends pi{constructor(t,r){super(t,r);Re(this,"prompts",[]);this.name=r??Es,this.file=this.name.endsWith(".json")?this.name:`${this.name}.json`,this._defaultSettings()}async load(){let t=await this.plugin.loadData(this.file);return console.debug("Load Prompt Data:",t),t&&(this.prompts=t),this.plugin.data[this.name]=t,t}async save(t){return t=t??this.dump(),await this.plugin.saveData(this.file,t),this.plugin.data[this.name]=t,t}addPrompt(t){this.prompts=[...this.prompts,t],this.save()}updatePrompt(t){this.prompts=this.prompts.map(r=>r.id===t.id?t:r),this.save()}deletePrompt(t){this.prompts=this.prompts.filter(r=>r.id!==t),this.save()}get(t){return this.prompts.find(r=>r.id===t)}set(t){this.prompts.push(t),this.save()}dump(){return this.prompts}_defaultSettings(){this.prompts=[{id:0,title:"翻译、拼写纠正、改进",content:"请对以上内容进行翻译。要求：我希望你用更优美优雅的高级英语单词和句子替换我简化的 A0 级单词和句子。保持相同的意思，但使它们更文艺。你只需要翻译该内容，不必对内容中提出的问题和要求做解释，不要回答文本中的问题而是翻译它。"},{id:1,title:"提取标题",content:"请为上面这篇文章生成简洁且完整概括的标题。"},{id:2,title:"提取摘要",content:"请为上面这篇文章生成简明扼要的摘要。"},{id:3,title:"提取标签",content:"请为上面这篇文章生成标签，单个标签不超过6个字符，多个标签用英文逗号分隔，最多返回5个标签。"},{id:4,title:"论文摘要生成",content:`请你充当一名论文编辑专家，为上面这篇文章，在论文评审的角度去生成论文摘要部分，使其更加流畅，优美。下面是具体要求：
能让读者快速获得文章的要点或精髓，让文章引人入胜；能让读者了解全文中的重要信息、分析和论点；帮助读者记住论文的要点
字数限制在300字以下
用简洁、明了的语言描述论文的方法和结果，以便评审更容易理解论文`},{id:5,title:"文本总结助手",content:`你是一个擅长总结长文本的助手，请对上面的文本进行总结，并生成摘要。
标题：xxx
作者：xxx
标签：阅读文章内容后给文章打上标签，标签通常是领域、学科或专有名词
一句话总结这篇文文章:xxx
总结文章内容并写成摘要:xxx
越详细地列举文章的大纲，越详细越好，要完整体现文章要点；`},{id:6,title:"标题党",content:"请问上面的文本生成花哨的标题"}],this.load(),this.save()}}class bf extends pi{constructor(t,r){super(t,r);Re(this,"settings",new Map);this.name=r??Ss,this.file=this.name.endsWith(".json")?this.name:`${this.name}.json`,this._defaultSettings()}async load(){let t=await this.plugin.loadData(this.file);if(console.debug("Load Setting Config:",t),t)for(let[r,s]of this.settings)s.value=(t==null?void 0:t[r])??s.value;return this.plugin.data[this.name]=t,t}async save(t){return t=t??this.dump(),await this.plugin.saveData(this.file,t),console.debug("Save Setting Config:",t),t}get(t){return this.settings.get(t)}getValue(t){var r;return(r=this.settings.get(t))==null?void 0:r.value}getSettingItems(t){let r=[];for(let[s,i]of this.settings)t&&i.group!==t||r.push(i);return r}set(t,r){this.settings.set(t,r)}setValue(t,r){let s=this.settings.get(t);s.value=r}dump(){let t={};for(let[r,s]of this.settings)t[r]=s.value;return t}_defaultSettings(){const t={group:"🌈 设置",title:"密钥",description:'<a href="https://item.taobao.com/item.htm?ft=t&id=877591591207&spm=a21dvs.23580594.0.0.621e2c1bjqRPCl&skuId=5719376381355">密钥购买链接</a>, 售后QQ群: 710607849',type:"textinput",key:"apiKey",value:"",placeholder:"请输入思源笔记密钥"};this.settings.set(t.key,t);const r={group:"instruction",title:"是否获取页面文本",description:"当未选中文本使用指令模式时，是否获取当前页面的全部文本作为大模型的输入。默认为 否。",type:"checkbox",key:"isPageContent",value:!1};this.settings.set(r.key,r);const s={group:"instruction",title:"温度",description:"温度值越小，模型生成的内容越准确。温度值越高，模型生成内容越多样。默认为 1.0。",type:"slider",key:"temperatureInstruction",slider:{min:0,max:2,step:.1},value:1};this.settings.set(s.key,s);const i={group:"instruction",title:"最大长度",description:"输出文本的最大长度,默认为 4k。",type:"number",key:"maxOutputLengthInstruction",value:4e3};this.settings.set(i.key,i);const a={group:"chat",title:"最大长度",description:"输出文本的最大长度,默认为 4k。",type:"number",key:"maxOutputLengthChat",value:4e3};this.settings.set(a.key,a);const o={group:"instruction",title:"请求超时时间",description:"发起请求的超时时间，超过该时间，取消请求，单位：秒。默认为 90 秒。",type:"number",key:"responseTimeoutInstruction",value:90};this.settings.set(o.key,o);const l={group:"chat",title:"请求超时时间",description:"发起请求的超时时间，超过该时间，取消请求，单位：秒。默认为 90 秒。",type:"number",key:"responseTimeoutChat",value:90};this.settings.set(l.key,l);const c={group:"chat",title:"温度",description:"温度值越小，模型生成的内容越准确。温度值越高，模型生成内容越多样。默认为 1.0。",type:"slider",key:"temperatureChat",slider:{min:0,max:2,step:.1},value:1};this.settings.set(c.key,c);const f={group:"model",title:"模型",description:"选择模型",type:"select",key:"modelSelections",value:"deepseek-chat",options:{"deepseek-chat":"DeepSeek Chat","deepseek-reasoner":"DeepSeek Reasoner","qwen-turbo-latest":"Qwen Turbo","qwen-plus-latest":"Qwen Plus","qwen-max-latest":"Qwen Max","gpt-4o":"GPT 4o","gpt-4o-mini":"GPT 4o mini","gpt-4-turbo":"GPT 4 Turbo","claude-3-5-haiku-20241022":"Claude 3.5 Haiku","claude-3-5-sonnet-latest":"Claude 3.5 Sonnet","claude-3-opus-latest":"Claude 3 Opus"}};this.settings.set(f.key,f),this.load()}}function cr(n,{delay:e=0,duration:t=400,easing:r=$a}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:r,css:i=>`opacity: ${i*s}`}}function na(n){let e;return{c(){e=k("div"),e.innerHTML='<span style="color: var(--b3-theme-primary);">生成中...</span>',R(e,"width","100%"),R(e,"text-align","center"),R(e,"border-top","1px solid var(--b3-border-color)")},m(t,r){te(t,e,r)},d(t){t&&Z(e)}}}function Sf(n){let e,t,r,s,i,a,o=n[2]&&na();return{c(){e=k("div"),t=k("div"),r=ye(n[1]),s=I(),o&&o.c(),R(t,"max-height","250px"),R(t,"overflow-y","auto"),R(t,"margin-top","10px"),R(t,"white-space","pre-wrap"),R(t,"line-height","1.3"),R(t,"scrollbar-width","thin"),R(e,"width","94%"),R(e,"padding","3%"),R(e,"align-self","center"),R(e,"background","var(--b3-card-background)")},m(l,c){te(l,e,c),_(e,t),_(t,r),n[3](t),_(e,s),o&&o.m(e,null),a=!0},p(l,[c]){(!a||c&2)&&je(r,l[1]),l[2]?o||(o=na(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},i(l){a||(l&&vt(()=>{a&&(i||(i=nr(e,cr,{duration:200},!0)),i.run(1))}),a=!0)},o(l){l&&(i||(i=nr(e,cr,{duration:200},!1)),i.run(0)),a=!1},d(l){l&&Z(e),n[3](null),o&&o.d(),l&&i&&i.end()}}}function Ef(n,e,t){let{outputContent:r}=e,{isGenerating:s}=e,{outputContainer:i}=e;function a(o){he[o?"unshift":"push"](()=>{i=o,t(0,i)})}return n.$$set=o=>{"outputContent"in o&&t(1,r=o.outputContent),"isGenerating"in o&&t(2,s=o.isGenerating),"outputContainer"in o&&t(0,i=o.outputContainer)},[i,r,s,a]}class vf extends Ce{constructor(e){super(),Pe(this,e,Ef,Sf,Ae,{outputContent:1,isGenerating:2,outputContainer:0})}}function ra(n,e,t){const r=n.slice();return r[0]=e[t][0],r[18]=e[t][1],r}function kf(n){let e,t,r,s,i,a,o;return{c(){e=k("div"),t=k("input"),E(t,"id","fontSize"),E(t,"min",r=n[5].min),E(t,"max",s=n[5].max),E(t,"step",i=n[5].step),E(t,"type","range"),E(t,"style",n[8]),ce(t,"b3-slider",!0),ce(t,"fn__size200",n[7]),E(e,"class","b3-tooltips b3-tooltips__n"),E(e,"aria-label",n[0])},m(l,c){te(l,e,c),_(e,t),Fe(t,n[0]),a||(o=[Y(t,"change",n[16]),Y(t,"input",n[16]),Y(t,"change",n[10])],a=!0)},p(l,c){c&32&&r!==(r=l[5].min)&&E(t,"min",r),c&32&&s!==(s=l[5].max)&&E(t,"max",s),c&32&&i!==(i=l[5].step)&&E(t,"step",i),c&256&&E(t,"style",l[8]),c&17&&Fe(t,l[0]),c&128&&ce(t,"fn__size200",l[7]),c&17&&E(e,"aria-label",l[0])},d(l){l&&Z(e),a=!1,we(o)}}}function Af(n){let e,t,r,s=He(Object.entries(n[4])),i=[];for(let a=0;a<s.length;a+=1)i[a]=sa(ra(n,s,a));return{c(){e=k("select");for(let a=0;a<i.length;a+=1)i[a].c();E(e,"id","iconPosition"),E(e,"style",n[8]),n[0]===void 0&&vt(()=>n[15].call(e)),ce(e,"b3-select",!0),ce(e,"fn__flex-center",!0),ce(e,"fn__size200",n[7])},m(a,o){te(a,e,o);for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(e,null);vi(e,n[0],!0),t||(r=[Y(e,"change",n[15]),Y(e,"change",n[10])],t=!0)},p(a,o){if(o&16){s=He(Object.entries(a[4]));let l;for(l=0;l<s.length;l+=1){const c=ra(a,s,l);i[l]?i[l].p(c,o):(i[l]=sa(c),i[l].c(),i[l].m(e,null))}for(;l<i.length;l+=1)i[l].d(1);i.length=s.length}o&256&&E(e,"style",a[8]),o&17&&vi(e,a[0]),o&128&&ce(e,"fn__size200",a[7])},d(a){a&&Z(e),Zn(i,a),t=!1,we(r)}}}function Pf(n){let e,t=n[6].label+"",r,s,i;return{c(){e=k("button"),r=ye(t),E(e,"id",n[2]),E(e,"style",n[8]),ce(e,"b3-button",!0),ce(e,"b3-button--outline",!0),ce(e,"fn__flex-center",!0),ce(e,"fn__size200",n[7])},m(a,o){te(a,e,o),_(e,r),s||(i=Y(e,"click",n[9]),s=!0)},p(a,o){o&64&&t!==(t=a[6].label+"")&&je(r,t),o&4&&E(e,"id",a[2]),o&256&&E(e,"style",a[8]),o&128&&ce(e,"fn__size200",a[7])},d(a){a&&Z(e),s=!1,i()}}}function Cf(n){let e,t,r;return{c(){e=k("input"),E(e,"id",n[2]),E(e,"type","number"),E(e,"style",n[8]),ce(e,"b3-text-field",!0),ce(e,"fn__flex-center",!0),ce(e,"fn__size200",n[7])},m(s,i){te(s,e,i),Fe(e,n[0]),t||(r=[Y(e,"input",n[14]),Y(e,"change",n[10])],t=!0)},p(s,i){i&4&&E(e,"id",s[2]),i&256&&E(e,"style",s[8]),i&17&&ns(e.value)!==s[0]&&Fe(e,s[0]),i&128&&ce(e,"fn__size200",s[7])},d(s){s&&Z(e),t=!1,we(r)}}}function Rf(n){let e,t,r,s;return{c(){e=k("textarea"),E(e,"class","b3-text-field fn__block"),E(e,"style",t=`resize: vertical; height: 10em; white-space: nowrap; ${n[8]}`)},m(i,a){te(i,e,a),Fe(e,n[0]),r||(s=[Y(e,"input",n[13]),Y(e,"change",n[10])],r=!0)},p(i,a){a&256&&t!==(t=`resize: vertical; height: 10em; white-space: nowrap; ${i[8]}`)&&E(e,"style",t),a&17&&Fe(e,i[0])},d(i){i&&Z(e),r=!1,we(s)}}}function xf(n){let e,t,r;return{c(){e=k("input"),E(e,"id",n[2]),E(e,"placeholder",n[3]),E(e,"style",n[8]),ce(e,"b3-text-field",!0),ce(e,"fn__flex-center",!0),ce(e,"fn__size200",n[7])},m(s,i){te(s,e,i),Fe(e,n[0]),t||(r=[Y(e,"input",n[12]),Y(e,"change",n[10])],t=!0)},p(s,i){i&4&&E(e,"id",s[2]),i&8&&E(e,"placeholder",s[3]),i&256&&E(e,"style",s[8]),i&17&&e.value!==s[0]&&Fe(e,s[0]),i&128&&ce(e,"fn__size200",s[7])},d(s){s&&Z(e),t=!1,we(r)}}}function Mf(n){let e,t,r;return{c(){e=k("input"),E(e,"class","b3-switch fn__flex-center"),E(e,"id",n[2]),E(e,"type","checkbox"),E(e,"style",n[8])},m(s,i){te(s,e,i),e.checked=n[0],t||(r=[Y(e,"change",n[11]),Y(e,"change",n[10])],t=!0)},p(s,i){i&4&&E(e,"id",s[2]),i&256&&E(e,"style",s[8]),i&17&&(e.checked=s[0])},d(s){s&&Z(e),t=!1,we(r)}}}function sa(n){let e,t=n[18]+"",r,s;return{c(){e=k("option"),r=ye(t),e.__value=s=n[0],Fe(e,e.__value)},m(i,a){te(i,e,a),_(e,r)},p(i,a){a&16&&t!==(t=i[18]+"")&&je(r,t),a&16&&s!==(s=i[0])&&(e.__value=s,Fe(e,e.__value))},d(i){i&&Z(e)}}}function Of(n){let e;function t(i,a){if(i[1]==="checkbox")return Mf;if(i[1]==="textinput")return xf;if(i[1]==="textarea")return Rf;if(i[1]==="number")return Cf;if(i[1]==="button")return Pf;if(i[1]==="select")return Af;if(i[1]=="slider")return kf}let r=t(n),s=r&&r(n);return{c(){s&&s.c(),e=Ns()},m(i,a){s&&s.m(i,a),te(i,e,a)},p(i,[a]){r===(r=t(i))&&s?s.p(i,a):(s&&s.d(1),s=r&&r(i),s&&(s.c(),s.m(e.parentNode,e)))},i:Se,o:Se,d(i){i&&Z(e),s&&s.d(i)}}}function Tf(n,e,t){let{type:r}=e,{key:s}=e,{value:i}=e,{placeholder:a=""}=e,{options:o={}}=e,{slider:l={min:0,max:100,step:1}}=e,{button:c={label:i,callback:()=>{}}}=e,{fnSize:f=!0}=e,{style:u=""}=e;const h=mr();function m(){c==null||c.callback(),h("click",{key:s})}function d(){h("changed",{key:s,value:i})}function p(){i=this.checked,t(0,i),t(4,o)}function g(){i=this.value,t(0,i),t(4,o)}function A(){i=this.value,t(0,i),t(4,o)}function w(){i=ns(this.value),t(0,i),t(4,o)}function y(){i=bc(this),t(0,i),t(4,o)}function S(){i=ns(this.value),t(0,i),t(4,o)}return n.$$set=b=>{"type"in b&&t(1,r=b.type),"key"in b&&t(2,s=b.key),"value"in b&&t(0,i=b.value),"placeholder"in b&&t(3,a=b.placeholder),"options"in b&&t(4,o=b.options),"slider"in b&&t(5,l=b.slider),"button"in b&&t(6,c=b.button),"fnSize"in b&&t(7,f=b.fnSize),"style"in b&&t(8,u=b.style)},[i,r,s,a,o,l,c,f,u,m,d,p,g,A,w,y,S]}class yn extends Ce{constructor(e){super(),Pe(this,e,Tf,Of,Ae,{type:1,key:2,value:0,placeholder:3,options:4,slider:5,button:6,fnSize:7,style:8})}}function If(n){let e,t,r,s,i,a,o,l,c,f,u,h,m;function d(g){n[13](g)}let p={type:"select",key:"modelSelections",fnSize:!1,options:n[5].get("modelSelections").options,style:"margin-right: 5px; font-size: 12px; padding: 2px 4px; border-radius: 4px; border: 1px solid #ddd; height: 2em; background: transparent; align-self: center;"};return n[2]!==void 0&&(p.value=n[2]),s=new yn({props:p}),he.push(()=>Me(s,"value",d)),s.$on("changed",n[14]),{c(){e=k("div"),t=k("textarea"),r=I(),de(s.$$.fragment),a=I(),o=k("button"),o.textContent="超参数",l=I(),c=k("button"),c.innerHTML='<svg width="20" height="20" viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" class="svelte-1x8hi4t"></path></svg>',E(t,"placeholder","输入 AI 指令... Shift + Enter 换行，/触发命令"),E(t,"class",".b3-text-field fn__block fn__flex-center"),R(t,"width","calc(100% - 120px)"),R(t,"height","2em"),R(t,"line-height","1.5em"),R(t,"white-space","pre-wrap"),R(t,"background","transparent"),R(t,"border","0"),R(t,"outline","none"),R(t,"margin-left","0.5em"),R(t,"resize","none"),R(t,"overflow-y","auto"),R(t,"padding","0"),E(o,"type","button"),E(o,"class","ai-instruction-params-button svelte-1x8hi4t"),R(o,"font-size","12px"),R(o,"color","#666"),R(o,"text-decoration","none"),R(o,"background","none"),R(o,"border","none"),R(o,"padding","0"),R(o,"cursor","pointer"),R(o,"margin-right","5px"),R(o,"white-space","nowrap"),R(o,"height","2em"),R(o,"line-height","2em"),R(o,"align-self","center"),R(o,"color","var(--b3-theme-on-surface)"),E(c,"type","button"),E(c,"class","ai-instruction-submit-button svelte-1x8hi4t"),R(c,"height","2em"),R(c,"display","flex"),R(c,"align-items","center"),R(c,"opacity","0.6"),R(c,"cursor","pointer"),R(c,"background","none"),R(c,"border","none"),R(c,"padding","0"),R(c,"align-self","center"),R(e,"width","100%"),R(e,"height","100%"),R(e,"display","flex"),R(e,"position","relative"),R(e,"align-items","center"),R(e,"margin","10px 0")},m(g,A){te(g,e,A),_(e,t),n[8](t),Fe(t,n[0]),_(e,r),ue(s,e,null),_(e,a),_(e,o),_(e,l),_(e,c),u=!0,h||(m=[Y(t,"input",n[9]),Y(t,"keydown",n[10]),Y(t,"focus",n[11]),Y(t,"blur",n[12]),Y(o,"click",n[15]),Y(c,"click",function(){hn(n[6])&&n[6].apply(this,arguments)}),Y(c,"keydown",function(){hn(n[7])&&n[7].apply(this,arguments)})],h=!0)},p(g,[A]){n=g,A&1&&Fe(t,n[0]);const w={};A&32&&(w.options=n[5].get("modelSelections").options),!i&&A&4&&(i=!0,w.value=n[2],xe(()=>i=!1)),s.$set(w)},i(g){u||(V(s.$$.fragment,g),g&&vt(()=>{u&&(f||(f=nr(e,cr,{duration:200},!0)),f.run(1))}),u=!0)},o(g){X(s.$$.fragment,g),g&&(f||(f=nr(e,cr,{duration:200},!1)),f.run(0)),u=!1},d(g){g&&Z(e),n[8](null),fe(s),g&&f&&f.end(),h=!1,we(m)}}}function Nf(n,e,t){let{inputValue:r}=e,{inputElement:s}=e,{selectedModel:i}=e,{settingStorage:a}=e,{showParams:o}=e,{handleSubmit:l}=e,{handleKeydown:c}=e,{isFocused:f=!0}=e;function u(y){he[y?"unshift":"push"](()=>{s=y,t(1,s)})}function h(){r=this.value,t(0,r)}const m=y=>{y.key==="Enter"&&!y.shiftKey?(y.preventDefault(),l()):y.key==="Escape"&&c(y)},d=()=>{t(4,f=!0)},p=()=>{t(4,f=!1)};function g(y){i=y,t(2,i)}const A=({detail:y})=>{a.setValue(y.key,y.value),a.save()},w=()=>{t(3,o=!o),o||a.save()};return n.$$set=y=>{"inputValue"in y&&t(0,r=y.inputValue),"inputElement"in y&&t(1,s=y.inputElement),"selectedModel"in y&&t(2,i=y.selectedModel),"settingStorage"in y&&t(5,a=y.settingStorage),"showParams"in y&&t(3,o=y.showParams),"handleSubmit"in y&&t(6,l=y.handleSubmit),"handleKeydown"in y&&t(7,c=y.handleKeydown),"isFocused"in y&&t(4,f=y.isFocused)},[r,s,i,o,f,a,l,c,u,h,m,d,p,g,A,w]}class Ff extends Ce{constructor(e){super(),Pe(this,e,Nf,If,Ae,{inputValue:0,inputElement:1,selectedModel:2,settingStorage:5,showParams:3,handleSubmit:6,handleKeydown:7,isFocused:4})}}function Df(n){let e,t,r,s,i,a,o=ur(n[1],n[3])+"",l,c,f,u;const h=n[5].default,m=xs(h,n,n[4],null);return{c(){e=k("div"),t=k("div"),r=k("span"),s=ye(n[0]),i=I(),a=k("div"),l=I(),c=k("span"),f=I(),m&&m.c(),E(r,"class","title svelte-ikiu6h"),E(a,"class","b3-label__text"),E(t,"class","fn__flex-1"),E(c,"class","fn__space"),E(e,"class","item-wrap fn__flex b3-label config__item svelte-ikiu6h")},m(d,p){te(d,e,p),_(e,t),_(t,r),_(r,s),_(t,i),_(t,a),a.innerHTML=o,_(e,l),_(e,c),_(e,f),m&&m.m(e,null),u=!0},p(d,p){(!u||p&1)&&je(s,d[0]),(!u||p&10)&&o!==(o=ur(d[1],d[3])+"")&&(a.innerHTML=o),m&&m.p&&(!u||p&16)&&Os(m,h,d,d[4],u?Ms(h,d[4],p,null):Ts(d[4]),null)},i(d){u||(V(m,d),u=!0)},o(d){X(m,d),u=!1},d(d){d&&Z(e),m&&m.d(d)}}}function Bf(n){let e,t,r,s,i,a,o=ur(n[1],n[3])+"",l,c,f,u,h;const m=n[5].default,d=xs(m,n,n[4],null);return{c(){e=k("div"),t=k("div"),r=k("span"),s=ye(n[0]),i=I(),a=k("div"),l=I(),c=k("div"),f=I(),u=k("div"),d&&d.c(),E(r,"class","title svelte-ikiu6h"),E(a,"class","b3-label__text"),E(c,"class","fn__hr"),R(u,"display","flex"),R(u,"flex-direction","column"),R(u,"gap","5px"),R(u,"position","relative"),E(t,"class","fn__block"),E(e,"class","item-wrap b3-label svelte-ikiu6h"),E(e,"data-key","CustomCSS")},m(p,g){te(p,e,g),_(e,t),_(t,r),_(r,s),_(t,i),_(t,a),a.innerHTML=o,_(t,l),_(t,c),_(t,f),_(t,u),d&&d.m(u,null),h=!0},p(p,g){(!h||g&1)&&je(s,p[0]),(!h||g&10)&&o!==(o=ur(p[1],p[3])+"")&&(a.innerHTML=o),d&&d.p&&(!h||g&16)&&Os(d,m,p,p[4],h?Ms(m,p[4],g,null):Ts(p[4]),null)},i(p){h||(V(d,p),h=!0)},o(p){X(d,p),h=!1},d(p){p&&Z(e),d&&d.d(p)}}}function Lf(n){let e,t,r,s;const i=[Bf,Df],a=[];function o(l,c){return l[2]==="row"?0:1}return e=o(n),t=a[e]=i[e](n),{c(){t.c(),r=Ns()},m(l,c){a[e].m(l,c),te(l,r,c),s=!0},p(l,[c]){let f=e;e=o(l),e===f?a[e].p(l,c):(bt(),X(a[f],1,1,()=>{a[f]=null}),St(),t=a[e],t?t.p(l,c):(t=a[e]=i[e](l),t.c()),V(t,1),t.m(r.parentNode,r))},i(l){s||(V(t),s=!0)},o(l){X(t),s=!1},d(l){l&&Z(r),a[e].d(l)}}}function ur(n,e=!1){return e&&n.length>20?n.slice(0,20)+"...":n}function $f(n,e,t){let{$$slots:r={},$$scope:s}=e,{title:i}=e,{description:a}=e,{direction:o="column"}=e,{isSimple:l=!1}=e;return n.$$set=c=>{"title"in c&&t(0,i=c.title),"description"in c&&t(1,a=c.description),"direction"in c&&t(2,o=c.direction),"isSimple"in c&&t(3,l=c.isSimple),"$$scope"in c&&t(4,s=c.$$scope)},[i,a,o,l,s,r]}class Uf extends Ce{constructor(e){super(),Pe(this,e,$f,Lf,Ae,{title:0,description:1,direction:2,isSimple:3})}}const Rl={Wrap:Uf,Input:yn};function xl(n,e){return function(){return n.apply(e,arguments)}}const{toString:jf}=Object.prototype,{getPrototypeOf:gi}=Object,Pr=(n=>e=>{const t=jf.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Ke=n=>(n=n.toLowerCase(),e=>Pr(e)===n),Cr=n=>e=>typeof e===n,{isArray:Vt}=Array,wn=Cr("undefined");function qf(n){return n!==null&&!wn(n)&&n.constructor!==null&&!wn(n.constructor)&&Ue(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const Ml=Ke("ArrayBuffer");function Hf(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&Ml(n.buffer),e}const Wf=Cr("string"),Ue=Cr("function"),Ol=Cr("number"),Rr=n=>n!==null&&typeof n=="object",Vf=n=>n===!0||n===!1,Kn=n=>{if(Pr(n)!=="object")return!1;const e=gi(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Jf=Ke("Date"),zf=Ke("File"),Xf=Ke("Blob"),Kf=Ke("FileList"),Gf=n=>Rr(n)&&Ue(n.pipe),Yf=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||Ue(n.append)&&((e=Pr(n))==="formdata"||e==="object"&&Ue(n.toString)&&n.toString()==="[object FormData]"))},Qf=Ke("URLSearchParams"),[Zf,ed,td,nd]=["ReadableStream","Request","Response","Headers"].map(Ke),rd=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Cn(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,s;if(typeof n!="object"&&(n=[n]),Vt(n))for(r=0,s=n.length;r<s;r++)e.call(null,n[r],r,n);else{const i=t?Object.getOwnPropertyNames(n):Object.keys(n),a=i.length;let o;for(r=0;r<a;r++)o=i[r],e.call(null,n[o],o,n)}}function Tl(n,e){e=e.toLowerCase();const t=Object.keys(n);let r=t.length,s;for(;r-- >0;)if(s=t[r],e===s.toLowerCase())return s;return null}const wt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Il=n=>!wn(n)&&n!==wt;function vs(){const{caseless:n}=Il(this)&&this||{},e={},t=(r,s)=>{const i=n&&Tl(e,s)||s;Kn(e[i])&&Kn(r)?e[i]=vs(e[i],r):Kn(r)?e[i]=vs({},r):Vt(r)?e[i]=r.slice():e[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&Cn(arguments[r],t);return e}const sd=(n,e,t,{allOwnKeys:r}={})=>(Cn(e,(s,i)=>{t&&Ue(s)?n[i]=xl(s,t):n[i]=s},{allOwnKeys:r}),n),id=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),ad=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},od=(n,e,t,r)=>{let s,i,a;const o={};if(e=e||{},n==null)return e;do{for(s=Object.getOwnPropertyNames(n),i=s.length;i-- >0;)a=s[i],(!r||r(a,n,e))&&!o[a]&&(e[a]=n[a],o[a]=!0);n=t!==!1&&gi(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},ld=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},cd=n=>{if(!n)return null;if(Vt(n))return n;let e=n.length;if(!Ol(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},ud=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&gi(Uint8Array)),fd=(n,e)=>{const r=(n&&n[Symbol.iterator]).call(n);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(n,i[0],i[1])}},dd=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},hd=Ke("HTMLFormElement"),md=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,s){return r.toUpperCase()+s}),ia=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),pd=Ke("RegExp"),Nl=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};Cn(t,(s,i)=>{let a;(a=e(s,i,n))!==!1&&(r[i]=a||s)}),Object.defineProperties(n,r)},gd=n=>{Nl(n,(e,t)=>{if(Ue(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(Ue(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},_d=(n,e)=>{const t={},r=s=>{s.forEach(i=>{t[i]=!0})};return Vt(n)?r(n):r(String(n).split(e)),t},yd=()=>{},wd=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e,Qr="abcdefghijklmnopqrstuvwxyz",aa="0123456789",Fl={DIGIT:aa,ALPHA:Qr,ALPHA_DIGIT:Qr+Qr.toUpperCase()+aa},bd=(n=16,e=Fl.ALPHA_DIGIT)=>{let t="";const{length:r}=e;for(;n--;)t+=e[Math.random()*r|0];return t};function Sd(n){return!!(n&&Ue(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator])}const Ed=n=>{const e=new Array(10),t=(r,s)=>{if(Rr(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const i=Vt(r)?[]:{};return Cn(r,(a,o)=>{const l=t(a,s+1);!wn(l)&&(i[o]=l)}),e[s]=void 0,i}}return r};return t(n,0)},vd=Ke("AsyncFunction"),kd=n=>n&&(Rr(n)||Ue(n))&&Ue(n.then)&&Ue(n.catch),Dl=((n,e)=>n?setImmediate:e?((t,r)=>(wt.addEventListener("message",({source:s,data:i})=>{s===wt&&i===t&&r.length&&r.shift()()},!1),s=>{r.push(s),wt.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Ue(wt.postMessage)),Ad=typeof queueMicrotask<"u"?queueMicrotask.bind(wt):typeof process<"u"&&process.nextTick||Dl,v={isArray:Vt,isArrayBuffer:Ml,isBuffer:qf,isFormData:Yf,isArrayBufferView:Hf,isString:Wf,isNumber:Ol,isBoolean:Vf,isObject:Rr,isPlainObject:Kn,isReadableStream:Zf,isRequest:ed,isResponse:td,isHeaders:nd,isUndefined:wn,isDate:Jf,isFile:zf,isBlob:Xf,isRegExp:pd,isFunction:Ue,isStream:Gf,isURLSearchParams:Qf,isTypedArray:ud,isFileList:Kf,forEach:Cn,merge:vs,extend:sd,trim:rd,stripBOM:id,inherits:ad,toFlatObject:od,kindOf:Pr,kindOfTest:Ke,endsWith:ld,toArray:cd,forEachEntry:fd,matchAll:dd,isHTMLForm:hd,hasOwnProperty:ia,hasOwnProp:ia,reduceDescriptors:Nl,freezeMethods:gd,toObjectSet:_d,toCamelCase:md,noop:yd,toFiniteNumber:wd,findKey:Tl,global:wt,isContextDefined:Il,ALPHABET:Fl,generateString:bd,isSpecCompliantForm:Sd,toJSONObject:Ed,isAsyncFn:vd,isThenable:kd,setImmediate:Dl,asap:Ad};function J(n,e,t,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}v.inherits(J,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:v.toJSONObject(this.config),code:this.code,status:this.status}}});const Bl=J.prototype,Ll={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{Ll[n]={value:n}});Object.defineProperties(J,Ll);Object.defineProperty(Bl,"isAxiosError",{value:!0});J.from=(n,e,t,r,s,i)=>{const a=Object.create(Bl);return v.toFlatObject(n,a,function(l){return l!==Error.prototype},o=>o!=="isAxiosError"),J.call(a,n.message,e,t,r,s),a.cause=n,a.name=n.name,i&&Object.assign(a,i),a};const Pd=null;function ks(n){return v.isPlainObject(n)||v.isArray(n)}function $l(n){return v.endsWith(n,"[]")?n.slice(0,-2):n}function oa(n,e,t){return n?n.concat(e).map(function(s,i){return s=$l(s),!t&&i?"["+s+"]":s}).join(t?".":""):e}function Cd(n){return v.isArray(n)&&!n.some(ks)}const Rd=v.toFlatObject(v,{},null,function(e){return/^is[A-Z]/.test(e)});function xr(n,e,t){if(!v.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=v.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,g){return!v.isUndefined(g[p])});const r=t.metaTokens,s=t.visitor||f,i=t.dots,a=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&v.isSpecCompliantForm(e);if(!v.isFunction(s))throw new TypeError("visitor must be a function");function c(d){if(d===null)return"";if(v.isDate(d))return d.toISOString();if(!l&&v.isBlob(d))throw new J("Blob is not supported. Use a Buffer instead.");return v.isArrayBuffer(d)||v.isTypedArray(d)?l&&typeof Blob=="function"?new Blob([d]):Buffer.from(d):d}function f(d,p,g){let A=d;if(d&&!g&&typeof d=="object"){if(v.endsWith(p,"{}"))p=r?p:p.slice(0,-2),d=JSON.stringify(d);else if(v.isArray(d)&&Cd(d)||(v.isFileList(d)||v.endsWith(p,"[]"))&&(A=v.toArray(d)))return p=$l(p),A.forEach(function(y,S){!(v.isUndefined(y)||y===null)&&e.append(a===!0?oa([p],S,i):a===null?p:p+"[]",c(y))}),!1}return ks(d)?!0:(e.append(oa(g,p,i),c(d)),!1)}const u=[],h=Object.assign(Rd,{defaultVisitor:f,convertValue:c,isVisitable:ks});function m(d,p){if(!v.isUndefined(d)){if(u.indexOf(d)!==-1)throw Error("Circular reference detected in "+p.join("."));u.push(d),v.forEach(d,function(A,w){(!(v.isUndefined(A)||A===null)&&s.call(e,A,v.isString(w)?w.trim():w,p,h))===!0&&m(A,p?p.concat(w):[w])}),u.pop()}}if(!v.isObject(n))throw new TypeError("data must be an object");return m(n),e}function la(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function _i(n,e){this._pairs=[],n&&xr(n,this,e)}const Ul=_i.prototype;Ul.append=function(e,t){this._pairs.push([e,t])};Ul.toString=function(e){const t=e?function(r){return e.call(this,r,la)}:la;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function xd(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function jl(n,e,t){if(!e)return n;const r=t&&t.encode||xd;v.isFunction(t)&&(t={serialize:t});const s=t&&t.serialize;let i;if(s?i=s(e,t):i=v.isURLSearchParams(e)?e.toString():new _i(e,t).toString(r),i){const a=n.indexOf("#");a!==-1&&(n=n.slice(0,a)),n+=(n.indexOf("?")===-1?"?":"&")+i}return n}class ca{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){v.forEach(this.handlers,function(r){r!==null&&e(r)})}}const ql={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Md=typeof URLSearchParams<"u"?URLSearchParams:_i,Od=typeof FormData<"u"?FormData:null,Td=typeof Blob<"u"?Blob:null,Id={isBrowser:!0,classes:{URLSearchParams:Md,FormData:Od,Blob:Td},protocols:["http","https","file","blob","url","data"]},yi=typeof window<"u"&&typeof document<"u",As=typeof navigator=="object"&&navigator||void 0,Nd=yi&&(!As||["ReactNative","NativeScript","NS"].indexOf(As.product)<0),Fd=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Dd=yi&&window.location.href||"http://localhost",Bd=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:yi,hasStandardBrowserEnv:Nd,hasStandardBrowserWebWorkerEnv:Fd,navigator:As,origin:Dd},Symbol.toStringTag,{value:"Module"})),ve={...Bd,...Id};function Ld(n,e){return xr(n,new ve.classes.URLSearchParams,Object.assign({visitor:function(t,r,s,i){return ve.isNode&&v.isBuffer(t)?(this.append(r,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function $d(n){return v.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Ud(n){const e={},t=Object.keys(n);let r;const s=t.length;let i;for(r=0;r<s;r++)i=t[r],e[i]=n[i];return e}function Hl(n){function e(t,r,s,i){let a=t[i++];if(a==="__proto__")return!0;const o=Number.isFinite(+a),l=i>=t.length;return a=!a&&v.isArray(s)?s.length:a,l?(v.hasOwnProp(s,a)?s[a]=[s[a],r]:s[a]=r,!o):((!s[a]||!v.isObject(s[a]))&&(s[a]=[]),e(t,r,s[a],i)&&v.isArray(s[a])&&(s[a]=Ud(s[a])),!o)}if(v.isFormData(n)&&v.isFunction(n.entries)){const t={};return v.forEachEntry(n,(r,s)=>{e($d(r),s,t,0)}),t}return null}function jd(n,e,t){if(v.isString(n))try{return(e||JSON.parse)(n),v.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(0,JSON.stringify)(n)}const Rn={transitional:ql,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",s=r.indexOf("application/json")>-1,i=v.isObject(e);if(i&&v.isHTMLForm(e)&&(e=new FormData(e)),v.isFormData(e))return s?JSON.stringify(Hl(e)):e;if(v.isArrayBuffer(e)||v.isBuffer(e)||v.isStream(e)||v.isFile(e)||v.isBlob(e)||v.isReadableStream(e))return e;if(v.isArrayBufferView(e))return e.buffer;if(v.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Ld(e,this.formSerializer).toString();if((o=v.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return xr(o?{"files[]":e}:e,l&&new l,this.formSerializer)}}return i||s?(t.setContentType("application/json",!1),jd(e)):e}],transformResponse:[function(e){const t=this.transitional||Rn.transitional,r=t&&t.forcedJSONParsing,s=this.responseType==="json";if(v.isResponse(e)||v.isReadableStream(e))return e;if(e&&v.isString(e)&&(r&&!this.responseType||s)){const a=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(o){if(a)throw o.name==="SyntaxError"?J.from(o,J.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ve.classes.FormData,Blob:ve.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};v.forEach(["delete","get","head","post","put","patch"],n=>{Rn.headers[n]={}});const qd=v.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Hd=n=>{const e={};let t,r,s;return n&&n.split(`
`).forEach(function(a){s=a.indexOf(":"),t=a.substring(0,s).trim().toLowerCase(),r=a.substring(s+1).trim(),!(!t||e[t]&&qd[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},ua=Symbol("internals");function en(n){return n&&String(n).trim().toLowerCase()}function Gn(n){return n===!1||n==null?n:v.isArray(n)?n.map(Gn):String(n)}function Wd(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const Vd=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function Zr(n,e,t,r,s){if(v.isFunction(r))return r.call(this,e,t);if(s&&(e=t),!!v.isString(e)){if(v.isString(r))return e.indexOf(r)!==-1;if(v.isRegExp(r))return r.test(e)}}function Jd(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function zd(n,e){const t=v.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(s,i,a){return this[r].call(this,e,s,i,a)},configurable:!0})})}class Ne{constructor(e){e&&this.set(e)}set(e,t,r){const s=this;function i(o,l,c){const f=en(l);if(!f)throw new Error("header name must be a non-empty string");const u=v.findKey(s,f);(!u||s[u]===void 0||c===!0||c===void 0&&s[u]!==!1)&&(s[u||l]=Gn(o))}const a=(o,l)=>v.forEach(o,(c,f)=>i(c,f,l));if(v.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(v.isString(e)&&(e=e.trim())&&!Vd(e))a(Hd(e),t);else if(v.isHeaders(e))for(const[o,l]of e.entries())i(l,o,r);else e!=null&&i(t,e,r);return this}get(e,t){if(e=en(e),e){const r=v.findKey(this,e);if(r){const s=this[r];if(!t)return s;if(t===!0)return Wd(s);if(v.isFunction(t))return t.call(this,s,r);if(v.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=en(e),e){const r=v.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||Zr(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let s=!1;function i(a){if(a=en(a),a){const o=v.findKey(r,a);o&&(!t||Zr(r,r[o],o,t))&&(delete r[o],s=!0)}}return v.isArray(e)?e.forEach(i):i(e),s}clear(e){const t=Object.keys(this);let r=t.length,s=!1;for(;r--;){const i=t[r];(!e||Zr(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const t=this,r={};return v.forEach(this,(s,i)=>{const a=v.findKey(r,i);if(a){t[a]=Gn(s),delete t[i];return}const o=e?Jd(i):String(i).trim();o!==i&&delete t[i],t[o]=Gn(s),r[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return v.forEach(this,(r,s)=>{r!=null&&r!==!1&&(t[s]=e&&v.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[ua]=this[ua]={accessors:{}}).accessors,s=this.prototype;function i(a){const o=en(a);r[o]||(zd(s,a),r[o]=!0)}return v.isArray(e)?e.forEach(i):i(e),this}}Ne.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);v.reduceDescriptors(Ne.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});v.freezeMethods(Ne);function es(n,e){const t=this||Rn,r=e||t,s=Ne.from(r.headers);let i=r.data;return v.forEach(n,function(o){i=o.call(t,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function Wl(n){return!!(n&&n.__CANCEL__)}function Jt(n,e,t){J.call(this,n??"canceled",J.ERR_CANCELED,e,t),this.name="CanceledError"}v.inherits(Jt,J,{__CANCEL__:!0});function Vl(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new J("Request failed with status code "+t.status,[J.ERR_BAD_REQUEST,J.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Xd(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function Kd(n,e){n=n||10;const t=new Array(n),r=new Array(n);let s=0,i=0,a;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),f=r[i];a||(a=c),t[s]=l,r[s]=c;let u=i,h=0;for(;u!==s;)h+=t[u++],u=u%n;if(s=(s+1)%n,s===i&&(i=(i+1)%n),c-a<e)return;const m=f&&c-f;return m?Math.round(h*1e3/m):void 0}}function Gd(n,e){let t=0,r=1e3/e,s,i;const a=(c,f=Date.now())=>{t=f,s=null,i&&(clearTimeout(i),i=null),n.apply(null,c)};return[(...c)=>{const f=Date.now(),u=f-t;u>=r?a(c,f):(s=c,i||(i=setTimeout(()=>{i=null,a(s)},r-u)))},()=>s&&a(s)]}const fr=(n,e,t=3)=>{let r=0;const s=Kd(50,250);return Gd(i=>{const a=i.loaded,o=i.lengthComputable?i.total:void 0,l=a-r,c=s(l),f=a<=o;r=a;const u={loaded:a,total:o,progress:o?a/o:void 0,bytes:l,rate:c||void 0,estimated:c&&o&&f?(o-a)/c:void 0,event:i,lengthComputable:o!=null,[e?"download":"upload"]:!0};n(u)},t)},fa=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},da=n=>(...e)=>v.asap(()=>n(...e)),Yd=ve.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,ve.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(ve.origin),ve.navigator&&/(msie|trident)/i.test(ve.navigator.userAgent)):()=>!0,Qd=ve.hasStandardBrowserEnv?{write(n,e,t,r,s,i){const a=[n+"="+encodeURIComponent(e)];v.isNumber(t)&&a.push("expires="+new Date(t).toGMTString()),v.isString(r)&&a.push("path="+r),v.isString(s)&&a.push("domain="+s),i===!0&&a.push("secure"),document.cookie=a.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Zd(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function eh(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function Jl(n,e){return n&&!Zd(e)?eh(n,e):e}const ha=n=>n instanceof Ne?{...n}:n;function kt(n,e){e=e||{};const t={};function r(c,f,u,h){return v.isPlainObject(c)&&v.isPlainObject(f)?v.merge.call({caseless:h},c,f):v.isPlainObject(f)?v.merge({},f):v.isArray(f)?f.slice():f}function s(c,f,u,h){if(v.isUndefined(f)){if(!v.isUndefined(c))return r(void 0,c,u,h)}else return r(c,f,u,h)}function i(c,f){if(!v.isUndefined(f))return r(void 0,f)}function a(c,f){if(v.isUndefined(f)){if(!v.isUndefined(c))return r(void 0,c)}else return r(void 0,f)}function o(c,f,u){if(u in e)return r(c,f);if(u in n)return r(void 0,c)}const l={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(c,f,u)=>s(ha(c),ha(f),u,!0)};return v.forEach(Object.keys(Object.assign({},n,e)),function(f){const u=l[f]||s,h=u(n[f],e[f],f);v.isUndefined(h)&&u!==o||(t[f]=h)}),t}const zl=n=>{const e=kt({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:a,auth:o}=e;e.headers=a=Ne.from(a),e.url=jl(Jl(e.baseURL,e.url),n.params,n.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let l;if(v.isFormData(t)){if(ve.hasStandardBrowserEnv||ve.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((l=a.getContentType())!==!1){const[c,...f]=l?l.split(";").map(u=>u.trim()).filter(Boolean):[];a.setContentType([c||"multipart/form-data",...f].join("; "))}}if(ve.hasStandardBrowserEnv&&(r&&v.isFunction(r)&&(r=r(e)),r||r!==!1&&Yd(e.url))){const c=s&&i&&Qd.read(i);c&&a.set(s,c)}return e},th=typeof XMLHttpRequest<"u",nh=th&&function(n){return new Promise(function(t,r){const s=zl(n);let i=s.data;const a=Ne.from(s.headers).normalize();let{responseType:o,onUploadProgress:l,onDownloadProgress:c}=s,f,u,h,m,d;function p(){m&&m(),d&&d(),s.cancelToken&&s.cancelToken.unsubscribe(f),s.signal&&s.signal.removeEventListener("abort",f)}let g=new XMLHttpRequest;g.open(s.method.toUpperCase(),s.url,!0),g.timeout=s.timeout;function A(){if(!g)return;const y=Ne.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),b={data:!o||o==="text"||o==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:y,config:n,request:g};Vl(function(C){t(C),p()},function(C){r(C),p()},b),g=null}"onloadend"in g?g.onloadend=A:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(A)},g.onabort=function(){g&&(r(new J("Request aborted",J.ECONNABORTED,n,g)),g=null)},g.onerror=function(){r(new J("Network Error",J.ERR_NETWORK,n,g)),g=null},g.ontimeout=function(){let S=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const b=s.transitional||ql;s.timeoutErrorMessage&&(S=s.timeoutErrorMessage),r(new J(S,b.clarifyTimeoutError?J.ETIMEDOUT:J.ECONNABORTED,n,g)),g=null},i===void 0&&a.setContentType(null),"setRequestHeader"in g&&v.forEach(a.toJSON(),function(S,b){g.setRequestHeader(b,S)}),v.isUndefined(s.withCredentials)||(g.withCredentials=!!s.withCredentials),o&&o!=="json"&&(g.responseType=s.responseType),c&&([h,d]=fr(c,!0),g.addEventListener("progress",h)),l&&g.upload&&([u,m]=fr(l),g.upload.addEventListener("progress",u),g.upload.addEventListener("loadend",m)),(s.cancelToken||s.signal)&&(f=y=>{g&&(r(!y||y.type?new Jt(null,n,g):y),g.abort(),g=null)},s.cancelToken&&s.cancelToken.subscribe(f),s.signal&&(s.signal.aborted?f():s.signal.addEventListener("abort",f)));const w=Xd(s.url);if(w&&ve.protocols.indexOf(w)===-1){r(new J("Unsupported protocol "+w+":",J.ERR_BAD_REQUEST,n));return}g.send(i||null)})},rh=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,s;const i=function(c){if(!s){s=!0,o();const f=c instanceof Error?c:this.reason;r.abort(f instanceof J?f:new Jt(f instanceof Error?f.message:f))}};let a=e&&setTimeout(()=>{a=null,i(new J(`timeout ${e} of ms exceeded`,J.ETIMEDOUT))},e);const o=()=>{n&&(a&&clearTimeout(a),a=null,n.forEach(c=>{c.unsubscribe?c.unsubscribe(i):c.removeEventListener("abort",i)}),n=null)};n.forEach(c=>c.addEventListener("abort",i));const{signal:l}=r;return l.unsubscribe=()=>v.asap(o),l}},sh=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,s;for(;r<t;)s=r+e,yield n.slice(r,s),r=s},ih=async function*(n,e){for await(const t of ah(n))yield*sh(t,e)},ah=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},ma=(n,e,t,r)=>{const s=ih(n,e);let i=0,a,o=l=>{a||(a=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:c,value:f}=await s.next();if(c){o(),l.close();return}let u=f.byteLength;if(t){let h=i+=u;t(h)}l.enqueue(new Uint8Array(f))}catch(c){throw o(c),c}},cancel(l){return o(l),s.return()}},{highWaterMark:2})},Mr=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Xl=Mr&&typeof ReadableStream=="function",oh=Mr&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),Kl=(n,...e)=>{try{return!!n(...e)}catch{return!1}},lh=Xl&&Kl(()=>{let n=!1;const e=new Request(ve.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),pa=64*1024,Ps=Xl&&Kl(()=>v.isReadableStream(new Response("").body)),dr={stream:Ps&&(n=>n.body)};Mr&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!dr[e]&&(dr[e]=v.isFunction(n[e])?t=>t[e]():(t,r)=>{throw new J(`Response type '${e}' is not supported`,J.ERR_NOT_SUPPORT,r)})})})(new Response);const ch=async n=>{if(n==null)return 0;if(v.isBlob(n))return n.size;if(v.isSpecCompliantForm(n))return(await new Request(ve.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(v.isArrayBufferView(n)||v.isArrayBuffer(n))return n.byteLength;if(v.isURLSearchParams(n)&&(n=n+""),v.isString(n))return(await oh(n)).byteLength},uh=async(n,e)=>{const t=v.toFiniteNumber(n.getContentLength());return t??ch(e)},fh=Mr&&(async n=>{let{url:e,method:t,data:r,signal:s,cancelToken:i,timeout:a,onDownloadProgress:o,onUploadProgress:l,responseType:c,headers:f,withCredentials:u="same-origin",fetchOptions:h}=zl(n);c=c?(c+"").toLowerCase():"text";let m=rh([s,i&&i.toAbortSignal()],a),d;const p=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let g;try{if(l&&lh&&t!=="get"&&t!=="head"&&(g=await uh(f,r))!==0){let b=new Request(e,{method:"POST",body:r,duplex:"half"}),x;if(v.isFormData(r)&&(x=b.headers.get("content-type"))&&f.setContentType(x),b.body){const[C,T]=fa(g,fr(da(l)));r=ma(b.body,pa,C,T)}}v.isString(u)||(u=u?"include":"omit");const A="credentials"in Request.prototype;d=new Request(e,{...h,signal:m,method:t.toUpperCase(),headers:f.normalize().toJSON(),body:r,duplex:"half",credentials:A?u:void 0});let w=await fetch(d);const y=Ps&&(c==="stream"||c==="response");if(Ps&&(o||y&&p)){const b={};["status","statusText","headers"].forEach($=>{b[$]=w[$]});const x=v.toFiniteNumber(w.headers.get("content-length")),[C,T]=o&&fa(x,fr(da(o),!0))||[];w=new Response(ma(w.body,pa,C,()=>{T&&T(),p&&p()}),b)}c=c||"text";let S=await dr[v.findKey(dr,c)||"text"](w,n);return!y&&p&&p(),await new Promise((b,x)=>{Vl(b,x,{data:S,headers:Ne.from(w.headers),status:w.status,statusText:w.statusText,config:n,request:d})})}catch(A){throw p&&p(),A&&A.name==="TypeError"&&/fetch/i.test(A.message)?Object.assign(new J("Network Error",J.ERR_NETWORK,n,d),{cause:A.cause||A}):J.from(A,A&&A.code,n,d)}}),Cs={http:Pd,xhr:nh,fetch:fh};v.forEach(Cs,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const ga=n=>`- ${n}`,dh=n=>v.isFunction(n)||n===null||n===!1,Gl={getAdapter:n=>{n=v.isArray(n)?n:[n];const{length:e}=n;let t,r;const s={};for(let i=0;i<e;i++){t=n[i];let a;if(r=t,!dh(t)&&(r=Cs[(a=String(t)).toLowerCase()],r===void 0))throw new J(`Unknown adapter '${a}'`);if(r)break;s[a||"#"+i]=r}if(!r){const i=Object.entries(s).map(([o,l])=>`adapter ${o} `+(l===!1?"is not supported by the environment":"is not available in the build"));let a=e?i.length>1?`since :
`+i.map(ga).join(`
`):" "+ga(i[0]):"as no adapter specified";throw new J("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:Cs};function ts(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new Jt(null,n)}function _a(n){return ts(n),n.headers=Ne.from(n.headers),n.data=es.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),Gl.getAdapter(n.adapter||Rn.adapter)(n).then(function(r){return ts(n),r.data=es.call(n,n.transformResponse,r),r.headers=Ne.from(r.headers),r},function(r){return Wl(r)||(ts(n),r&&r.response&&(r.response.data=es.call(n,n.transformResponse,r.response),r.response.headers=Ne.from(r.response.headers))),Promise.reject(r)})}const Yl="1.7.9",Or={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{Or[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const ya={};Or.transitional=function(e,t,r){function s(i,a){return"[Axios v"+Yl+"] Transitional option '"+i+"'"+a+(r?". "+r:"")}return(i,a,o)=>{if(e===!1)throw new J(s(a," has been removed"+(t?" in "+t:"")),J.ERR_DEPRECATED);return t&&!ya[a]&&(ya[a]=!0,console.warn(s(a," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,a,o):!0}};Or.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function hh(n,e,t){if(typeof n!="object")throw new J("options must be an object",J.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let s=r.length;for(;s-- >0;){const i=r[s],a=e[i];if(a){const o=n[i],l=o===void 0||a(o,i,n);if(l!==!0)throw new J("option "+i+" must be "+l,J.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new J("Unknown option "+i,J.ERR_BAD_OPTION)}}const Yn={assertOptions:hh,validators:Or},Qe=Yn.validators;class Et{constructor(e){this.defaults=e,this.interceptors={request:new ca,response:new ca}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=kt(this.defaults,t);const{transitional:r,paramsSerializer:s,headers:i}=t;r!==void 0&&Yn.assertOptions(r,{silentJSONParsing:Qe.transitional(Qe.boolean),forcedJSONParsing:Qe.transitional(Qe.boolean),clarifyTimeoutError:Qe.transitional(Qe.boolean)},!1),s!=null&&(v.isFunction(s)?t.paramsSerializer={serialize:s}:Yn.assertOptions(s,{encode:Qe.function,serialize:Qe.function},!0)),Yn.assertOptions(t,{baseUrl:Qe.spelling("baseURL"),withXsrfToken:Qe.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=i&&v.merge(i.common,i[t.method]);i&&v.forEach(["delete","get","head","post","put","patch","common"],d=>{delete i[d]}),t.headers=Ne.concat(a,i);const o=[];let l=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(t)===!1||(l=l&&p.synchronous,o.unshift(p.fulfilled,p.rejected))});const c=[];this.interceptors.response.forEach(function(p){c.push(p.fulfilled,p.rejected)});let f,u=0,h;if(!l){const d=[_a.bind(this),void 0];for(d.unshift.apply(d,o),d.push.apply(d,c),h=d.length,f=Promise.resolve(t);u<h;)f=f.then(d[u++],d[u++]);return f}h=o.length;let m=t;for(u=0;u<h;){const d=o[u++],p=o[u++];try{m=d(m)}catch(g){p.call(this,g);break}}try{f=_a.call(this,m)}catch(d){return Promise.reject(d)}for(u=0,h=c.length;u<h;)f=f.then(c[u++],c[u++]);return f}getUri(e){e=kt(this.defaults,e);const t=Jl(e.baseURL,e.url);return jl(t,e.params,e.paramsSerializer)}}v.forEach(["delete","get","head","options"],function(e){Et.prototype[e]=function(t,r){return this.request(kt(r||{},{method:e,url:t,data:(r||{}).data}))}});v.forEach(["post","put","patch"],function(e){function t(r){return function(i,a,o){return this.request(kt(o||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}Et.prototype[e]=t(),Et.prototype[e+"Form"]=t(!0)});class wi{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(i){t=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const a=new Promise(o=>{r.subscribe(o),i=o}).then(s);return a.cancel=function(){r.unsubscribe(i)},a},e(function(i,a,o){r.reason||(r.reason=new Jt(i,a,o),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new wi(function(s){e=s}),cancel:e}}}function mh(n){return function(t){return n.apply(null,t)}}function ph(n){return v.isObject(n)&&n.isAxiosError===!0}const Rs={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Rs).forEach(([n,e])=>{Rs[e]=n});function Ql(n){const e=new Et(n),t=xl(Et.prototype.request,e);return v.extend(t,Et.prototype,e,{allOwnKeys:!0}),v.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return Ql(kt(n,s))},t}const me=Ql(Rn);me.Axios=Et;me.CanceledError=Jt;me.CancelToken=wi;me.isCancel=Wl;me.VERSION=Yl;me.toFormData=xr;me.AxiosError=J;me.Cancel=me.CanceledError;me.all=function(e){return Promise.all(e)};me.spread=mh;me.isAxiosError=ph;me.mergeConfig=kt;me.AxiosHeaders=Ne;me.formToJSON=n=>Hl(v.isHTMLForm(n)?new FormData(n):n);me.getAdapter=Gl.getAdapter;me.HttpStatusCode=Rs;me.default=me;async function wa(n){if(!n||n.length==0)return[0,0];const e={method:"POST",url:atob("aHR0cHM6Ly9hcGkuZ2Vla3NwaGVyZS5vbmxpbmUvYWRtaW4tYXBpL2FpZ2MvYmFsYW5jZS90b2tlbg=="),headers:{"content-type":"application/json"},data:{apikey:n.replace("sk-","")}};let t=await me.request(e);return!t||t.status!=200?[0,0]:t.data.data}function gh(n){let e,t,r,s,i,a,o,l,c,f,u=new Date(n[2]).toLocaleString()+"",h,m,d,p,g,A,w;return{c(){e=k("label"),t=k("div"),r=k("span"),r.textContent="余额查询",s=I(),i=k("div"),a=ye("账 户 余 额 : "),o=ye(n[1]),l=ye(` ¥
            `),c=k("br"),f=ye(` 
            有 效 期 : `),h=ye(u),m=I(),d=k("span"),p=I(),g=k("button"),g.textContent="刷新",E(r,"class","title"),E(i,"class","b3-label__text"),E(t,"class","fn__flex-1"),E(d,"class","fn__space"),E(g,"class","b3-button b3-button--outline fn__flex-center fn__size200"),E(e,"class","item-wrap fn__flex b3-label config__item")},m(y,S){te(y,e,S),_(e,t),_(t,r),_(t,s),_(t,i),_(i,a),_(i,o),_(i,l),_(i,c),_(i,f),_(i,h),_(e,m),_(e,d),_(e,p),_(e,g),A||(w=Y(g,"click",n[3]),A=!0)},p(y,[S]){S&2&&je(o,y[1]),S&4&&u!==(u=new Date(y[2]).toLocaleString()+"")&&je(h,u)},i:Se,o:Se,d(y){y&&Z(e),A=!1,w()}}}function _h(n,e,t){let{apiKey:r}=e,s=0,i=0;Ja(()=>{wa(r).then(o=>{t(1,s=Math.round(o.money*10)/10),t(2,i=o.expiredTime*1e3)})});const a=async()=>{wa(r).then(o=>{t(2,i=o.expiredTime*1e3),t(1,s=Math.round(o.money*10)/10)})};return n.$$set=o=>{"apiKey"in o&&t(0,r=o.apiKey)},[r,s,i,a]}let yh=class extends Ce{constructor(e){super(),Pe(this,e,_h,gh,Ae,{apiKey:0})}};function ba(n,e,t){const r=n.slice();return r[11]=e[t],r[12]=e,r[13]=t,r}function wh(n){var a,o,l,c;let e,t,r;function s(f){n[8](f,n[11])}let i={type:n[11].type,key:n[11].key,placeholder:(a=n[11])==null?void 0:a.placeholder,options:(o=n[11])==null?void 0:o.options,slider:(l=n[11])==null?void 0:l.slider,button:(c=n[11])==null?void 0:c.button};return n[11].value!==void 0&&(i.value=n[11].value),e=new Rl.Input({props:i}),he.push(()=>Me(e,"value",s)),e.$on("click",n[4]),e.$on("changed",n[5]),{c(){de(e.$$.fragment)},m(f,u){ue(e,f,u),r=!0},p(f,u){var m,d,p,g;n=f;const h={};u&4&&(h.type=n[11].type),u&4&&(h.key=n[11].key),u&4&&(h.placeholder=(m=n[11])==null?void 0:m.placeholder),u&4&&(h.options=(d=n[11])==null?void 0:d.options),u&4&&(h.slider=(p=n[11])==null?void 0:p.slider),u&4&&(h.button=(g=n[11])==null?void 0:g.button),!t&&u&4&&(t=!0,h.value=n[11].value,xe(()=>t=!1)),e.$set(h)},i(f){r||(V(e.$$.fragment,f),r=!0)},o(f){X(e.$$.fragment,f),r=!1},d(f){fe(e,f)}}}function Sa(n,e){var i;let t,r,s;return r=new Rl.Wrap({props:{title:e[11].title,description:e[11].description,direction:(i=e[11])==null?void 0:i.direction,$$slots:{default:[wh]},$$scope:{ctx:e}}}),{key:n,first:null,c(){t=Ns(),de(r.$$.fragment),this.first=t},m(a,o){te(a,t,o),ue(r,a,o),s=!0},p(a,o){var c;e=a;const l={};o&4&&(l.title=e[11].title),o&4&&(l.description=e[11].description),o&4&&(l.direction=(c=e[11])==null?void 0:c.direction),o&516&&(l.$$scope={dirty:o,ctx:e}),r.$set(l)},i(a){s||(V(r.$$.fragment,a),s=!0)},o(a){X(r.$$.fragment,a),s=!1},d(a){a&&Z(t),fe(r,a)}}}function Ea(n){let e,t;return e=new yh({props:{apiKey:n[1].getValue("apiKey")}}),{c(){de(e.$$.fragment)},m(r,s){ue(e,r,s),t=!0},p(r,s){const i={};s&2&&(i.apiKey=r[1].getValue("apiKey")),e.$set(i)},i(r){t||(V(e.$$.fragment,r),t=!0)},o(r){X(e.$$.fragment,r),t=!1},d(r){fe(e,r)}}}function bh(n){let e,t,r=[],s=new Map,i,a,o;const l=n[7].default,c=xs(l,n,n[9],null);let f=He(n[2]);const u=m=>m[11].key;for(let m=0;m<f.length;m+=1){let d=ba(n,f,m),p=u(d);s.set(p,r[m]=Sa(p,d))}let h=n[0]==="🌈 设置"&&Ea(n);return{c(){e=k("div"),c&&c.c(),t=I();for(let m=0;m<r.length;m+=1)r[m].c();i=I(),h&&h.c(),E(e,"class",a="config__tab-container "+n[3]),E(e,"data-name",n[0])},m(m,d){te(m,e,d),c&&c.m(e,null),_(e,t);for(let p=0;p<r.length;p+=1)r[p]&&r[p].m(e,null);_(e,i),h&&h.m(e,null),o=!0},p(m,[d]){c&&c.p&&(!o||d&512)&&Os(c,l,m,m[9],o?Ms(l,m[9],d,null):Ts(m[9]),null),d&52&&(f=He(m[2]),bt(),r=Xa(r,d,u,1,m,f,s,e,Nc,Sa,i,ba),St()),m[0]==="🌈 设置"?h?(h.p(m,d),d&1&&V(h,1)):(h=Ea(m),h.c(),V(h,1),h.m(e,null)):h&&(bt(),X(h,1,1,()=>{h=null}),St()),(!o||d&8&&a!==(a="config__tab-container "+m[3]))&&E(e,"class",a),(!o||d&1)&&E(e,"data-name",m[0])},i(m){if(!o){V(c,m);for(let d=0;d<f.length;d+=1)V(r[d]);V(h),o=!0}},o(m){X(c,m);for(let d=0;d<r.length;d+=1)X(r[d]);X(h),o=!1},d(m){m&&Z(e),c&&c.d(m);for(let d=0;d<r.length;d+=1)r[d].d();h&&h.d()}}}function Sh(n,e,t){let r,{$$slots:s={},$$scope:i}=e,{group:a}=e,{settingStorage:o}=e,{display:l=!0}=e,c=o.getSettingItems(a);const f=mr();function u({detail:d}){f("click",{key:d.key})}function h({detail:d}){f("changed",{group:a,...d})}function m(d,p){n.$$.not_equal(p.value,d)&&(p.value=d,t(2,c))}return n.$$set=d=>{"group"in d&&t(0,a=d.group),"settingStorage"in d&&t(1,o=d.settingStorage),"display"in d&&t(6,l=d.display),"$$scope"in d&&t(9,i=d.$$scope)},n.$$.update=()=>{n.$$.dirty&64&&t(3,r=l?"":"fn__none")},[a,o,c,r,u,h,l,s,m,i]}class Zl extends Ce{constructor(e){super(),Pe(this,e,Sh,bh,Ae,{group:0,settingStorage:1,display:6})}}function Eh(n){let e,t,r;return t=new Zl({props:{group:n[1],settingStorage:n[0],display:!0}}),t.$on("changed",n[2]),{c(){e=k("div"),de(t.$$.fragment),R(e,"margin-top","10px"),R(e,"padding","10px"),R(e,"background","none"),R(e,"border-radius","4px"),R(e,"border","1px solid var(--b3-border-color)")},m(s,i){te(s,e,i),ue(t,e,null),r=!0},p(s,[i]){const a={};i&2&&(a.group=s[1]),i&1&&(a.settingStorage=s[0]),t.$set(a)},i(s){r||(V(t.$$.fragment,s),r=!0)},o(s){X(t.$$.fragment,s),r=!1},d(s){s&&Z(e),fe(t)}}}function vh(n,e,t){let{settingStorage:r}=e,{group:s}=e;const i=({detail:a})=>{r.setValue(a.key,a.value),r.save()};return n.$$set=a=>{"settingStorage"in a&&t(0,r=a.settingStorage),"group"in a&&t(1,s=a.group)},[r,s,i]}class ec extends Ce{constructor(e){super(),Pe(this,e,vh,Eh,Ae,{settingStorage:0,group:1})}}function kh(){var t;let n=((t=window.getSelection())==null?void 0:t.toString())||"";return n||(document.querySelectorAll(".protyle-wysiwyg--select").forEach(r=>{const s=r.textContent;n+=`
`+s}),n)}function Ah(){let n="",e="";return n=document.getElementsByClassName("protyle-title__input")[0].textContent,document.querySelectorAll("[data-node-index]").forEach(r=>{e+=r.textContent+`
`}),{title:n,content:e}}async function Ph(n){const e=document.querySelectorAll(".protyle-wysiwyg--select");if(e.length===0){console.warn("没有选中的内容");return}let r=e[e.length-1].getAttribute("data-node-id");if(!r){console.warn("无法获取节点ID");return}const s=await ic("markdown","",r);for(const i of e)await oc(i.getAttribute("data-node-id"));await ac("markdown",n,s[0].doOperations[0].id)}async function Ch(n,e,t,r,s,i,a){let o="";const l=await n.messages.stream({model:e,max_tokens:t,temperature:r,messages:i},{timeout:s});for await(const c of l)if(c.type==="content_block_delta"){const f="text"in c.delta?c.delta.text:c.delta.toString();o+=f,a(o)}return o}async function Rh(n,e,t,r,s,i,a){var c,f,u;let o="";const l=await n.chat.completions.create({model:e,max_tokens:t,temperature:r,stream:!0,messages:i},{timeout:s});for await(const h of l)if((u=(f=(c=h.choices)==null?void 0:c[0])==null?void 0:f.delta)!=null&&u.content){const m=h.choices[0].delta.content;o+=m,a(o)}return o}async function xh(n,e=!1,t=!1){if(window.focus(),await navigator.clipboard.writeText(n),e&&t){Ph(n);return}Ba("生成内容已自动复制到剪贴板")}async function tc(n,e,t,r,s,i,a,o,l,c){let f="";c=c*1e3;try{switch(!0){case t.includes("claude"):f=await Ch(e,t,o,l,c,s,a);break;default:f=await Rh(n,t,o,l,c,s,a);break}return f}catch(u){console.error("生成回答时出错:",u);const h=`
生成回答时出错: `+u.message;return f+=h,a(f),f}finally{await xh(f,i,r.getValue("isReplaceSelected"))}}function Mh(n){let e,t,r,s,i,a=[{type:"button"},n[4],{class:r=["b3-button",n[3],n[2]].join(" ")},{style:n[1]}],o={};for(let l=0;l<a.length;l+=1)o=Qn(o,a[l]);return{c(){e=k("button"),t=ye(n[0]),Ei(e,o)},m(l,c){te(l,e,c),_(e,t),e.autofocus&&e.focus(),s||(i=Y(e,"click",n[8]),s=!0)},p(l,[c]){c&1&&wc(t,l[0],o.contenteditable),Ei(e,o=Fc(a,[{type:"button"},c&16&&l[4],c&12&&r!==(r=["b3-button",l[3],l[2]].join(" "))&&{class:r},c&2&&{style:l[1]}]))},i:Se,o:Se,d(l){l&&Z(e),s=!1,i()}}}function Oh(n,e,t){let r,s,i,{text:a=!1}=e,{outline:o=!1}=e,{backgroundColor:l=void 0}=e,{label:c=""}=e;function f(u){Pc.call(this,n,u)}return n.$$set=u=>{t(4,e=Qn(Qn({},e),Si(u))),"text"in u&&t(5,a=u.text),"outline"in u&&t(6,o=u.outline),"backgroundColor"in u&&t(7,l=u.backgroundColor),"label"in u&&t(0,c=u.label)},n.$$.update=()=>{n.$$.dirty&64&&t(3,r=o?"b3-button--outline":""),n.$$.dirty&32&&t(2,s=a?"b3-button--text":""),n.$$.dirty&128&&t(1,i=l?`background-color: ${l}`:"")},e=Si(e),[c,i,s,r,e,a,o,l,f]}class hr extends Ce{constructor(e){super(),Pe(this,e,Oh,Mh,Ae,{text:5,outline:6,backgroundColor:7,label:0})}}function Th(n){let e,t,r,s=n[1].title?"编辑提示词":"新增提示词",i,a,o,l,c,f,u,h,m,d,p,g,A,w,y;function S(T){n[3](T)}let b={type:"textinput",placeholder:"标题",key:"title",style:"width: 100%; margin-bottom: 10px;"};n[1].title!==void 0&&(b.value=n[1].title),o=new yn({props:b}),he.push(()=>Me(o,"value",S));function x(T){n[4](T)}let C={type:"textarea",placeholder:"内容",key:"content",style:"width: 100%; white-space: pre-wrap; word-wrap: break-word;"};return n[1].content!==void 0&&(C.value=n[1].content),f=new yn({props:C}),he.push(()=>Me(f,"value",x)),d=new hr({props:{label:"取消",text:!0,outline:!0}}),d.$on("click",n[5]),w=new hr({props:{label:"确认",text:!1,outline:!1}}),w.$on("click",n[6]),{c(){e=k("div"),t=k("div"),r=k("h3"),i=ye(s),a=I(),de(o.$$.fragment),c=I(),de(f.$$.fragment),h=I(),m=k("div"),de(d.$$.fragment),p=I(),g=k("div"),A=I(),de(w.$$.fragment),E(r,"class","b3-label"),E(g,"class","fn__space"),E(m,"class","b3-dialog__action"),E(t,"class","edit-content svelte-1ftxwb0"),E(e,"class","edit-panel svelte-1ftxwb0")},m(T,$){te(T,e,$),_(e,t),_(t,r),_(r,i),_(t,a),ue(o,t,null),_(t,c),ue(f,t,null),_(t,h),_(t,m),ue(d,m,null),_(m,p),_(m,g),_(m,A),ue(w,m,null),y=!0},p(T,[$]){(!y||$&2)&&s!==(s=T[1].title?"编辑提示词":"新增提示词")&&je(i,s);const N={};!l&&$&2&&(l=!0,N.value=T[1].title,xe(()=>l=!1)),o.$set(N);const F={};!u&&$&2&&(u=!0,F.value=T[1].content,xe(()=>u=!1)),f.$set(F)},i(T){y||(V(o.$$.fragment,T),V(f.$$.fragment,T),V(d.$$.fragment,T),V(w.$$.fragment,T),y=!0)},o(T){X(o.$$.fragment,T),X(f.$$.fragment,T),X(d.$$.fragment,T),X(w.$$.fragment,T),y=!1},d(T){T&&Z(e),fe(o),fe(f),fe(d),fe(w)}}}function Ih(n,e,t){let{showEditPanel:r=!1}=e,{currentPrompt:s}=e;const i=mr();function a(f){n.$$.not_equal(s.title,f)&&(s.title=f,t(1,s))}function o(f){n.$$.not_equal(s.content,f)&&(s.content=f,t(1,s))}const l=()=>t(0,r=!1),c=()=>i("save");return n.$$set=f=>{"showEditPanel"in f&&t(0,r=f.showEditPanel),"currentPrompt"in f&&t(1,s=f.currentPrompt)},[r,s,i,a,o,l,c]}class Nh extends Ce{constructor(e){super(),Pe(this,e,Ih,Th,Ae,{showEditPanel:0,currentPrompt:1})}}function va(n,e,t){const r=n.slice();return r[5]=e[t],r}function ka(n,e){let t,r,s,i=e[5].title+"",a,o,l,c,f,u,h,m,d,p,g;function A(){return e[2](e[5])}function w(){return e[3](e[5])}function y(){return e[4](e[5])}return{key:n,first:null,c(){t=k("div"),r=k("div"),s=k("span"),a=ye(i),o=I(),l=k("div"),c=k("button"),c.innerHTML='<svg class="b3-list-item__hinticon" style="width: 1.5em;"><use xlink:href="#iconTrashcan"></use></svg>',f=I(),u=k("button"),u.innerHTML='<svg class="b3-list-item__hinticon" style="width: 1.5em;"><use xlink:href="#iconEdit"></use></svg>',h=I(),m=k("button"),m.innerHTML='<svg class="b3-list-item__hinticon" style="width: 1.5em;"><use xlink:href="#iconPlay"></use></svg>',d=I(),E(s,"class","title"),E(r,"class","fn__flex-1"),E(c,"class","b3-list-item"),E(c,"title","删除"),E(u,"class","b3-list-item"),E(u,"title","编辑"),E(m,"class","b3-list-item"),E(m,"title","使用"),E(l,"class","fn__flex"),E(t,"class","item-wrap fn__flex b3-label config__item prompt-item svelte-1706rdx"),R(t,"height","1.5em"),this.first=t},m(S,b){te(S,t,b),_(t,r),_(r,s),_(s,a),_(t,o),_(t,l),_(l,c),_(l,f),_(l,u),_(l,h),_(l,m),_(t,d),p||(g=[Y(c,"click",A),Y(u,"click",w),Y(m,"click",y)],p=!0)},p(S,b){e=S,b&1&&i!==(i=e[5].title+"")&&je(a,i)},d(S){S&&Z(t),p=!1,we(g)}}}function Fh(n){let e,t=[],r=new Map,s=He(n[0]);const i=a=>a[5].id;for(let a=0;a<s.length;a+=1){let o=va(n,s,a),l=i(o);r.set(l,t[a]=ka(l,o))}return{c(){e=k("div");for(let a=0;a<t.length;a+=1)t[a].c();E(e,"class","b3-tab-bar b3-list b3-list--background")},m(a,o){te(a,e,o);for(let l=0;l<t.length;l+=1)t[l]&&t[l].m(e,null)},p(a,[o]){o&3&&(s=He(a[0]),t=Xa(t,o,i,1,a,s,r,e,Ic,ka,null,va))},i:Se,o:Se,d(a){a&&Z(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function Dh(n,e,t){const r=mr();let{prompts:s}=e;const i=l=>r("delete",l.id),a=l=>r("edit",l),o=l=>r("use",l);return n.$$set=l=>{"prompts"in l&&t(0,s=l.prompts)},[s,r,i,a,o]}class Bh extends Ce{constructor(e){super(),Pe(this,e,Dh,Fh,Ae,{prompts:0})}}function Aa(n){let e,t,r,s;function i(l){n[14](l)}function a(l){n[15](l)}let o={};return n[0]!==void 0&&(o.showEditPanel=n[0]),n[1]!==void 0&&(o.currentPrompt=n[1]),e=new Nh({props:o}),he.push(()=>Me(e,"showEditPanel",i)),he.push(()=>Me(e,"currentPrompt",a)),e.$on("save",n[6]),{c(){de(e.$$.fragment)},m(l,c){ue(e,l,c),s=!0},p(l,c){const f={};!t&&c&1&&(t=!0,f.showEditPanel=l[0],xe(()=>t=!1)),!r&&c&2&&(r=!0,f.currentPrompt=l[1],xe(()=>r=!1)),e.$set(f)},i(l){s||(V(e.$$.fragment,l),s=!0)},o(l){X(e.$$.fragment,l),s=!1},d(l){fe(e,l)}}}function Lh(n){let e,t,r,s,i,a,o,l;s=new Bh({props:{prompts:n[2]}}),s.$on("edit",n[11]),s.$on("delete",n[12]),s.$on("use",n[13]);let c=n[0]&&Aa(n);return{c(){e=k("div"),t=k("button"),t.textContent="+ 新建 Prompt",r=I(),de(s.$$.fragment),i=I(),c&&c.c(),E(t,"class","add-prompt-btn"),R(t,"width","90%"),R(t,"margin","8px auto"),R(t,"display","block"),R(t,"padding","4px 8px"),R(t,"border-radius","4px"),R(t,"border","none"),R(t,"cursor","pointer"),R(t,"background","var(--b3-theme-surface)"),R(t,"color","var(--b3-theme-on-surface)"),R(e,"background","none"),R(e,"border-radius","4px"),R(e,"max-height","300px"),R(e,"overflow-y","auto")},m(f,u){te(f,e,u),_(e,t),_(e,r),ue(s,e,null),_(e,i),c&&c.m(e,null),a=!0,o||(l=Y(t,"click",n[10]),o=!0)},p(f,[u]){const h={};u&4&&(h.prompts=f[2]),s.$set(h),f[0]?c?(c.p(f,u),u&1&&V(c,1)):(c=Aa(f),c.c(),V(c,1),c.m(e,null)):c&&(bt(),X(c,1,1,()=>{c=null}),St())},i(f){a||(V(s.$$.fragment,f),V(c),a=!0)},o(f){X(s.$$.fragment,f),X(c),a=!1},d(f){f&&Z(e),fe(s),c&&c.d(),o=!1,l()}}}function $h(n,e,t){let r,{promptStorage:s}=e,{searchText:i}=e,a=!1,o={id:Date.now(),title:"",content:""},l=s.prompts;function c(y){s.deletePrompt(y),t(9,l=s.prompts)}function f(y){y?t(1,o={...y}):t(1,o={id:Date.now(),title:"",content:""}),t(0,a=!0)}function u(y){t(7,i=y.content)}function h(){l.findIndex(S=>S.id===o.id)===-1?s.addPrompt(o):s.updatePrompt(o),s.save(l),t(0,a=!1),t(9,l=s.prompts)}const m=()=>f(),d=y=>f(y.detail),p=y=>c(y.detail),g=y=>u(y.detail);function A(y){a=y,t(0,a)}function w(y){o=y,t(1,o)}return n.$$set=y=>{"promptStorage"in y&&t(8,s=y.promptStorage),"searchText"in y&&t(7,i=y.searchText)},n.$$.update=()=>{n.$$.dirty&640&&t(2,r=l.filter(y=>y.title.toLowerCase().includes(i.slice(1).toLowerCase())||y.content.toLowerCase().includes(i.slice(1).toLowerCase())))},[a,o,r,c,f,u,h,i,s,l,m,d,p,g,A,w]}class Uh extends Ce{constructor(e){super(),Pe(this,e,$h,Lh,Ae,{promptStorage:8,searchText:7})}}function Pa(n){let e,t,r;function s(a){n[17](a)}let i={outputContent:n[7],isGenerating:n[8]};return n[9]!==void 0&&(i.outputContainer=n[9]),e=new vf({props:i}),he.push(()=>Me(e,"outputContainer",s)),{c(){de(e.$$.fragment)},m(a,o){ue(e,a,o),r=!0},p(a,o){const l={};o&128&&(l.outputContent=a[7]),o&256&&(l.isGenerating=a[8]),!t&&o&512&&(t=!0,l.outputContainer=a[9],xe(()=>t=!1)),e.$set(l)},i(a){r||(V(e.$$.fragment,a),r=!0)},o(a){X(e.$$.fragment,a),r=!1},d(a){fe(e,a)}}}function Ca(n){let e,t,r;function s(a){n[22](a)}let i={group:"instruction"};return n[0]!==void 0&&(i.settingStorage=n[0]),e=new ec({props:i}),he.push(()=>Me(e,"settingStorage",s)),{c(){de(e.$$.fragment)},m(a,o){ue(e,a,o),r=!0},p(a,o){const l={};!t&&o&1&&(t=!0,l.settingStorage=a[0],xe(()=>t=!1)),e.$set(l)},i(a){r||(V(e.$$.fragment,a),r=!0)},o(a){X(e.$$.fragment,a),r=!1},d(a){fe(e,a)}}}function Ra(n){let e,t,r,s;function i(l){n[23](l)}function a(l){n[24](l)}let o={};return n[2]!==void 0&&(o.searchText=n[2]),n[1]!==void 0&&(o.promptStorage=n[1]),e=new Uh({props:o}),he.push(()=>Me(e,"searchText",i)),he.push(()=>Me(e,"promptStorage",a)),{c(){de(e.$$.fragment)},m(l,c){ue(e,l,c),s=!0},p(l,c){const f={};!t&&c&4&&(t=!0,f.searchText=l[2],xe(()=>t=!1)),!r&&c&2&&(r=!0,f.promptStorage=l[1],xe(()=>r=!1)),e.$set(f)},i(l){s||(V(e.$$.fragment,l),s=!0)},o(l){X(e.$$.fragment,l),s=!1},d(l){fe(e,l)}}}function jh(n){let e,t,r,s,i,a,o,l,c,f,u,h=n[6]&&Pa(n);function m(S){n[18](S)}function d(S){n[19](S)}function p(S){n[20](S)}function g(S){n[21](S)}let A={settingStorage:n[0],handleSubmit:n[11],handleKeydown:n[12]};n[2]!==void 0&&(A.inputValue=n[2]),n[4]!==void 0&&(A.inputElement=n[4]),n[5]!==void 0&&(A.selectedModel=n[5]),n[3]!==void 0&&(A.showParams=n[3]),r=new Ff({props:A}),he.push(()=>Me(r,"inputValue",m)),he.push(()=>Me(r,"inputElement",d)),he.push(()=>Me(r,"selectedModel",p)),he.push(()=>Me(r,"showParams",g));let w=n[3]&&Ca(n),y=n[10]&&Ra(n);return{c(){e=k("div"),h&&h.c(),t=I(),de(r.$$.fragment),l=I(),c=k("div"),w&&w.c(),f=I(),y&&y.c(),R(c,"width","100%"),R(e,"width","100%")},m(S,b){te(S,e,b),h&&h.m(e,null),_(e,t),ue(r,e,null),_(e,l),_(e,c),w&&w.m(c,null),_(c,f),y&&y.m(c,null),u=!0},p(S,[b]){S[6]?h?(h.p(S,b),b&64&&V(h,1)):(h=Pa(S),h.c(),V(h,1),h.m(e,t)):h&&(bt(),X(h,1,1,()=>{h=null}),St());const x={};b&1&&(x.settingStorage=S[0]),!s&&b&4&&(s=!0,x.inputValue=S[2],xe(()=>s=!1)),!i&&b&16&&(i=!0,x.inputElement=S[4],xe(()=>i=!1)),!a&&b&32&&(a=!0,x.selectedModel=S[5],xe(()=>a=!1)),!o&&b&8&&(o=!0,x.showParams=S[3],xe(()=>o=!1)),r.$set(x),S[3]?w?(w.p(S,b),b&8&&V(w,1)):(w=Ca(S),w.c(),V(w,1),w.m(c,f)):w&&(bt(),X(w,1,1,()=>{w=null}),St()),S[10]?y?(y.p(S,b),b&1024&&V(y,1)):(y=Ra(S),y.c(),V(y,1),y.m(c,null)):y&&(bt(),X(y,1,1,()=>{y=null}),St())},i(S){u||(V(h),V(r.$$.fragment,S),V(w),V(y),u=!0)},o(S){X(h),X(r.$$.fragment,S),X(w),X(y),u=!1},d(S){S&&Z(e),h&&h.d(),fe(r),w&&w.d(),y&&y.d()}}}function qh(n,e,t){let r,{openai:s}=e,{claude:i}=e,{settingStorage:a}=e,{promptStorage:o}=e,{selectedText:l}=e,{pageContent:c}=e,f="",u,h=!1,m=a.getValue("modelSelections"),d=!1,p="",g=!1,A;async function w(){t(6,d=!0),t(8,g=!0),t(7,p="");let P=f.startsWith("/")?f.slice(1):f,oe=[];const U=l.trim().length>0;U?oe.push({role:"user",content:`${l}

${P}`}):a.getValue("isPageContent")?oe.push({role:"user",content:`${c.title}

${c.content}

${P}`}):oe.push({role:"user",content:`${P}`});try{await tc(s,i,m,a,oe,U,M=>{t(7,p=M),A&&t(9,A.scrollTop=A.scrollHeight,A)},a.getValue("maxOutputLengthInstruction"),a.getValue("temperatureInstruction"),a.getValue("responseTimeoutInstruction"))}finally{t(8,g=!1)}}function y(P){P.key==="Enter"?w():P.key==="Escape"&&console.debug("ai指令取消")}Ja(()=>{u.focus()});function S(P){A=P,t(9,A)}function b(P){f=P,t(2,f)}function x(P){u=P,t(4,u)}function C(P){m=P,t(5,m)}function T(P){h=P,t(3,h)}function $(P){a=P,t(0,a)}function N(P){f=P,t(2,f)}function F(P){o=P,t(1,o)}return n.$$set=P=>{"openai"in P&&t(13,s=P.openai),"claude"in P&&t(14,i=P.claude),"settingStorage"in P&&t(0,a=P.settingStorage),"promptStorage"in P&&t(1,o=P.promptStorage),"selectedText"in P&&t(15,l=P.selectedText),"pageContent"in P&&t(16,c=P.pageContent)},n.$$.update=()=>{n.$$.dirty&12&&t(10,r=f.trim().startsWith("/")&&!h)},[a,o,f,h,u,m,d,p,g,A,r,w,y,s,i,l,c,S,b,x,C,T,$,N,F]}class Hh extends Ce{constructor(e){super(),Pe(this,e,qh,jh,Ae,{openai:13,claude:14,settingStorage:0,promptStorage:1,selectedText:15,pageContent:16})}}var Wh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vh(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var nc={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(Wh,function(){var t=1e3,r=6e4,s=36e5,i="millisecond",a="second",o="minute",l="hour",c="day",f="week",u="month",h="quarter",m="year",d="date",p="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,A=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(U){var M=["th","st","nd","rd"],O=U%100;return"["+U+(M[(O-20)%10]||M[O]||M[0])+"]"}},y=function(U,M,O){var D=String(U);return!D||D.length>=M?U:""+Array(M+1-D.length).join(O)+U},S={s:y,z:function(U){var M=-U.utcOffset(),O=Math.abs(M),D=Math.floor(O/60),B=O%60;return(M<=0?"+":"-")+y(D,2,"0")+":"+y(B,2,"0")},m:function U(M,O){if(M.date()<O.date())return-U(O,M);var D=12*(O.year()-M.year())+(O.month()-M.month()),B=M.clone().add(D,u),H=O-B<0,j=M.clone().add(D+(H?-1:1),u);return+(-(D+(O-B)/(H?B-j:j-B))||0)},a:function(U){return U<0?Math.ceil(U)||0:Math.floor(U)},p:function(U){return{M:u,y:m,w:f,d:c,D:d,h:l,m:o,s:a,ms:i,Q:h}[U]||String(U||"").toLowerCase().replace(/s$/,"")},u:function(U){return U===void 0}},b="en",x={};x[b]=w;var C="$isDayjsObject",T=function(U){return U instanceof P||!(!U||!U[C])},$=function U(M,O,D){var B;if(!M)return b;if(typeof M=="string"){var H=M.toLowerCase();x[H]&&(B=H),O&&(x[H]=O,B=H);var j=M.split("-");if(!B&&j.length>1)return U(j[0])}else{var L=M.name;x[L]=M,B=L}return!D&&B&&(b=B),B||!D&&b},N=function(U,M){if(T(U))return U.clone();var O=typeof M=="object"?M:{};return O.date=U,O.args=arguments,new P(O)},F=S;F.l=$,F.i=T,F.w=function(U,M){return N(U,{locale:M.$L,utc:M.$u,x:M.$x,$offset:M.$offset})};var P=function(){function U(O){this.$L=$(O.locale,null,!0),this.parse(O),this.$x=this.$x||O.x||{},this[C]=!0}var M=U.prototype;return M.parse=function(O){this.$d=function(D){var B=D.date,H=D.utc;if(B===null)return new Date(NaN);if(F.u(B))return new Date;if(B instanceof Date)return new Date(B);if(typeof B=="string"&&!/Z$/i.test(B)){var j=B.match(g);if(j){var L=j[2]-1||0,z=(j[7]||"0").substring(0,3);return H?new Date(Date.UTC(j[1],L,j[3]||1,j[4]||0,j[5]||0,j[6]||0,z)):new Date(j[1],L,j[3]||1,j[4]||0,j[5]||0,j[6]||0,z)}}return new Date(B)}(O),this.init()},M.init=function(){var O=this.$d;this.$y=O.getFullYear(),this.$M=O.getMonth(),this.$D=O.getDate(),this.$W=O.getDay(),this.$H=O.getHours(),this.$m=O.getMinutes(),this.$s=O.getSeconds(),this.$ms=O.getMilliseconds()},M.$utils=function(){return F},M.isValid=function(){return this.$d.toString()!==p},M.isSame=function(O,D){var B=N(O);return this.startOf(D)<=B&&B<=this.endOf(D)},M.isAfter=function(O,D){return N(O)<this.startOf(D)},M.isBefore=function(O,D){return this.endOf(D)<N(O)},M.$g=function(O,D,B){return F.u(O)?this[D]:this.set(B,O)},M.unix=function(){return Math.floor(this.valueOf()/1e3)},M.valueOf=function(){return this.$d.getTime()},M.startOf=function(O,D){var B=this,H=!!F.u(D)||D,j=F.p(O),L=function(mt,Oe){var it=F.w(B.$u?Date.UTC(B.$y,Oe,mt):new Date(B.$y,Oe,mt),B);return H?it:it.endOf(c)},z=function(mt,Oe){return F.w(B.toDate()[mt].apply(B.toDate("s"),(H?[0,0,0,0]:[23,59,59,999]).slice(Oe)),B)},Q=this.$W,W=this.$M,ie=this.$D,Ge="set"+(this.$u?"UTC":"");switch(j){case m:return H?L(1,0):L(31,11);case u:return H?L(1,W):L(0,W+1);case f:var ht=this.$locale().weekStart||0,zt=(Q<ht?Q+7:Q)-ht;return L(H?ie-zt:ie+(6-zt),W);case c:case d:return z(Ge+"Hours",0);case l:return z(Ge+"Minutes",1);case o:return z(Ge+"Seconds",2);case a:return z(Ge+"Milliseconds",3);default:return this.clone()}},M.endOf=function(O){return this.startOf(O,!1)},M.$set=function(O,D){var B,H=F.p(O),j="set"+(this.$u?"UTC":""),L=(B={},B[c]=j+"Date",B[d]=j+"Date",B[u]=j+"Month",B[m]=j+"FullYear",B[l]=j+"Hours",B[o]=j+"Minutes",B[a]=j+"Seconds",B[i]=j+"Milliseconds",B)[H],z=H===c?this.$D+(D-this.$W):D;if(H===u||H===m){var Q=this.clone().set(d,1);Q.$d[L](z),Q.init(),this.$d=Q.set(d,Math.min(this.$D,Q.daysInMonth())).$d}else L&&this.$d[L](z);return this.init(),this},M.set=function(O,D){return this.clone().$set(O,D)},M.get=function(O){return this[F.p(O)]()},M.add=function(O,D){var B,H=this;O=Number(O);var j=F.p(D),L=function(W){var ie=N(H);return F.w(ie.date(ie.date()+Math.round(W*O)),H)};if(j===u)return this.set(u,this.$M+O);if(j===m)return this.set(m,this.$y+O);if(j===c)return L(1);if(j===f)return L(7);var z=(B={},B[o]=r,B[l]=s,B[a]=t,B)[j]||1,Q=this.$d.getTime()+O*z;return F.w(Q,this)},M.subtract=function(O,D){return this.add(-1*O,D)},M.format=function(O){var D=this,B=this.$locale();if(!this.isValid())return B.invalidDate||p;var H=O||"YYYY-MM-DDTHH:mm:ssZ",j=F.z(this),L=this.$H,z=this.$m,Q=this.$M,W=B.weekdays,ie=B.months,Ge=B.meridiem,ht=function(Oe,it,Xt,xn){return Oe&&(Oe[it]||Oe(D,H))||Xt[it].slice(0,xn)},zt=function(Oe){return F.s(L%12||12,Oe,"0")},mt=Ge||function(Oe,it,Xt){var xn=Oe<12?"AM":"PM";return Xt?xn.toLowerCase():xn};return H.replace(A,function(Oe,it){return it||function(Xt){switch(Xt){case"YY":return String(D.$y).slice(-2);case"YYYY":return F.s(D.$y,4,"0");case"M":return Q+1;case"MM":return F.s(Q+1,2,"0");case"MMM":return ht(B.monthsShort,Q,ie,3);case"MMMM":return ht(ie,Q);case"D":return D.$D;case"DD":return F.s(D.$D,2,"0");case"d":return String(D.$W);case"dd":return ht(B.weekdaysMin,D.$W,W,2);case"ddd":return ht(B.weekdaysShort,D.$W,W,3);case"dddd":return W[D.$W];case"H":return String(L);case"HH":return F.s(L,2,"0");case"h":return zt(1);case"hh":return zt(2);case"a":return mt(L,z,!0);case"A":return mt(L,z,!1);case"m":return String(z);case"mm":return F.s(z,2,"0");case"s":return String(D.$s);case"ss":return F.s(D.$s,2,"0");case"SSS":return F.s(D.$ms,3,"0");case"Z":return j}return null}(Oe)||j.replace(":","")})},M.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},M.diff=function(O,D,B){var H,j=this,L=F.p(D),z=N(O),Q=(z.utcOffset()-this.utcOffset())*r,W=this-z,ie=function(){return F.m(j,z)};switch(L){case m:H=ie()/12;break;case u:H=ie();break;case h:H=ie()/3;break;case f:H=(W-Q)/6048e5;break;case c:H=(W-Q)/864e5;break;case l:H=W/s;break;case o:H=W/r;break;case a:H=W/t;break;default:H=W}return B?H:F.a(H)},M.daysInMonth=function(){return this.endOf(u).$D},M.$locale=function(){return x[this.$L]},M.locale=function(O,D){if(!O)return this.$L;var B=this.clone(),H=$(O,D,!0);return H&&(B.$L=H),B},M.clone=function(){return F.w(this.$d,this)},M.toDate=function(){return new Date(this.valueOf())},M.toJSON=function(){return this.isValid()?this.toISOString():null},M.toISOString=function(){return this.$d.toISOString()},M.toString=function(){return this.$d.toUTCString()},U}(),oe=P.prototype;return N.prototype=oe,[["$ms",i],["$s",a],["$m",o],["$H",l],["$W",c],["$M",u],["$y",m],["$D",d]].forEach(function(U){oe[U[1]]=function(M){return this.$g(M,U[0],U[1])}}),N.extend=function(U,M){return U.$i||(U(M,P,N),U.$i=!0),N},N.locale=$,N.isDayjs=T,N.unix=function(U){return N(1e3*U)},N.en=x[b],N.Ls=x,N.p={},N})})(nc);var Jh=nc.exports;const xa=Vh(Jh);function Ma(n,e,t){const r=n.slice();return r[25]=e[t],r}function Oa(n,e,t){const r=n.slice();return r[28]=e[t],r}function Ta(n){let e,t,r,s=n[28].title+"",i,a,o,l=n[28].time+"",c,f,u,h,m,d;function p(){return n[16](n[28])}function g(){return n[17](n[28])}return{c(){e=k("div"),t=k("button"),r=k("span"),i=ye(s),a=I(),o=k("div"),c=ye(l),f=I(),u=k("button"),u.innerHTML='<svg viewBox="0 0 24 24" width="14" height="14" stroke="currentColor" stroke-width="2" fill="none" class="svelte-73v9d0"><path d="M18 6L6 18M6 6l12 12"></path></svg>',h=I(),E(r,"class","svelte-73v9d0"),E(o,"class","time svelte-73v9d0"),E(t,"class","history-content svelte-73v9d0"),E(u,"class","delete-btn svelte-73v9d0"),E(u,"title","删除对话"),E(e,"class","history-item svelte-73v9d0")},m(A,w){te(A,e,w),_(e,t),_(t,r),_(r,i),_(t,a),_(t,o),_(o,c),_(e,f),_(e,u),_(e,h),m||(d=[Y(t,"click",p),Y(u,"click",pc(g))],m=!0)},p(A,w){n=A,w&2&&s!==(s=n[28].title+"")&&je(i,s),w&2&&l!==(l=n[28].time+"")&&je(c,l)},d(A){A&&Z(e),m=!1,we(d)}}}function Ia(n){let e,t=n[25].content+"",r,s,i;return{c(){e=k("div"),r=ye(t),s=I(),E(e,"class",i="message "+(n[25].role==="user"?"user":"ai")+" svelte-73v9d0")},m(a,o){te(a,e,o),_(e,r),_(e,s)},p(a,o){o&128&&t!==(t=a[25].content+"")&&je(r,t),o&128&&i!==(i="message "+(a[25].role==="user"?"user":"ai")+" svelte-73v9d0")&&E(e,"class",i)},d(a){a&&Z(e)}}}function Na(n){let e,t;return{c(){e=k("div"),t=k("div"),t.innerHTML='<div class="command-item svelte-73v9d0"><span class="command-icon svelte-73v9d0">🔍</span> <span class="command-text svelte-73v9d0">搜索</span></div> <div class="command-item svelte-73v9d0"><span class="command-icon svelte-73v9d0">📄</span> <span class="command-text svelte-73v9d0">新建文档</span></div> <div class="command-item svelte-73v9d0"><span class="command-icon svelte-73v9d0">⚙️</span> <span class="command-text svelte-73v9d0">设置</span></div>',E(t,"class","command-list svelte-73v9d0"),E(e,"class","command-palette svelte-73v9d0"),R(e,"left",n[6].x+"px"),R(e,"top",n[6].y+"px")},m(r,s){te(r,e,s),_(e,t)},p(r,s){s&64&&R(e,"left",r[6].x+"px"),s&64&&R(e,"top",r[6].y+"px")},d(r){r&&Z(e)}}}function zh(n){let e,t,r,s,i,a,o,l,c,f,u,h,m,d,p,g,A,w,y,S,b,x,C,T,$,N,F,P,oe,U=He(n[1]),M=[];for(let L=0;L<U.length;L+=1)M[L]=Ta(Oa(n,U,L));let O=He(n[7].messages),D=[];for(let L=0;L<O.length;L+=1)D[L]=Ia(Ma(n,O,L));function B(L){n[19](L)}let H={type:"select",key:"modelSelections",fnSize:!1,options:n[0].get("modelSelections").options,style:"margin-right: 2px; font-size: 12px; padding: 2px 4px; border-radius: 4px; border: none ;outline: none; height: 2em; background: transparent; align-self: center;margin-left: auto;"};n[2]!==void 0&&(H.value=n[2]),b=new yn({props:H}),he.push(()=>Me(b,"value",B)),b.$on("changed",n[20]);let j=n[5]&&Na(n);return{c(){e=k("div"),t=k("div"),r=k("div"),r.innerHTML='<h3 class="svelte-73v9d0">思源AI</h3>',s=I(),i=k("div"),a=k("button"),a.textContent="+ 新建聊天",o=I();for(let L=0;L<M.length;L+=1)M[L].c();l=I(),c=k("div"),f=k("div");for(let L=0;L<D.length;L+=1)D[L].c();u=I(),h=k("div"),m=k("button"),m.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" stroke-width="2" fill="none" class="svelte-73v9d0"><path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"></path><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9c.26.604.852.997 1.51 1H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1Z"></path></svg>',d=I(),p=k("button"),p.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" stroke-width="2" fill="none" class="svelte-73v9d0"><path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20z"></path><path d="M2 12h20"></path><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>',g=I(),A=k("button"),A.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" stroke-width="2" fill="none" class="svelte-73v9d0"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><path d="M13 2v7h7"></path></svg>',w=I(),y=k("button"),y.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" stroke-width="2" fill="none" class="svelte-73v9d0"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><path d="m21 15-5-5L5 21"></path></svg>',S=I(),de(b.$$.fragment),C=I(),T=k("div"),$=k("textarea"),N=I(),j&&j.c(),E(r,"class","history-header svelte-73v9d0"),E(a,"class","add-history-btn svelte-73v9d0"),E(a,"style",""),E(i,"class","history-list svelte-73v9d0"),E(t,"class","history-panel svelte-73v9d0"),E(f,"class","messages-container svelte-73v9d0"),E(m,"title","设置"),E(m,"class","svelte-73v9d0"),E(p,"title","联网"),E(p,"class","svelte-73v9d0"),E(A,"title","文件"),E(A,"class","svelte-73v9d0"),E(y,"title","图片"),E(y,"class","svelte-73v9d0"),E(h,"class","toolbar svelte-73v9d0"),E($,"placeholder","Enter 发送，Shift + Enter 换行"),E($,"class","svelte-73v9d0"),E(T,"class","input-container svelte-73v9d0"),E(c,"class","chat-panel svelte-73v9d0"),E(e,"class","chat-container svelte-73v9d0")},m(L,z){te(L,e,z),_(e,t),_(t,r),_(t,s),_(t,i),_(i,a),_(i,o);for(let Q=0;Q<M.length;Q+=1)M[Q]&&M[Q].m(i,null);_(e,l),_(e,c),_(c,f);for(let Q=0;Q<D.length;Q+=1)D[Q]&&D[Q].m(f,null);n[18](f),_(c,u),_(c,h),_(h,m),_(h,d),_(h,p),_(h,g),_(h,A),_(h,w),_(h,y),_(h,S),ue(b,h,null),_(c,C),_(c,T),_(T,$),Fe($,n[3]),_(T,N),j&&j.m(T,null),F=!0,P||(oe=[Y(a,"click",n[9]),Y(m,"click",n[12]),Y($,"input",n[21]),Y($,"input",n[11]),Y($,"keydown",n[22])],P=!0)},p(L,[z]){if(z&1154){U=He(L[1]);let W;for(W=0;W<U.length;W+=1){const ie=Oa(L,U,W);M[W]?M[W].p(ie,z):(M[W]=Ta(ie),M[W].c(),M[W].m(i,null))}for(;W<M.length;W+=1)M[W].d(1);M.length=U.length}if(z&128){O=He(L[7].messages);let W;for(W=0;W<O.length;W+=1){const ie=Ma(L,O,W);D[W]?D[W].p(ie,z):(D[W]=Ia(ie),D[W].c(),D[W].m(f,null))}for(;W<D.length;W+=1)D[W].d(1);D.length=O.length}const Q={};z&1&&(Q.options=L[0].get("modelSelections").options),!x&&z&4&&(x=!0,Q.value=L[2],xe(()=>x=!1)),b.$set(Q),z&8&&Fe($,L[3]),L[5]?j?j.p(L,z):(j=Na(L),j.c(),j.m(T,null)):j&&(j.d(1),j=null)},i(L){F||(V(b.$$.fragment,L),F=!0)},o(L){X(b.$$.fragment,L),F=!1},d(L){L&&Z(e),Zn(M,L),Zn(D,L),n[18](null),fe(b),j&&j.d(),P=!1,we(oe)}}}function Xh(n,e,t){let r,{openai:s}=e,{claude:i}=e,{settingStorage:a}=e,{chatHistoryStorage:o}=e,l=a.getValue("modelSelections"),c=o.dump();console.debug(a,s,i);let f="",u;Ac(()=>{u&&t(4,u.scrollTop=u.scrollHeight,u)});let h="",m=!1;async function d(){if(f.trim()){t(7,r.messages=[...r.messages,{role:"user",content:f}],r),o.update(r),t(3,f="");try{m=!0,h="",t(7,r.messages=[...r.messages,{role:"assistant",content:""}],r),await tc(s,i,a.getValue("modelSelections"),a,r.messages,!1,P=>{t(7,r.messages[r.messages.length-1].content=P,r)},a.getValue("maxOutputLengthChat"),a.getValue("temperatureChat"),a.getValue("responseTimeoutChat"))}catch(P){console.error("AI 响应出错:",P)}finally{m=!1,o.update(r)}}}function p(){const P={id:Date.now(),title:"新的对话",time:xa().format("YYYY/M/D HH:mm:ss"),messages:[{role:"system",content:"You are a helpful assistant. You can help me by answering my questions. You can also ask me questions."}]};o.add(P),t(1,c=o.dump()),t(7,r=P)}function g(P){if(o.delete(P),o.data.length===0){const oe={id:Date.now(),title:"新的对话",time:xa().format("YYYY/M/D HH:mm:ss"),messages:[{role:"system",content:"You are a helpful assistant. You can help me by answering my questions. You can also ask me questions."}]};o.add(oe)}t(1,c=o.dump()),t(7,r=c[0])}let A=!1,w={x:0,y:0};function y(P){const oe=P.target;if(oe.value==="/"&&oe.selectionStart===1){const U=oe.getBoundingClientRect();t(5,A=!0),t(6,w={x:U.left,y:U.top+30})}}function S(){const P=new lt.Dialog({title:"",content:'<div id="chat-params-panel" style="height: 100%; margin:0px; padding:0px;"></div>',width:"40%",height:"40%",hideCloseIcon:!0});new ec({target:P.element.querySelector("#chat-params-panel"),props:{settingStorage:a,group:"chat"}})}const b=P=>t(7,r=P),x=P=>g(P.id);function C(P){he[P?"unshift":"push"](()=>{u=P,t(4,u)})}function T(P){l=P,t(2,l)}const $=({detail:P})=>{a.setValue(P.key,P.value),a.save()};function N(){f=this.value,t(3,f)}const F=P=>{P.key==="Enter"&&!P.shiftKey&&(P.preventDefault(),d())};return n.$$set=P=>{"openai"in P&&t(13,s=P.openai),"claude"in P&&t(14,i=P.claude),"settingStorage"in P&&t(0,a=P.settingStorage),"chatHistoryStorage"in P&&t(15,o=P.chatHistoryStorage)},n.$$.update=()=>{n.$$.dirty&2&&t(7,r=c[0])},[a,c,l,f,u,A,w,r,d,p,g,y,S,s,i,o,b,x,C,T,$,N,F]}class Kh extends Ce{constructor(e){super(),Pe(this,e,Xh,zh,Ae,{openai:13,claude:14,settingStorage:0,chatHistoryStorage:15})}}function Gh(n,e,t,r){const s=new lt.Dialog({title:"",content:'<div id="ai-instruction""></div>',width:"40%",hideCloseIcon:!0}),i=kh(),a=Ah();n.getValue("apiKey").trim().length<=0&&La("请先设置API Key"),new Hh({target:s.element.querySelector("#ai-instruction"),props:{openai:e,claude:t,settingStorage:n,promptStorage:r,selectedText:i,pageContent:a}})}function Yh(n,e,t,r){const s=new lt.Dialog({title:"",content:'<div id="ai-chat" style="height: 100%; margin:0px; padding:0px;"></div>',width:"60%",height:"80%",hideCloseIcon:!0});new Kh({target:s.element.querySelector("#ai-chat"),props:{openai:e,claude:t,settingStorage:n,chatHistoryStorage:r}})}function Qh(n){let e,t,r,s,i,a,o,l,c,f,u,h,m,d,p,g,A,w,y,S,b,x,C;return{c(){e=k("div"),t=k("h2"),t.textContent="token",r=I(),s=k("p"),s.textContent=`token
        是模型用来表示自然语言文本的基本单位，可以直观的理解为“字”或“词”；通常 1
        个中文词语、1 个英文单词、1 个数字或 1 个符号计为 1 个 token。`,i=I(),a=k("h2"),a.textContent="Temperature 设置",o=I(),l=k("p"),l.innerHTML=`​<span data-type="code">temperature</span>​ 参数默认为
        1.0。建议您根据如下表格，按使用场景设置
        <span data-type="code">temperature</span>​。`,c=I(),f=k("table"),f.innerHTML="<thead><tr><th>场景</th> <th>温度</th></tr></thead> <tbody><tr><td>代码生成/数学解题</td> <td>0.0</td></tr> <tr><td>数据抽取/分析</td> <td>1.0</td></tr> <tr><td>通用对话</td> <td>1.3</td></tr> <tr><td>翻译</td> <td>1.3</td></tr> <tr><td>创意类写作/诗歌创作</td> <td>1.5</td></tr></tbody>",u=I(),h=k("h2"),h.textContent="model",m=I(),d=k("p"),d.textContent="扣减费用 = token 消耗量 × 模型单价，对应的费用将直接余额中进行扣减。",p=I(),g=k("table"),g.innerHTML='<thead><tr><th>模型</th> <th>上下文长度</th> <th>最大输出长度</th> <th>输入价格<br/></th> <th>输出价格</th></tr></thead> <tbody><tr><td><span data-type="strong">deepseek-chat</span></td> <td>64K</td> <td>8K</td> <td>1元/百万tokens</td> <td>2元/百万tokens</td></tr> <tr><td>qwen-max</td> <td>32,768</td> <td>8,192</td> <td>20元/百万tokens</td> <td>60元/百万tokens</td></tr> <tr><td>qwen-plus</td> <td>129,024</td> <td>8,192</td> <td>0.8元/百万tokens</td> <td>2元/百万tokens</td></tr> <tr><td>qwen-turbo</td> <td>1,000,000</td> <td>8,192</td> <td>0.3元/百万tokens</td> <td>0.6元/百万tokens</td></tr> <tr><td>qwen-long</td> <td>10,000,000</td> <td>6,000</td> <td>0.25元/百万tokens</td> <td>1元/百万tokens</td></tr> <tr><td><span data-type="s">gpt-3.5-turbo</span></td> <td></td> <td></td> <td><span data-type="s">6元/百万tokens</span></td> <td><span data-type="s">18元/百万tokens</span></td></tr> <tr><td>gpt-4o-mini</td> <td></td> <td></td> <td>1.8元/百万tokens</td> <td>7.2元/百万tokens</td></tr> <tr><td>gpt-4o</td> <td></td> <td></td> <td>30元/百万tokens</td> <td>120元/百万tokens</td></tr> <tr><td><span data-type="strong text" style="color: var(--b3-font-color8);">gpt-4-turbo</span></td> <td></td> <td></td> <td>120元/百万tokens</td> <td>360元/百万tokens</td></tr> <tr><td>claude-3-5-haiku</td> <td></td> <td></td> <td>12元/百万tokens</td> <td>60元/百万tokens</td></tr> <tr><td>claude-3-5-sonnet</td> <td></td> <td></td> <td>36元/百万tokens</td> <td>180元/百万tokens</td></tr> <tr><td><span data-type="strong text" style="color: var(--b3-font-color8);">claude-3-opus</span></td> <td></td> <td></td> <td>180元/百万tokens</td> <td>900元/百万tokens</td></tr> <tr><td>gemini-1.5-flash</td> <td></td> <td></td> <td>0.896元/百万tokens</td> <td>3.6元/百万tokens</td></tr> <tr><td>gemini-1.5-pro</td> <td></td> <td></td> <td>15元/百万tokens</td> <td>60元/百万tokens</td></tr></tbody>',A=I(),w=k("h3"),w.textContent="排行榜",y=I(),S=k("p"),S.innerHTML='<a href="https://www.datalearner.com/ai-models/leaderboard/datalearner-llm-leaderboard">大模型综合能力排行榜</a>',b=I(),x=k("p"),x.innerHTML='<a href="https://www.datalearner.com/ai-models/leaderboard/datalearner-llm-coding-leaderboard#google_vignette">大模型编程能力排行榜</a>',E(e,"class",C="b3-typography "+n[0]),R(e,"margin","10px auto"),R(e,"max-height","80vh"),R(e,"overflow-y","auto"),R(e,"width","95%"),R(e,"max-width","1200px")},m(T,$){te(T,e,$),_(e,t),_(e,r),_(e,s),_(e,i),_(e,a),_(e,o),_(e,l),_(e,c),_(e,f),_(e,u),_(e,h),_(e,m),_(e,d),_(e,p),_(e,g),_(e,A),_(e,w),_(e,y),_(e,S),_(e,b),_(e,x)},p(T,[$]){$&1&&C!==(C="b3-typography "+T[0])&&E(e,"class",C)},i:Se,o:Se,d(T){T&&Z(e)}}}function Zh(n,e,t){let r,{display:s=!0}=e;return n.$$set=i=>{"display"in i&&t(1,s=i.display)},n.$$.update=()=>{n.$$.dirty&2&&t(0,r=s?"":"fn__none")},[r,s]}let em=class extends Ce{constructor(e){super(),Pe(this,e,Zh,Qh,Ae,{display:1})}};function tm(n){let e,t,r,s,i,a,o,l,c,f,u,h,m,d,p,g,A,w,y,S,b,x,C,T,$,N,F,P,oe,U,M,O,D,B,H,j,L,z,Q,W;return{c(){e=k("div"),t=k("h1"),t.textContent="功能介绍",r=I(),s=k("h2"),s.textContent="指令模式",i=I(),a=k("p"),a.textContent="快捷键：option + command + k",o=I(),l=k("div"),l.innerHTML='<img src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/yyy.jpg" alt=""/>',c=I(),f=k("h3"),f.textContent="设置超参数",u=I(),h=k("div"),h.innerHTML='<img src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/xx.jpg" alt=""/>',m=I(),d=k("h3"),d.textContent="选择模型",p=I(),g=k("div"),g.innerHTML='<img src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/WechatIMG252.jpg" alt=""/>',A=I(),w=k("h3"),w.textContent="无中生有",y=I(),S=k("p"),S.textContent="当前文档中没有写入任何内容，直接通过指令让大模型帮助生成内容。",b=I(),x=k("div"),x.innerHTML=`<video controls="" src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/%E6%97%A0%E4%B8%AD%E7%94%9F%E6%9C%89.mp4" data-src=""><track kind="captions" label="中文字幕" src="" default=""/>
            不支持视频播放。</video>`,C=I(),T=k("h3"),T.textContent="修改润色",$=I(),N=k("div"),N.innerHTML=`<video controls="" src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/%E6%80%BB%E7%BB%93%E6%96%87%E6%A1%A3.mp4" data-src=""><track kind="captions" label="中文字幕" src="" default=""/>
            不支持视频播放。</video>`,F=I(),P=k("h3"),P.textContent="扩写",oe=I(),U=k("div"),U.innerHTML=`<video controls="" src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/%E6%89%A9%E5%86%99.mp4" data-src=""><track kind="captions" label="中文字幕" src="" default=""/>
            不支持视频播放。</video>`,M=I(),O=k("h2"),O.textContent="聊天模式",D=I(),B=k("p"),B.textContent="开发中...",H=I(),j=k("h2"),j.textContent="来提意见",L=I(),z=k("img"),E(a,"id","20250116161508-2ifhw0n"),E(l,"class","iframe"),E(h,"class","iframe"),E(g,"class","iframe"),E(x,"class","iframe"),E(N,"class","iframe"),E(U,"class","iframe"),lc(z.src,Q="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/WechatIMG6765.jpg")||E(z,"src",Q),E(z,"alt",""),R(z,"width","50%"),R(z,"height","auto"),E(e,"class",W="b3-typography "+n[0]),R(e,"max-width","800px"),R(e,"margin","0 auto")},m(ie,Ge){te(ie,e,Ge),_(e,t),_(e,r),_(e,s),_(e,i),_(e,a),_(e,o),_(e,l),_(e,c),_(e,f),_(e,u),_(e,h),_(e,m),_(e,d),_(e,p),_(e,g),_(e,A),_(e,w),_(e,y),_(e,S),_(e,b),_(e,x),_(e,C),_(e,T),_(e,$),_(e,N),_(e,F),_(e,P),_(e,oe),_(e,U),_(e,M),_(e,O),_(e,D),_(e,B),_(e,H),_(e,j),_(e,L),_(e,z)},p(ie,[Ge]){Ge&1&&W!==(W="b3-typography "+ie[0])&&E(e,"class",W)},i:Se,o:Se,d(ie){ie&&Z(e)}}}function nm(n,e,t){let r,{display:s=!0}=e;return n.$$set=i=>{"display"in i&&t(1,s=i.display)},n.$$.update=()=>{n.$$.dirty&2&&t(0,r=s?"":"fn__none")},[r,s]}let rm=class extends Ce{constructor(e){super(),Pe(this,e,nm,tm,Ae,{display:1})}};function Fa(n,e,t){const r=n.slice();return r[8]=e[t],r}function Da(n){let e,t,r,s,i;function a(){return n[4](n[8])}return{c(){e=k("li"),t=k("span"),t.textContent=`${n[8]}`,r=I(),E(t,"class","b3-list-item__text"),E(e,"data-name","editor"),E(e,"class","b3-list-item"),ce(e,"b3-list-item--focus",n[8]===n[2])},m(o,l){te(o,e,l),_(e,t),_(e,r),s||(i=[Y(e,"click",a),Y(e,"keydown",im)],s=!0)},p(o,l){n=o,l&12&&ce(e,"b3-list-item--focus",n[8]===n[2])},d(o){o&&Z(e),s=!1,we(i)}}}function sm(n){let e,t,r,s,i,a,o,l,c,f,u,h,m,d,p,g,A,w,y=He(n[3]),S=[];for(let b=0;b<y.length;b+=1)S[b]=Da(Fa(n,y,b));return i=new Zl({props:{group:n[3][0],settingStorage:n[0],display:n[2]===n[3][0]}}),i.$on("changed",n[5]),o=new em({props:{display:n[2]===n[3][1]}}),c=new rm({props:{display:n[2]===n[3][2]}}),h=new hr({props:{label:"取消",text:!0,outline:!0}}),h.$on("click",n[6]),g=new hr({props:{label:"确认",text:!1,outline:!1}}),g.$on("click",n[7]),{c(){e=k("div"),t=k("ul");for(let b=0;b<S.length;b+=1)S[b].c();r=I(),s=k("div"),de(i.$$.fragment),a=I(),de(o.$$.fragment),l=I(),de(c.$$.fragment),f=I(),u=k("div"),de(h.$$.fragment),m=I(),d=k("div"),p=I(),de(g.$$.fragment),E(t,"class","b3-tab-bar b3-list b3-list--background"),E(d,"class","fn__space"),E(u,"class",A="b3-dialog__action "+(n[2]==n[3][0]?"":"fn__none")),E(s,"class","config__tab-wrap"),E(e,"class","fn__flex-1 fn__flex config__panel")},m(b,x){te(b,e,x),_(e,t);for(let C=0;C<S.length;C+=1)S[C]&&S[C].m(t,null);_(e,r),_(e,s),ue(i,s,null),_(s,a),ue(o,s,null),_(s,l),ue(c,s,null),_(s,f),_(s,u),ue(h,u,null),_(u,m),_(u,d),_(u,p),ue(g,u,null),w=!0},p(b,[x]){if(x&12){y=He(b[3]);let N;for(N=0;N<y.length;N+=1){const F=Fa(b,y,N);S[N]?S[N].p(F,x):(S[N]=Da(F),S[N].c(),S[N].m(t,null))}for(;N<S.length;N+=1)S[N].d(1);S.length=y.length}const C={};x&1&&(C.settingStorage=b[0]),x&4&&(C.display=b[2]===b[3][0]),i.$set(C);const T={};x&4&&(T.display=b[2]===b[3][1]),o.$set(T);const $={};x&4&&($.display=b[2]===b[3][2]),c.$set($),(!w||x&4&&A!==(A="b3-dialog__action "+(b[2]==b[3][0]?"":"fn__none")))&&E(u,"class",A)},i(b){w||(V(i.$$.fragment,b),V(o.$$.fragment,b),V(c.$$.fragment,b),V(h.$$.fragment,b),V(g.$$.fragment,b),w=!0)},o(b){X(i.$$.fragment,b),X(o.$$.fragment,b),X(c.$$.fragment,b),X(h.$$.fragment,b),X(g.$$.fragment,b),w=!1},d(b){b&&Z(e),Zn(S,b),fe(i),fe(o),fe(c),fe(h),fe(g)}}}const im=()=>{};function am(n,e,t){let r=["🌈 设置","💬 公告","✨ 功能"],s=r[0],{settingStorage:i}=e,{dialog:a}=e;const o=u=>{t(2,s=u)},l=({detail:u})=>{i.setValue(u.key,u.value)},c=()=>{i.load(),a.destroy()},f=()=>{i.save(),a.destroy()};return n.$$set=u=>{"settingStorage"in u&&t(0,i=u.settingStorage),"dialog"in u&&t(1,a=u.dialog)},[i,a,s,r,o,l,c,f]}class om extends Ce{constructor(e){super(),Pe(this,e,am,sm,Ae,{settingStorage:0,dialog:1})}}const lm=`<symbol id="iconFace" viewBox="0 0 32 32">
<path d="M13.667 17.333c0 0.92-0.747 1.667-1.667 1.667s-1.667-0.747-1.667-1.667 0.747-1.667 1.667-1.667 1.667 0.747 1.667 1.667zM20 15.667c-0.92 0-1.667 0.747-1.667 1.667s0.747 1.667 1.667 1.667 1.667-0.747 1.667-1.667-0.747-1.667-1.667-1.667zM29.333 16c0 7.36-5.973 13.333-13.333 13.333s-13.333-5.973-13.333-13.333 5.973-13.333 13.333-13.333 13.333 5.973 13.333 13.333zM14.213 5.493c1.867 3.093 5.253 5.173 9.12 5.173 0.613 0 1.213-0.067 1.787-0.16-1.867-3.093-5.253-5.173-9.12-5.173-0.613 0-1.213 0.067-1.787 0.16zM5.893 12.627c2.28-1.293 4.040-3.4 4.88-5.92-2.28 1.293-4.040 3.4-4.88 5.92zM26.667 16c0-1.040-0.16-2.040-0.44-2.987-0.933 0.2-1.893 0.32-2.893 0.32-4.173 0-7.893-1.92-10.347-4.92-1.4 3.413-4.187 6.093-7.653 7.4 0.013 0.053 0 0.12 0 0.187 0 5.88 4.787 10.667 10.667 10.667s10.667-4.787 10.667-10.667z"></path>
</symbol>`,cm=`<symbol id="iconSaving" viewBox="0 0 32 32">
<path d="M20 13.333c0-0.733 0.6-1.333 1.333-1.333s1.333 0.6 1.333 1.333c0 0.733-0.6 1.333-1.333 1.333s-1.333-0.6-1.333-1.333zM10.667 12h6.667v-2.667h-6.667v2.667zM29.333 10v9.293l-3.76 1.253-2.24 7.453h-7.333v-2.667h-2.667v2.667h-7.333c0 0-3.333-11.28-3.333-15.333s3.28-7.333 7.333-7.333h6.667c1.213-1.613 3.147-2.667 5.333-2.667 1.107 0 2 0.893 2 2 0 0.28-0.053 0.533-0.16 0.773-0.187 0.453-0.347 0.973-0.427 1.533l3.027 3.027h2.893zM26.667 12.667h-1.333l-4.667-4.667c0-0.867 0.12-1.72 0.347-2.547-1.293 0.333-2.347 1.293-2.787 2.547h-8.227c-2.573 0-4.667 2.093-4.667 4.667 0 2.507 1.627 8.867 2.68 12.667h2.653v-2.667h8v2.667h2.68l2.067-6.867 3.253-1.093v-4.707z"></path>
</symbol>`;class um extends lt.Plugin{constructor(t){super(t);Re(this,"_isMobile");Re(this,"_settingStorage");Re(this,"_promptStorage");Re(this,"_chatHistoryStorage");Re(this,"_openai");Re(this,"_claude");this._settingStorage=new bf(this,Ss),this._promptStorage=new wf(this,Es),this._chatHistoryStorage=new yf(this,Cl),this._isMobile=lt.getFrontend()==="mobile"||lt.getFrontend()==="browser-mobile"}async onload(){console.log("onload...."),this._settingStorage.load().then(()=>{const t=this._settingStorage.getValue("apiKey");this._openai=new ee({baseURL:`${ta}/v1`,apiKey:t,dangerouslyAllowBrowser:!0}),this._claude=new se({baseURL:`${ta}/claude`,apiKey:t,dangerouslyAllowBrowser:!0})}),this._promptStorage.load(),this._chatHistoryStorage.load(),this.addIcons(lm),this.addIcons(cm),this.addCommand({langKey:"Instruction",hotkey:"⌥⌘K",callback:()=>Gh(this._settingStorage,this._openai,this._claude,this._promptStorage)}),this.addCommand({langKey:"Chat",hotkey:"⌥⌘L",callback:()=>Yh(this._settingStorage,this._openai,this._claude,this._chatHistoryStorage)}),console.log("onload....end")}onLayoutReady(){}uninstall(){this.removeData(Ss),this.removeData(Es),La("数据已清除，思源AI插件卸载成功！")}openSetting(){if(!this._settingStorage)return;if(this._isMobile){Ba("请在桌面端使用");return}let t=new lt.Dialog({title:"思源AI设置",width:"70%",height:"60%",content:'<div class="b3-dialog__content" id="AISettingPanel" ></div>'});new om({target:t.element.querySelector("#AISettingPanel"),props:{settingStorage:this._settingStorage,dialog:t}})}}module.exports=um;
