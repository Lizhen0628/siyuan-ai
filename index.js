"use strict";var Tl=Object.defineProperty;var Ml=(n,e,t)=>e in n?Tl(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ee=(n,e,t)=>Ml(n,typeof e!="symbol"?e+"":e,t);const wt=require("siyuan");async function ua(n,e){let t=await wt.fetchSyncPost(n,e);return t.code===0?t.data:null}async function fa(n,e=7e3){return ua("/api/notification/pushMsg",{msg:n,timeout:e})}async function Il(n,e=7e3){return ua("/api/notification/pushErrMsg",{msg:n,timeout:e})}function ie(){}const da=n=>n;function Dn(n,e){for(const t in e)n[t]=e[t];return n}function ha(n){return n()}function ni(){return Object.create(null)}function ae(n){n.forEach(ha)}function ds(n){return typeof n=="function"}function Ue(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let _n;function Fl(n,e){return n===e?!0:(_n||(_n=document.createElement("a")),_n.href=e,n===_n.href)}function Nl(n){return Object.keys(n).length===0}function hs(n,e,t,r){if(n){const s=ma(n,e,t,r);return n[0](s)}}function ma(n,e,t,r){return n[1]&&r?Dn(t.ctx.slice(),n[1](r(e))):t.ctx}function ms(n,e,t,r){if(n[2]&&r){const s=n[2](r(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const i=[],a=Math.max(e.dirty.length,s.length);for(let o=0;o<a;o+=1)i[o]=e.dirty[o]|s[o];return i}return e.dirty|s}return e.dirty}function ps(n,e,t,r,s,i){if(s){const a=ma(e,t,r,i);n.p(a,s)}}function gs(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let r=0;r<t;r++)e[r]=-1;return e}return-1}function ri(n){const e={};for(const t in n)t[0]!=="$"&&(e[t]=n[t]);return e}const Bl=["",!0,1,"true","contenteditable"],pa=typeof window<"u";let $l=pa?()=>window.performance.now():()=>Date.now(),_s=pa?n=>requestAnimationFrame(n):ie;const St=new Set;function ga(n){St.forEach(e=>{e.c(n)||(St.delete(e),e.f())}),St.size!==0&&_s(ga)}function Ll(n){let e;return St.size===0&&_s(ga),{promise:new Promise(t=>{St.add(e={c:n,f:t})}),abort(){St.delete(e)}}}function b(n,e){n.appendChild(e)}function _a(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function Dl(n){const e=P("style");return e.textContent="/* empty */",Ul(_a(n),e),e.sheet}function Ul(n,e){return b(n.head||n,e),e.sheet}function V(n,e,t){n.insertBefore(e,t||null)}function q(n){n.parentNode&&n.parentNode.removeChild(n)}function ya(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function P(n){return document.createElement(n)}function ce(n){return document.createTextNode(n)}function T(){return ce(" ")}function ys(){return ce("")}function W(n,e,t,r){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}function R(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}const jl=["width","height"];function si(n,e){const t=Object.getOwnPropertyDescriptors(n.__proto__);for(const r in e)e[r]==null?n.removeAttribute(r):r==="style"?n.style.cssText=e[r]:r==="__value"?n.value=n[r]=e[r]:t[r]&&t[r].set&&jl.indexOf(r)===-1?n[r]=e[r]:R(n,r,e[r])}function Ur(n){return n===""?null:+n}function ql(n){return Array.from(n.childNodes)}function Xe(n,e){e=""+e,n.data!==e&&(n.data=e)}function Hl(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function Wl(n,e,t){~Bl.indexOf(t)?Hl(n,e):Xe(n,e)}function be(n,e){n.value=e??""}function C(n,e,t,r){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,"")}function ii(n,e,t){for(let r=0;r<n.options.length;r+=1){const s=n.options[r];if(s.__value===e){s.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function Jl(n){const e=n.querySelector(":checked");return e&&e.__value}function K(n,e,t){n.classList.toggle(e,!!t)}function wa(n,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:r})}const Un=new Map;let jn=0;function Vl(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function Xl(n,e){const t={stylesheet:Dl(e),rules:{}};return Un.set(n,t),t}function ai(n,e,t,r,s,i,a,o=0){const l=16.666/r;let c=`{
`;for(let g=0;g<=1;g+=l){const k=e+(t-e)*i(g);c+=g*100+`%{${a(k,1-k)}}
`}const d=c+`100% {${a(t,1-t)}}
}`,u=`__svelte_${Vl(d)}_${o}`,h=_a(n),{stylesheet:m,rules:f}=Un.get(h)||Xl(h,n);f[u]||(f[u]=!0,m.insertRule(`@keyframes ${u} ${d}`,m.cssRules.length));const p=n.style.animation||"";return n.style.animation=`${p?`${p}, `:""}${u} ${r}ms linear ${s}ms 1 both`,jn+=1,u}function zl(n,e){const t=(n.style.animation||"").split(", "),r=t.filter(e?i=>i.indexOf(e)<0:i=>i.indexOf("__svelte")===-1),s=t.length-r.length;s&&(n.style.animation=r.join(", "),jn-=s,jn||Kl())}function Kl(){_s(()=>{jn||(Un.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&q(e)}),Un.clear())})}let tn;function Qt(n){tn=n}function ba(){if(!tn)throw new Error("Function called outside component initialization");return tn}function Sa(n){ba().$$.on_mount.push(n)}function Ea(){const n=ba();return(e,t,{cancelable:r=!1}={})=>{const s=n.$$.callbacks[e];if(s){const i=wa(e,t,{cancelable:r});return s.slice().forEach(a=>{a.call(n,i)}),!i.defaultPrevented}return!0}}function Gl(n,e){const t=n.$$.callbacks[e.type];t&&t.slice().forEach(r=>r.call(this,e))}const mt=[],kt=[];let Et=[];const jr=[],Ql=Promise.resolve();let qr=!1;function Yl(){qr||(qr=!0,Ql.then(Ra))}function it(n){Et.push(n)}function Aa(n){jr.push(n)}const gr=new Set;let ut=0;function Ra(){if(ut!==0)return;const n=tn;do{try{for(;ut<mt.length;){const e=mt[ut];ut++,Qt(e),Zl(e.$$)}}catch(e){throw mt.length=0,ut=0,e}for(Qt(null),mt.length=0,ut=0;kt.length;)kt.pop()();for(let e=0;e<Et.length;e+=1){const t=Et[e];gr.has(t)||(gr.add(t),t())}Et.length=0}while(mt.length);for(;jr.length;)jr.pop()();qr=!1,gr.clear(),Qt(n)}function Zl(n){if(n.fragment!==null){n.update(),ae(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(it)}}function ec(n){const e=[],t=[];Et.forEach(r=>n.indexOf(r)===-1?e.push(r):t.push(r)),t.forEach(r=>r()),Et=e}let Lt;function tc(){return Lt||(Lt=Promise.resolve(),Lt.then(()=>{Lt=null})),Lt}function _r(n,e,t){n.dispatchEvent(wa(`${e?"intro":"outro"}${t}`))}const vn=new Set;let De;function nn(){De={r:0,c:[],p:De}}function rn(){De.r||ae(De.c),De=De.p}function j(n,e){n&&n.i&&(vn.delete(n),n.i(e))}function z(n,e,t,r){if(n&&n.o){if(vn.has(n))return;vn.add(n),De.c.push(()=>{vn.delete(n),r&&(t&&n.d(1),r())}),n.o(e)}else r&&r()}const nc={duration:0};function qn(n,e,t,r){let i=e(n,t,{direction:"both"}),a=r?0:1,o=null,l=null,c=null,d;function u(){c&&zl(n,c)}function h(f,p){const g=f.b-a;return p*=Math.abs(g),{a,b:f.b,d:g,duration:p,start:f.start,end:f.start+p,group:f.group}}function m(f){const{delay:p=0,duration:g=300,easing:k=da,tick:y=ie,css:x}=i||nc,S={start:$l()+p,b:f};f||(S.group=De,De.r+=1),"inert"in n&&(f?d!==void 0&&(n.inert=d):(d=n.inert,n.inert=!0)),o||l?l=S:(x&&(u(),c=ai(n,a,f,g,p,k,x)),f&&y(0,1),o=h(S,g),it(()=>_r(n,f,"start")),Ll(w=>{if(l&&w>l.start&&(o=h(l,g),l=null,_r(n,o.b,"start"),x&&(u(),c=ai(n,a,o.b,o.duration,0,k,i.css))),o){if(w>=o.end)y(a=o.b,1-a),_r(n,o.b,"end"),l||(o.b?u():--o.group.r||ae(o.group.c)),o=null;else if(w>=o.start){const E=w-o.start;a=o.a+o.d*k(E/o.duration),y(a,1-a)}}return!!(o||l)}))}return{run(f){ds(i)?tc().then(()=>{i=i({direction:f?"in":"out"}),m(f)}):m(f)},end(){u(),o=l=null}}}function Ct(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function rc(n,e){z(n,1,1,()=>{e.delete(n.key)})}function sc(n,e,t,r,s,i,a,o,l,c,d,u){let h=n.length,m=i.length,f=h;const p={};for(;f--;)p[n[f].key]=f;const g=[],k=new Map,y=new Map,x=[];for(f=m;f--;){const A=u(s,i,f),M=t(A);let F=a.get(M);F?x.push(()=>F.p(A,e)):(F=c(M,A),F.c()),k.set(M,g[f]=F),M in p&&y.set(M,Math.abs(f-p[M]))}const S=new Set,w=new Set;function E(A){j(A,1),A.m(o,d),a.set(A.key,A),d=A.first,m--}for(;h&&m;){const A=g[m-1],M=n[h-1],F=A.key,I=M.key;A===M?(d=A.first,h--,m--):k.has(I)?!a.has(F)||S.has(F)?E(A):w.has(I)?h--:y.get(F)>y.get(I)?(w.add(F),E(A)):(S.add(I),h--):(l(M,a),h--)}for(;h--;){const A=n[h];k.has(A.key)||l(A,a)}for(;m;)E(g[m-1]);return ae(x),g}function ic(n,e){const t={},r={},s={$$scope:1};let i=n.length;for(;i--;){const a=n[i],o=e[i];if(o){for(const l in a)l in o||(r[l]=1);for(const l in o)s[l]||(t[l]=o[l],s[l]=1);n[i]=o}else for(const l in a)s[l]=1}for(const a in r)a in t||(t[a]=void 0);return t}function xa(n,e,t){const r=n.$$.props[e];r!==void 0&&(n.$$.bound[r]=t,t(n.$$.ctx[r]))}function Ne(n){n&&n.c()}function xe(n,e,t){const{fragment:r,after_update:s}=n.$$;r&&r.m(e,t),it(()=>{const i=n.$$.on_mount.map(ha).filter(ds);n.$$.on_destroy?n.$$.on_destroy.push(...i):ae(i),n.$$.on_mount=[]}),s.forEach(it)}function Pe(n,e){const t=n.$$;t.fragment!==null&&(ec(t.after_update),ae(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function ac(n,e){n.$$.dirty[0]===-1&&(mt.push(n),Yl(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function je(n,e,t,r,s,i,a=null,o=[-1]){const l=tn;Qt(n);const c=n.$$={fragment:null,ctx:[],props:i,update:ie,not_equal:s,bound:ni(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:ni(),dirty:o,skip_bound:!1,root:e.target||l.$$.root};a&&a(c.root);let d=!1;if(c.ctx=t?t(n,e.props||{},(u,h,...m)=>{const f=m.length?m[0]:h;return c.ctx&&s(c.ctx[u],c.ctx[u]=f)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](f),d&&ac(n,u)),h}):[],c.update(),d=!0,ae(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){const u=ql(e.target);c.fragment&&c.fragment.l(u),u.forEach(q)}else c.fragment&&c.fragment.c();e.intro&&j(n.$$.fragment),xe(n,e.target,e.anchor),Ra()}Qt(l)}class qe{constructor(){Ee(this,"$$");Ee(this,"$$set")}$destroy(){Pe(this,1),this.$destroy=ie}$on(e,t){if(!ds(t))return ie;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!Nl(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const oc="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(oc);function Hn(n,{delay:e=0,duration:t=400,easing:r=da}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:r,css:i=>`opacity: ${i*s}`}}function lc(){const n=window.getSelection();return n?n.toString():""}function cc(){let n="",e="";return n=document.getElementsByClassName("protyle-title__input")[0].textContent,document.querySelectorAll("[data-node-index]").forEach(r=>{e+=r.textContent+`
`}),{title:n,content:e}}function oi(n,e,t){const r=n.slice();return r[0]=e[t][0],r[18]=e[t][1],r}function uc(n){let e,t,r,s,i,a,o;return{c(){e=P("div"),t=P("input"),R(t,"id","fontSize"),R(t,"min",r=n[5].min),R(t,"max",s=n[5].max),R(t,"step",i=n[5].step),R(t,"type","range"),R(t,"style",n[8]),K(t,"b3-slider",!0),K(t,"fn__size200",n[7]),R(e,"class","b3-tooltips b3-tooltips__n"),R(e,"aria-label",n[0])},m(l,c){V(l,e,c),b(e,t),be(t,n[0]),a||(o=[W(t,"change",n[16]),W(t,"input",n[16]),W(t,"change",n[10])],a=!0)},p(l,c){c&32&&r!==(r=l[5].min)&&R(t,"min",r),c&32&&s!==(s=l[5].max)&&R(t,"max",s),c&32&&i!==(i=l[5].step)&&R(t,"step",i),c&256&&R(t,"style",l[8]),c&17&&be(t,l[0]),c&128&&K(t,"fn__size200",l[7]),c&17&&R(e,"aria-label",l[0])},d(l){l&&q(e),a=!1,ae(o)}}}function fc(n){let e,t,r,s=Ct(Object.entries(n[4])),i=[];for(let a=0;a<s.length;a+=1)i[a]=li(oi(n,s,a));return{c(){e=P("select");for(let a=0;a<i.length;a+=1)i[a].c();R(e,"id","iconPosition"),R(e,"style",n[8]),n[0]===void 0&&it(()=>n[15].call(e)),K(e,"b3-select",!0),K(e,"fn__flex-center",!0),K(e,"fn__size200",n[7])},m(a,o){V(a,e,o);for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(e,null);ii(e,n[0],!0),t||(r=[W(e,"change",n[15]),W(e,"change",n[10])],t=!0)},p(a,o){if(o&16){s=Ct(Object.entries(a[4]));let l;for(l=0;l<s.length;l+=1){const c=oi(a,s,l);i[l]?i[l].p(c,o):(i[l]=li(c),i[l].c(),i[l].m(e,null))}for(;l<i.length;l+=1)i[l].d(1);i.length=s.length}o&256&&R(e,"style",a[8]),o&17&&ii(e,a[0]),o&128&&K(e,"fn__size200",a[7])},d(a){a&&q(e),ya(i,a),t=!1,ae(r)}}}function dc(n){let e,t=n[6].label+"",r,s,i;return{c(){e=P("button"),r=ce(t),R(e,"id",n[2]),R(e,"style",n[8]),K(e,"b3-button",!0),K(e,"b3-button--outline",!0),K(e,"fn__flex-center",!0),K(e,"fn__size200",n[7])},m(a,o){V(a,e,o),b(e,r),s||(i=W(e,"click",n[9]),s=!0)},p(a,o){o&64&&t!==(t=a[6].label+"")&&Xe(r,t),o&4&&R(e,"id",a[2]),o&256&&R(e,"style",a[8]),o&128&&K(e,"fn__size200",a[7])},d(a){a&&q(e),s=!1,i()}}}function hc(n){let e,t,r;return{c(){e=P("input"),R(e,"id",n[2]),R(e,"type","number"),R(e,"style",n[8]),K(e,"b3-text-field",!0),K(e,"fn__flex-center",!0),K(e,"fn__size200",n[7])},m(s,i){V(s,e,i),be(e,n[0]),t||(r=[W(e,"input",n[14]),W(e,"change",n[10])],t=!0)},p(s,i){i&4&&R(e,"id",s[2]),i&256&&R(e,"style",s[8]),i&17&&Ur(e.value)!==s[0]&&be(e,s[0]),i&128&&K(e,"fn__size200",s[7])},d(s){s&&q(e),t=!1,ae(r)}}}function mc(n){let e,t,r,s;return{c(){e=P("textarea"),R(e,"class","b3-text-field fn__block"),R(e,"style",t=`resize: vertical; height: 10em; white-space: nowrap; ${n[8]}`)},m(i,a){V(i,e,a),be(e,n[0]),r||(s=[W(e,"input",n[13]),W(e,"change",n[10])],r=!0)},p(i,a){a&256&&t!==(t=`resize: vertical; height: 10em; white-space: nowrap; ${i[8]}`)&&R(e,"style",t),a&17&&be(e,i[0])},d(i){i&&q(e),r=!1,ae(s)}}}function pc(n){let e,t,r;return{c(){e=P("input"),R(e,"id",n[2]),R(e,"placeholder",n[3]),R(e,"style",n[8]),K(e,"b3-text-field",!0),K(e,"fn__flex-center",!0),K(e,"fn__size200",n[7])},m(s,i){V(s,e,i),be(e,n[0]),t||(r=[W(e,"input",n[12]),W(e,"change",n[10])],t=!0)},p(s,i){i&4&&R(e,"id",s[2]),i&8&&R(e,"placeholder",s[3]),i&256&&R(e,"style",s[8]),i&17&&e.value!==s[0]&&be(e,s[0]),i&128&&K(e,"fn__size200",s[7])},d(s){s&&q(e),t=!1,ae(r)}}}function gc(n){let e,t,r;return{c(){e=P("input"),R(e,"class","b3-switch fn__flex-center"),R(e,"id",n[2]),R(e,"type","checkbox"),R(e,"style",n[8])},m(s,i){V(s,e,i),e.checked=n[0],t||(r=[W(e,"change",n[11]),W(e,"change",n[10])],t=!0)},p(s,i){i&4&&R(e,"id",s[2]),i&256&&R(e,"style",s[8]),i&17&&(e.checked=s[0])},d(s){s&&q(e),t=!1,ae(r)}}}function li(n){let e,t=n[18]+"",r,s;return{c(){e=P("option"),r=ce(t),e.__value=s=n[0],be(e,e.__value)},m(i,a){V(i,e,a),b(e,r)},p(i,a){a&16&&t!==(t=i[18]+"")&&Xe(r,t),a&16&&s!==(s=i[0])&&(e.__value=s,be(e,e.__value))},d(i){i&&q(e)}}}function _c(n){let e;function t(i,a){if(i[1]==="checkbox")return gc;if(i[1]==="textinput")return pc;if(i[1]==="textarea")return mc;if(i[1]==="number")return hc;if(i[1]==="button")return dc;if(i[1]==="select")return fc;if(i[1]=="slider")return uc}let r=t(n),s=r&&r(n);return{c(){s&&s.c(),e=ys()},m(i,a){s&&s.m(i,a),V(i,e,a)},p(i,[a]){r===(r=t(i))&&s?s.p(i,a):(s&&s.d(1),s=r&&r(i),s&&(s.c(),s.m(e.parentNode,e)))},i:ie,o:ie,d(i){i&&q(e),s&&s.d(i)}}}function yc(n,e,t){let{type:r}=e,{key:s}=e,{value:i}=e,{placeholder:a=""}=e,{options:o={}}=e,{slider:l={min:0,max:100,step:1}}=e,{button:c={label:i,callback:()=>{}}}=e,{fnSize:d=!0}=e,{style:u=""}=e;const h=Ea();function m(){c==null||c.callback(),h("click",{key:s})}function f(){h("changed",{key:s,value:i})}function p(){i=this.checked,t(0,i),t(4,o)}function g(){i=this.value,t(0,i),t(4,o)}function k(){i=this.value,t(0,i),t(4,o)}function y(){i=Ur(this.value),t(0,i),t(4,o)}function x(){i=Jl(this),t(0,i),t(4,o)}function S(){i=Ur(this.value),t(0,i),t(4,o)}return n.$$set=w=>{"type"in w&&t(1,r=w.type),"key"in w&&t(2,s=w.key),"value"in w&&t(0,i=w.value),"placeholder"in w&&t(3,a=w.placeholder),"options"in w&&t(4,o=w.options),"slider"in w&&t(5,l=w.slider),"button"in w&&t(6,c=w.button),"fnSize"in w&&t(7,d=w.fnSize),"style"in w&&t(8,u=w.style)},[i,r,s,a,o,l,c,d,u,m,f,p,g,k,y,x,S]}class Pa extends qe{constructor(e){super(),je(this,e,yc,_c,Ue,{type:1,key:2,value:0,placeholder:3,options:4,slider:5,button:6,fnSize:7,style:8})}}function wc(n){let e,t,r,s,i,a,o,l,c,d;const u=n[4].default,h=hs(u,n,n[3],null);return{c(){e=P("div"),t=P("div"),r=P("span"),s=ce(n[0]),i=T(),a=P("div"),o=T(),l=P("span"),c=T(),h&&h.c(),R(r,"class","title svelte-ikiu6h"),R(a,"class","b3-label__text"),R(t,"class","fn__flex-1"),R(l,"class","fn__space"),R(e,"class","item-wrap fn__flex b3-label config__item svelte-ikiu6h")},m(m,f){V(m,e,f),b(e,t),b(t,r),b(r,s),b(t,i),b(t,a),a.innerHTML=n[1],b(e,o),b(e,l),b(e,c),h&&h.m(e,null),d=!0},p(m,f){(!d||f&1)&&Xe(s,m[0]),(!d||f&2)&&(a.innerHTML=m[1]),h&&h.p&&(!d||f&8)&&ps(h,u,m,m[3],d?ms(u,m[3],f,null):gs(m[3]),null)},i(m){d||(j(h,m),d=!0)},o(m){z(h,m),d=!1},d(m){m&&q(e),h&&h.d(m)}}}function bc(n){let e,t,r,s,i,a,o,l,c,d,u;const h=n[4].default,m=hs(h,n,n[3],null);return{c(){e=P("div"),t=P("div"),r=P("span"),s=ce(n[0]),i=T(),a=P("div"),o=T(),l=P("div"),c=T(),d=P("div"),m&&m.c(),R(r,"class","title svelte-ikiu6h"),R(a,"class","b3-label__text"),R(l,"class","fn__hr"),C(d,"display","flex"),C(d,"flex-direction","column"),C(d,"gap","5px"),C(d,"position","relative"),R(t,"class","fn__block"),R(e,"class","item-wrap b3-label svelte-ikiu6h"),R(e,"data-key","CustomCSS")},m(f,p){V(f,e,p),b(e,t),b(t,r),b(r,s),b(t,i),b(t,a),a.innerHTML=n[1],b(t,o),b(t,l),b(t,c),b(t,d),m&&m.m(d,null),u=!0},p(f,p){(!u||p&1)&&Xe(s,f[0]),(!u||p&2)&&(a.innerHTML=f[1]),m&&m.p&&(!u||p&8)&&ps(m,h,f,f[3],u?ms(h,f[3],p,null):gs(f[3]),null)},i(f){u||(j(m,f),u=!0)},o(f){z(m,f),u=!1},d(f){f&&q(e),m&&m.d(f)}}}function Sc(n){let e,t,r,s;const i=[bc,wc],a=[];function o(l,c){return l[2]==="row"?0:1}return e=o(n),t=a[e]=i[e](n),{c(){t.c(),r=ys()},m(l,c){a[e].m(l,c),V(l,r,c),s=!0},p(l,[c]){let d=e;e=o(l),e===d?a[e].p(l,c):(nn(),z(a[d],1,1,()=>{a[d]=null}),rn(),t=a[e],t?t.p(l,c):(t=a[e]=i[e](l),t.c()),j(t,1),t.m(r.parentNode,r))},i(l){s||(j(t),s=!0)},o(l){z(t),s=!1},d(l){l&&q(r),a[e].d(l)}}}function Ec(n,e,t){let{$$slots:r={},$$scope:s}=e,{title:i}=e,{description:a}=e,{direction:o="column"}=e;return n.$$set=l=>{"title"in l&&t(0,i=l.title),"description"in l&&t(1,a=l.description),"direction"in l&&t(2,o=l.direction),"$$scope"in l&&t(3,s=l.$$scope)},[i,a,o,s,r]}class Ac extends qe{constructor(e){super(),je(this,e,Ec,Sc,Ue,{title:0,description:1,direction:2})}}const ka={Wrap:Ac,Input:Pa};function Ca(n,e){return function(){return n.apply(e,arguments)}}const{toString:Rc}=Object.prototype,{getPrototypeOf:ws}=Object,Yn=(n=>e=>{const t=Rc.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),ve=n=>(n=n.toLowerCase(),e=>Yn(e)===n),Zn=n=>e=>typeof e===n,{isArray:Ot}=Array,sn=Zn("undefined");function xc(n){return n!==null&&!sn(n)&&n.constructor!==null&&!sn(n.constructor)&&pe(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const va=ve("ArrayBuffer");function Pc(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&va(n.buffer),e}const kc=Zn("string"),pe=Zn("function"),Oa=Zn("number"),er=n=>n!==null&&typeof n=="object",Cc=n=>n===!0||n===!1,On=n=>{if(Yn(n)!=="object")return!1;const e=ws(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},vc=ve("Date"),Oc=ve("File"),Tc=ve("Blob"),Mc=ve("FileList"),Ic=n=>er(n)&&pe(n.pipe),Fc=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||pe(n.append)&&((e=Yn(n))==="formdata"||e==="object"&&pe(n.toString)&&n.toString()==="[object FormData]"))},Nc=ve("URLSearchParams"),[Bc,$c,Lc,Dc]=["ReadableStream","Request","Response","Headers"].map(ve),Uc=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function cn(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,s;if(typeof n!="object"&&(n=[n]),Ot(n))for(r=0,s=n.length;r<s;r++)e.call(null,n[r],r,n);else{const i=t?Object.getOwnPropertyNames(n):Object.keys(n),a=i.length;let o;for(r=0;r<a;r++)o=i[r],e.call(null,n[o],o,n)}}function Ta(n,e){e=e.toLowerCase();const t=Object.keys(n);let r=t.length,s;for(;r-- >0;)if(s=t[r],e===s.toLowerCase())return s;return null}const et=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ma=n=>!sn(n)&&n!==et;function Hr(){const{caseless:n}=Ma(this)&&this||{},e={},t=(r,s)=>{const i=n&&Ta(e,s)||s;On(e[i])&&On(r)?e[i]=Hr(e[i],r):On(r)?e[i]=Hr({},r):Ot(r)?e[i]=r.slice():e[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&cn(arguments[r],t);return e}const jc=(n,e,t,{allOwnKeys:r}={})=>(cn(e,(s,i)=>{t&&pe(s)?n[i]=Ca(s,t):n[i]=s},{allOwnKeys:r}),n),qc=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),Hc=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},Wc=(n,e,t,r)=>{let s,i,a;const o={};if(e=e||{},n==null)return e;do{for(s=Object.getOwnPropertyNames(n),i=s.length;i-- >0;)a=s[i],(!r||r(a,n,e))&&!o[a]&&(e[a]=n[a],o[a]=!0);n=t!==!1&&ws(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},Jc=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},Vc=n=>{if(!n)return null;if(Ot(n))return n;let e=n.length;if(!Oa(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},Xc=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&ws(Uint8Array)),zc=(n,e)=>{const r=(n&&n[Symbol.iterator]).call(n);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(n,i[0],i[1])}},Kc=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},Gc=ve("HTMLFormElement"),Qc=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,s){return r.toUpperCase()+s}),ci=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),Yc=ve("RegExp"),Ia=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};cn(t,(s,i)=>{let a;(a=e(s,i,n))!==!1&&(r[i]=a||s)}),Object.defineProperties(n,r)},Zc=n=>{Ia(n,(e,t)=>{if(pe(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(pe(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},eu=(n,e)=>{const t={},r=s=>{s.forEach(i=>{t[i]=!0})};return Ot(n)?r(n):r(String(n).split(e)),t},tu=()=>{},nu=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e,yr="abcdefghijklmnopqrstuvwxyz",ui="0123456789",Fa={DIGIT:ui,ALPHA:yr,ALPHA_DIGIT:yr+yr.toUpperCase()+ui},ru=(n=16,e=Fa.ALPHA_DIGIT)=>{let t="";const{length:r}=e;for(;n--;)t+=e[Math.random()*r|0];return t};function su(n){return!!(n&&pe(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator])}const iu=n=>{const e=new Array(10),t=(r,s)=>{if(er(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const i=Ot(r)?[]:{};return cn(r,(a,o)=>{const l=t(a,s+1);!sn(l)&&(i[o]=l)}),e[s]=void 0,i}}return r};return t(n,0)},au=ve("AsyncFunction"),ou=n=>n&&(er(n)||pe(n))&&pe(n.then)&&pe(n.catch),Na=((n,e)=>n?setImmediate:e?((t,r)=>(et.addEventListener("message",({source:s,data:i})=>{s===et&&i===t&&r.length&&r.shift()()},!1),s=>{r.push(s),et.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",pe(et.postMessage)),lu=typeof queueMicrotask<"u"?queueMicrotask.bind(et):typeof process<"u"&&process.nextTick||Na,_={isArray:Ot,isArrayBuffer:va,isBuffer:xc,isFormData:Fc,isArrayBufferView:Pc,isString:kc,isNumber:Oa,isBoolean:Cc,isObject:er,isPlainObject:On,isReadableStream:Bc,isRequest:$c,isResponse:Lc,isHeaders:Dc,isUndefined:sn,isDate:vc,isFile:Oc,isBlob:Tc,isRegExp:Yc,isFunction:pe,isStream:Ic,isURLSearchParams:Nc,isTypedArray:Xc,isFileList:Mc,forEach:cn,merge:Hr,extend:jc,trim:Uc,stripBOM:qc,inherits:Hc,toFlatObject:Wc,kindOf:Yn,kindOfTest:ve,endsWith:Jc,toArray:Vc,forEachEntry:zc,matchAll:Kc,isHTMLForm:Gc,hasOwnProperty:ci,hasOwnProp:ci,reduceDescriptors:Ia,freezeMethods:Zc,toObjectSet:eu,toCamelCase:Qc,noop:tu,toFiniteNumber:nu,findKey:Ta,global:et,isContextDefined:Ma,ALPHABET:Fa,generateString:ru,isSpecCompliantForm:su,toJSONObject:iu,isAsyncFn:au,isThenable:ou,setImmediate:Na,asap:lu};function N(n,e,t,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}_.inherits(N,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:_.toJSONObject(this.config),code:this.code,status:this.status}}});const Ba=N.prototype,$a={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{$a[n]={value:n}});Object.defineProperties(N,$a);Object.defineProperty(Ba,"isAxiosError",{value:!0});N.from=(n,e,t,r,s,i)=>{const a=Object.create(Ba);return _.toFlatObject(n,a,function(l){return l!==Error.prototype},o=>o!=="isAxiosError"),N.call(a,n.message,e,t,r,s),a.cause=n,a.name=n.name,i&&Object.assign(a,i),a};const cu=null;function Wr(n){return _.isPlainObject(n)||_.isArray(n)}function La(n){return _.endsWith(n,"[]")?n.slice(0,-2):n}function fi(n,e,t){return n?n.concat(e).map(function(s,i){return s=La(s),!t&&i?"["+s+"]":s}).join(t?".":""):e}function uu(n){return _.isArray(n)&&!n.some(Wr)}const fu=_.toFlatObject(_,{},null,function(e){return/^is[A-Z]/.test(e)});function tr(n,e,t){if(!_.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=_.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,g){return!_.isUndefined(g[p])});const r=t.metaTokens,s=t.visitor||d,i=t.dots,a=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&_.isSpecCompliantForm(e);if(!_.isFunction(s))throw new TypeError("visitor must be a function");function c(f){if(f===null)return"";if(_.isDate(f))return f.toISOString();if(!l&&_.isBlob(f))throw new N("Blob is not supported. Use a Buffer instead.");return _.isArrayBuffer(f)||_.isTypedArray(f)?l&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function d(f,p,g){let k=f;if(f&&!g&&typeof f=="object"){if(_.endsWith(p,"{}"))p=r?p:p.slice(0,-2),f=JSON.stringify(f);else if(_.isArray(f)&&uu(f)||(_.isFileList(f)||_.endsWith(p,"[]"))&&(k=_.toArray(f)))return p=La(p),k.forEach(function(x,S){!(_.isUndefined(x)||x===null)&&e.append(a===!0?fi([p],S,i):a===null?p:p+"[]",c(x))}),!1}return Wr(f)?!0:(e.append(fi(g,p,i),c(f)),!1)}const u=[],h=Object.assign(fu,{defaultVisitor:d,convertValue:c,isVisitable:Wr});function m(f,p){if(!_.isUndefined(f)){if(u.indexOf(f)!==-1)throw Error("Circular reference detected in "+p.join("."));u.push(f),_.forEach(f,function(k,y){(!(_.isUndefined(k)||k===null)&&s.call(e,k,_.isString(y)?y.trim():y,p,h))===!0&&m(k,p?p.concat(y):[y])}),u.pop()}}if(!_.isObject(n))throw new TypeError("data must be an object");return m(n),e}function di(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function bs(n,e){this._pairs=[],n&&tr(n,this,e)}const Da=bs.prototype;Da.append=function(e,t){this._pairs.push([e,t])};Da.toString=function(e){const t=e?function(r){return e.call(this,r,di)}:di;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function du(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ua(n,e,t){if(!e)return n;const r=t&&t.encode||du;_.isFunction(t)&&(t={serialize:t});const s=t&&t.serialize;let i;if(s?i=s(e,t):i=_.isURLSearchParams(e)?e.toString():new bs(e,t).toString(r),i){const a=n.indexOf("#");a!==-1&&(n=n.slice(0,a)),n+=(n.indexOf("?")===-1?"?":"&")+i}return n}class hi{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){_.forEach(this.handlers,function(r){r!==null&&e(r)})}}const ja={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},hu=typeof URLSearchParams<"u"?URLSearchParams:bs,mu=typeof FormData<"u"?FormData:null,pu=typeof Blob<"u"?Blob:null,gu={isBrowser:!0,classes:{URLSearchParams:hu,FormData:mu,Blob:pu},protocols:["http","https","file","blob","url","data"]},Ss=typeof window<"u"&&typeof document<"u",Jr=typeof navigator=="object"&&navigator||void 0,_u=Ss&&(!Jr||["ReactNative","NativeScript","NS"].indexOf(Jr.product)<0),yu=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",wu=Ss&&window.location.href||"http://localhost",bu=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ss,hasStandardBrowserEnv:_u,hasStandardBrowserWebWorkerEnv:yu,navigator:Jr,origin:wu},Symbol.toStringTag,{value:"Module"})),re={...bu,...gu};function Su(n,e){return tr(n,new re.classes.URLSearchParams,Object.assign({visitor:function(t,r,s,i){return re.isNode&&_.isBuffer(t)?(this.append(r,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function Eu(n){return _.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Au(n){const e={},t=Object.keys(n);let r;const s=t.length;let i;for(r=0;r<s;r++)i=t[r],e[i]=n[i];return e}function qa(n){function e(t,r,s,i){let a=t[i++];if(a==="__proto__")return!0;const o=Number.isFinite(+a),l=i>=t.length;return a=!a&&_.isArray(s)?s.length:a,l?(_.hasOwnProp(s,a)?s[a]=[s[a],r]:s[a]=r,!o):((!s[a]||!_.isObject(s[a]))&&(s[a]=[]),e(t,r,s[a],i)&&_.isArray(s[a])&&(s[a]=Au(s[a])),!o)}if(_.isFormData(n)&&_.isFunction(n.entries)){const t={};return _.forEachEntry(n,(r,s)=>{e(Eu(r),s,t,0)}),t}return null}function Ru(n,e,t){if(_.isString(n))try{return(e||JSON.parse)(n),_.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(0,JSON.stringify)(n)}const un={transitional:ja,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",s=r.indexOf("application/json")>-1,i=_.isObject(e);if(i&&_.isHTMLForm(e)&&(e=new FormData(e)),_.isFormData(e))return s?JSON.stringify(qa(e)):e;if(_.isArrayBuffer(e)||_.isBuffer(e)||_.isStream(e)||_.isFile(e)||_.isBlob(e)||_.isReadableStream(e))return e;if(_.isArrayBufferView(e))return e.buffer;if(_.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Su(e,this.formSerializer).toString();if((o=_.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return tr(o?{"files[]":e}:e,l&&new l,this.formSerializer)}}return i||s?(t.setContentType("application/json",!1),Ru(e)):e}],transformResponse:[function(e){const t=this.transitional||un.transitional,r=t&&t.forcedJSONParsing,s=this.responseType==="json";if(_.isResponse(e)||_.isReadableStream(e))return e;if(e&&_.isString(e)&&(r&&!this.responseType||s)){const a=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(o){if(a)throw o.name==="SyntaxError"?N.from(o,N.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:re.classes.FormData,Blob:re.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};_.forEach(["delete","get","head","post","put","patch"],n=>{un.headers[n]={}});const xu=_.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Pu=n=>{const e={};let t,r,s;return n&&n.split(`
`).forEach(function(a){s=a.indexOf(":"),t=a.substring(0,s).trim().toLowerCase(),r=a.substring(s+1).trim(),!(!t||e[t]&&xu[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},mi=Symbol("internals");function Dt(n){return n&&String(n).trim().toLowerCase()}function Tn(n){return n===!1||n==null?n:_.isArray(n)?n.map(Tn):String(n)}function ku(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const Cu=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function wr(n,e,t,r,s){if(_.isFunction(r))return r.call(this,e,t);if(s&&(e=t),!!_.isString(e)){if(_.isString(r))return e.indexOf(r)!==-1;if(_.isRegExp(r))return r.test(e)}}function vu(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function Ou(n,e){const t=_.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(s,i,a){return this[r].call(this,e,s,i,a)},configurable:!0})})}class ue{constructor(e){e&&this.set(e)}set(e,t,r){const s=this;function i(o,l,c){const d=Dt(l);if(!d)throw new Error("header name must be a non-empty string");const u=_.findKey(s,d);(!u||s[u]===void 0||c===!0||c===void 0&&s[u]!==!1)&&(s[u||l]=Tn(o))}const a=(o,l)=>_.forEach(o,(c,d)=>i(c,d,l));if(_.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(_.isString(e)&&(e=e.trim())&&!Cu(e))a(Pu(e),t);else if(_.isHeaders(e))for(const[o,l]of e.entries())i(l,o,r);else e!=null&&i(t,e,r);return this}get(e,t){if(e=Dt(e),e){const r=_.findKey(this,e);if(r){const s=this[r];if(!t)return s;if(t===!0)return ku(s);if(_.isFunction(t))return t.call(this,s,r);if(_.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Dt(e),e){const r=_.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||wr(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let s=!1;function i(a){if(a=Dt(a),a){const o=_.findKey(r,a);o&&(!t||wr(r,r[o],o,t))&&(delete r[o],s=!0)}}return _.isArray(e)?e.forEach(i):i(e),s}clear(e){const t=Object.keys(this);let r=t.length,s=!1;for(;r--;){const i=t[r];(!e||wr(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const t=this,r={};return _.forEach(this,(s,i)=>{const a=_.findKey(r,i);if(a){t[a]=Tn(s),delete t[i];return}const o=e?vu(i):String(i).trim();o!==i&&delete t[i],t[o]=Tn(s),r[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return _.forEach(this,(r,s)=>{r!=null&&r!==!1&&(t[s]=e&&_.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[mi]=this[mi]={accessors:{}}).accessors,s=this.prototype;function i(a){const o=Dt(a);r[o]||(Ou(s,a),r[o]=!0)}return _.isArray(e)?e.forEach(i):i(e),this}}ue.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);_.reduceDescriptors(ue.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});_.freezeMethods(ue);function br(n,e){const t=this||un,r=e||t,s=ue.from(r.headers);let i=r.data;return _.forEach(n,function(o){i=o.call(t,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function Ha(n){return!!(n&&n.__CANCEL__)}function Tt(n,e,t){N.call(this,n??"canceled",N.ERR_CANCELED,e,t),this.name="CanceledError"}_.inherits(Tt,N,{__CANCEL__:!0});function Wa(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new N("Request failed with status code "+t.status,[N.ERR_BAD_REQUEST,N.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Tu(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function Mu(n,e){n=n||10;const t=new Array(n),r=new Array(n);let s=0,i=0,a;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),d=r[i];a||(a=c),t[s]=l,r[s]=c;let u=i,h=0;for(;u!==s;)h+=t[u++],u=u%n;if(s=(s+1)%n,s===i&&(i=(i+1)%n),c-a<e)return;const m=d&&c-d;return m?Math.round(h*1e3/m):void 0}}function Iu(n,e){let t=0,r=1e3/e,s,i;const a=(c,d=Date.now())=>{t=d,s=null,i&&(clearTimeout(i),i=null),n.apply(null,c)};return[(...c)=>{const d=Date.now(),u=d-t;u>=r?a(c,d):(s=c,i||(i=setTimeout(()=>{i=null,a(s)},r-u)))},()=>s&&a(s)]}const Wn=(n,e,t=3)=>{let r=0;const s=Mu(50,250);return Iu(i=>{const a=i.loaded,o=i.lengthComputable?i.total:void 0,l=a-r,c=s(l),d=a<=o;r=a;const u={loaded:a,total:o,progress:o?a/o:void 0,bytes:l,rate:c||void 0,estimated:c&&o&&d?(o-a)/c:void 0,event:i,lengthComputable:o!=null,[e?"download":"upload"]:!0};n(u)},t)},pi=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},gi=n=>(...e)=>_.asap(()=>n(...e)),Fu=re.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,re.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(re.origin),re.navigator&&/(msie|trident)/i.test(re.navigator.userAgent)):()=>!0,Nu=re.hasStandardBrowserEnv?{write(n,e,t,r,s,i){const a=[n+"="+encodeURIComponent(e)];_.isNumber(t)&&a.push("expires="+new Date(t).toGMTString()),_.isString(r)&&a.push("path="+r),_.isString(s)&&a.push("domain="+s),i===!0&&a.push("secure"),document.cookie=a.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Bu(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function $u(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function Ja(n,e){return n&&!Bu(e)?$u(n,e):e}const _i=n=>n instanceof ue?{...n}:n;function at(n,e){e=e||{};const t={};function r(c,d,u,h){return _.isPlainObject(c)&&_.isPlainObject(d)?_.merge.call({caseless:h},c,d):_.isPlainObject(d)?_.merge({},d):_.isArray(d)?d.slice():d}function s(c,d,u,h){if(_.isUndefined(d)){if(!_.isUndefined(c))return r(void 0,c,u,h)}else return r(c,d,u,h)}function i(c,d){if(!_.isUndefined(d))return r(void 0,d)}function a(c,d){if(_.isUndefined(d)){if(!_.isUndefined(c))return r(void 0,c)}else return r(void 0,d)}function o(c,d,u){if(u in e)return r(c,d);if(u in n)return r(void 0,c)}const l={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(c,d,u)=>s(_i(c),_i(d),u,!0)};return _.forEach(Object.keys(Object.assign({},n,e)),function(d){const u=l[d]||s,h=u(n[d],e[d],d);_.isUndefined(h)&&u!==o||(t[d]=h)}),t}const Va=n=>{const e=at({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:a,auth:o}=e;e.headers=a=ue.from(a),e.url=Ua(Ja(e.baseURL,e.url),n.params,n.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let l;if(_.isFormData(t)){if(re.hasStandardBrowserEnv||re.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((l=a.getContentType())!==!1){const[c,...d]=l?l.split(";").map(u=>u.trim()).filter(Boolean):[];a.setContentType([c||"multipart/form-data",...d].join("; "))}}if(re.hasStandardBrowserEnv&&(r&&_.isFunction(r)&&(r=r(e)),r||r!==!1&&Fu(e.url))){const c=s&&i&&Nu.read(i);c&&a.set(s,c)}return e},Lu=typeof XMLHttpRequest<"u",Du=Lu&&function(n){return new Promise(function(t,r){const s=Va(n);let i=s.data;const a=ue.from(s.headers).normalize();let{responseType:o,onUploadProgress:l,onDownloadProgress:c}=s,d,u,h,m,f;function p(){m&&m(),f&&f(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let g=new XMLHttpRequest;g.open(s.method.toUpperCase(),s.url,!0),g.timeout=s.timeout;function k(){if(!g)return;const x=ue.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),w={data:!o||o==="text"||o==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:x,config:n,request:g};Wa(function(A){t(A),p()},function(A){r(A),p()},w),g=null}"onloadend"in g?g.onloadend=k:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(k)},g.onabort=function(){g&&(r(new N("Request aborted",N.ECONNABORTED,n,g)),g=null)},g.onerror=function(){r(new N("Network Error",N.ERR_NETWORK,n,g)),g=null},g.ontimeout=function(){let S=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const w=s.transitional||ja;s.timeoutErrorMessage&&(S=s.timeoutErrorMessage),r(new N(S,w.clarifyTimeoutError?N.ETIMEDOUT:N.ECONNABORTED,n,g)),g=null},i===void 0&&a.setContentType(null),"setRequestHeader"in g&&_.forEach(a.toJSON(),function(S,w){g.setRequestHeader(w,S)}),_.isUndefined(s.withCredentials)||(g.withCredentials=!!s.withCredentials),o&&o!=="json"&&(g.responseType=s.responseType),c&&([h,f]=Wn(c,!0),g.addEventListener("progress",h)),l&&g.upload&&([u,m]=Wn(l),g.upload.addEventListener("progress",u),g.upload.addEventListener("loadend",m)),(s.cancelToken||s.signal)&&(d=x=>{g&&(r(!x||x.type?new Tt(null,n,g):x),g.abort(),g=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const y=Tu(s.url);if(y&&re.protocols.indexOf(y)===-1){r(new N("Unsupported protocol "+y+":",N.ERR_BAD_REQUEST,n));return}g.send(i||null)})},Uu=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,s;const i=function(c){if(!s){s=!0,o();const d=c instanceof Error?c:this.reason;r.abort(d instanceof N?d:new Tt(d instanceof Error?d.message:d))}};let a=e&&setTimeout(()=>{a=null,i(new N(`timeout ${e} of ms exceeded`,N.ETIMEDOUT))},e);const o=()=>{n&&(a&&clearTimeout(a),a=null,n.forEach(c=>{c.unsubscribe?c.unsubscribe(i):c.removeEventListener("abort",i)}),n=null)};n.forEach(c=>c.addEventListener("abort",i));const{signal:l}=r;return l.unsubscribe=()=>_.asap(o),l}},ju=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,s;for(;r<t;)s=r+e,yield n.slice(r,s),r=s},qu=async function*(n,e){for await(const t of Hu(n))yield*ju(t,e)},Hu=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},yi=(n,e,t,r)=>{const s=qu(n,e);let i=0,a,o=l=>{a||(a=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:c,value:d}=await s.next();if(c){o(),l.close();return}let u=d.byteLength;if(t){let h=i+=u;t(h)}l.enqueue(new Uint8Array(d))}catch(c){throw o(c),c}},cancel(l){return o(l),s.return()}},{highWaterMark:2})},nr=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Xa=nr&&typeof ReadableStream=="function",Wu=nr&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),za=(n,...e)=>{try{return!!n(...e)}catch{return!1}},Ju=Xa&&za(()=>{let n=!1;const e=new Request(re.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),wi=64*1024,Vr=Xa&&za(()=>_.isReadableStream(new Response("").body)),Jn={stream:Vr&&(n=>n.body)};nr&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Jn[e]&&(Jn[e]=_.isFunction(n[e])?t=>t[e]():(t,r)=>{throw new N(`Response type '${e}' is not supported`,N.ERR_NOT_SUPPORT,r)})})})(new Response);const Vu=async n=>{if(n==null)return 0;if(_.isBlob(n))return n.size;if(_.isSpecCompliantForm(n))return(await new Request(re.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(_.isArrayBufferView(n)||_.isArrayBuffer(n))return n.byteLength;if(_.isURLSearchParams(n)&&(n=n+""),_.isString(n))return(await Wu(n)).byteLength},Xu=async(n,e)=>{const t=_.toFiniteNumber(n.getContentLength());return t??Vu(e)},zu=nr&&(async n=>{let{url:e,method:t,data:r,signal:s,cancelToken:i,timeout:a,onDownloadProgress:o,onUploadProgress:l,responseType:c,headers:d,withCredentials:u="same-origin",fetchOptions:h}=Va(n);c=c?(c+"").toLowerCase():"text";let m=Uu([s,i&&i.toAbortSignal()],a),f;const p=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let g;try{if(l&&Ju&&t!=="get"&&t!=="head"&&(g=await Xu(d,r))!==0){let w=new Request(e,{method:"POST",body:r,duplex:"half"}),E;if(_.isFormData(r)&&(E=w.headers.get("content-type"))&&d.setContentType(E),w.body){const[A,M]=pi(g,Wn(gi(l)));r=yi(w.body,wi,A,M)}}_.isString(u)||(u=u?"include":"omit");const k="credentials"in Request.prototype;f=new Request(e,{...h,signal:m,method:t.toUpperCase(),headers:d.normalize().toJSON(),body:r,duplex:"half",credentials:k?u:void 0});let y=await fetch(f);const x=Vr&&(c==="stream"||c==="response");if(Vr&&(o||x&&p)){const w={};["status","statusText","headers"].forEach(F=>{w[F]=y[F]});const E=_.toFiniteNumber(y.headers.get("content-length")),[A,M]=o&&pi(E,Wn(gi(o),!0))||[];y=new Response(yi(y.body,wi,A,()=>{M&&M(),p&&p()}),w)}c=c||"text";let S=await Jn[_.findKey(Jn,c)||"text"](y,n);return!x&&p&&p(),await new Promise((w,E)=>{Wa(w,E,{data:S,headers:ue.from(y.headers),status:y.status,statusText:y.statusText,config:n,request:f})})}catch(k){throw p&&p(),k&&k.name==="TypeError"&&/fetch/i.test(k.message)?Object.assign(new N("Network Error",N.ERR_NETWORK,n,f),{cause:k.cause||k}):N.from(k,k&&k.code,n,f)}}),Xr={http:cu,xhr:Du,fetch:zu};_.forEach(Xr,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const bi=n=>`- ${n}`,Ku=n=>_.isFunction(n)||n===null||n===!1,Ka={getAdapter:n=>{n=_.isArray(n)?n:[n];const{length:e}=n;let t,r;const s={};for(let i=0;i<e;i++){t=n[i];let a;if(r=t,!Ku(t)&&(r=Xr[(a=String(t)).toLowerCase()],r===void 0))throw new N(`Unknown adapter '${a}'`);if(r)break;s[a||"#"+i]=r}if(!r){const i=Object.entries(s).map(([o,l])=>`adapter ${o} `+(l===!1?"is not supported by the environment":"is not available in the build"));let a=e?i.length>1?`since :
`+i.map(bi).join(`
`):" "+bi(i[0]):"as no adapter specified";throw new N("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:Xr};function Sr(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new Tt(null,n)}function Si(n){return Sr(n),n.headers=ue.from(n.headers),n.data=br.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),Ka.getAdapter(n.adapter||un.adapter)(n).then(function(r){return Sr(n),r.data=br.call(n,n.transformResponse,r),r.headers=ue.from(r.headers),r},function(r){return Ha(r)||(Sr(n),r&&r.response&&(r.response.data=br.call(n,n.transformResponse,r.response),r.response.headers=ue.from(r.response.headers))),Promise.reject(r)})}const Ga="1.7.9",rr={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{rr[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const Ei={};rr.transitional=function(e,t,r){function s(i,a){return"[Axios v"+Ga+"] Transitional option '"+i+"'"+a+(r?". "+r:"")}return(i,a,o)=>{if(e===!1)throw new N(s(a," has been removed"+(t?" in "+t:"")),N.ERR_DEPRECATED);return t&&!Ei[a]&&(Ei[a]=!0,console.warn(s(a," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,a,o):!0}};rr.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function Gu(n,e,t){if(typeof n!="object")throw new N("options must be an object",N.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let s=r.length;for(;s-- >0;){const i=r[s],a=e[i];if(a){const o=n[i],l=o===void 0||a(o,i,n);if(l!==!0)throw new N("option "+i+" must be "+l,N.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new N("Unknown option "+i,N.ERR_BAD_OPTION)}}const Mn={assertOptions:Gu,validators:rr},Te=Mn.validators;class st{constructor(e){this.defaults=e,this.interceptors={request:new hi,response:new hi}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=at(this.defaults,t);const{transitional:r,paramsSerializer:s,headers:i}=t;r!==void 0&&Mn.assertOptions(r,{silentJSONParsing:Te.transitional(Te.boolean),forcedJSONParsing:Te.transitional(Te.boolean),clarifyTimeoutError:Te.transitional(Te.boolean)},!1),s!=null&&(_.isFunction(s)?t.paramsSerializer={serialize:s}:Mn.assertOptions(s,{encode:Te.function,serialize:Te.function},!0)),Mn.assertOptions(t,{baseUrl:Te.spelling("baseURL"),withXsrfToken:Te.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=i&&_.merge(i.common,i[t.method]);i&&_.forEach(["delete","get","head","post","put","patch","common"],f=>{delete i[f]}),t.headers=ue.concat(a,i);const o=[];let l=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(t)===!1||(l=l&&p.synchronous,o.unshift(p.fulfilled,p.rejected))});const c=[];this.interceptors.response.forEach(function(p){c.push(p.fulfilled,p.rejected)});let d,u=0,h;if(!l){const f=[Si.bind(this),void 0];for(f.unshift.apply(f,o),f.push.apply(f,c),h=f.length,d=Promise.resolve(t);u<h;)d=d.then(f[u++],f[u++]);return d}h=o.length;let m=t;for(u=0;u<h;){const f=o[u++],p=o[u++];try{m=f(m)}catch(g){p.call(this,g);break}}try{d=Si.call(this,m)}catch(f){return Promise.reject(f)}for(u=0,h=c.length;u<h;)d=d.then(c[u++],c[u++]);return d}getUri(e){e=at(this.defaults,e);const t=Ja(e.baseURL,e.url);return Ua(t,e.params,e.paramsSerializer)}}_.forEach(["delete","get","head","options"],function(e){st.prototype[e]=function(t,r){return this.request(at(r||{},{method:e,url:t,data:(r||{}).data}))}});_.forEach(["post","put","patch"],function(e){function t(r){return function(i,a,o){return this.request(at(o||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}st.prototype[e]=t(),st.prototype[e+"Form"]=t(!0)});class Es{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(i){t=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const a=new Promise(o=>{r.subscribe(o),i=o}).then(s);return a.cancel=function(){r.unsubscribe(i)},a},e(function(i,a,o){r.reason||(r.reason=new Tt(i,a,o),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Es(function(s){e=s}),cancel:e}}}function Qu(n){return function(t){return n.apply(null,t)}}function Yu(n){return _.isObject(n)&&n.isAxiosError===!0}const zr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(zr).forEach(([n,e])=>{zr[e]=n});function Qa(n){const e=new st(n),t=Ca(st.prototype.request,e);return _.extend(t,st.prototype,e,{allOwnKeys:!0}),_.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return Qa(at(n,s))},t}const G=Qa(un);G.Axios=st;G.CanceledError=Tt;G.CancelToken=Es;G.isCancel=Ha;G.VERSION=Ga;G.toFormData=tr;G.AxiosError=N;G.Cancel=G.CanceledError;G.all=function(e){return Promise.all(e)};G.spread=Qu;G.isAxiosError=Yu;G.mergeConfig=at;G.AxiosHeaders=ue;G.formToJSON=n=>qa(_.isHTMLForm(n)?new FormData(n):n);G.getAdapter=Ka.getAdapter;G.HttpStatusCode=zr;G.default=G;async function Ai(n){if(!n||n.length==0)return[0,0];const e={method:"POST",url:atob("aHR0cHM6Ly9hcGkuZ2Vla3NwaGVyZS5vbmxpbmUvYWRtaW4tYXBpL2FpZ2MvYmFsYW5jZS90b2tlbg=="),headers:{"content-type":"application/json"},data:{apikey:n.replace("sk-","")}};let t=await G.request(e);return!t||t.status!=200?[0,0]:t.data.data}function Zu(n){let e,t,r="",s,i,a,o,l,c,d,u,h=new Date(n[2]).toLocaleString()+"",m,f,p,g,k;return{c(){e=P("label"),t=P("div"),s=ce(r),i=T(),a=P("div"),o=ce("    : "),l=ce(n[1]),c=ce(` 
            `),d=P("br"),u=ce(` 
               : `),m=ce(h),f=T(),p=P("button"),p.textContent="",R(a,"class","b3-label__text"),R(t,"class","fn__flex-1"),R(p,"class","b3-button b3-button--outline fn__flex-center fn__size200"),R(e,"class","fn__flex b3-label")},m(y,x){V(y,e,x),b(e,t),b(t,s),b(t,i),b(t,a),b(a,o),b(a,l),b(a,c),b(a,d),b(a,u),b(a,m),b(e,f),b(e,p),g||(k=W(p,"click",n[3]),g=!0)},p(y,[x]){x&2&&Xe(l,y[1]),x&4&&h!==(h=new Date(y[2]).toLocaleString()+"")&&Xe(m,h)},i:ie,o:ie,d(y){y&&q(e),g=!1,k()}}}function ef(n,e,t){let{apiKey:r}=e,s=0,i=0;Sa(()=>{Ai(r).then(o=>{t(1,s=Math.round(o.money*10)/10),t(2,i=o.expiredTime*1e3)})});const a=async()=>{Ai(r).then(o=>{t(2,i=o.expiredTime*1e3),t(1,s=Math.round(o.money*10)/10)})};return n.$$set=o=>{"apiKey"in o&&t(0,r=o.apiKey)},[r,s,i,a]}let tf=class extends qe{constructor(e){super(),je(this,e,ef,Zu,Ue,{apiKey:0})}};const Kr="siyuan-ai-plugin-setting",Ri=atob("aHR0cHM6Ly9vbmVhcGkuZ2Vla3NwaGVyZS5vbmxpbmU=");class nf{constructor(e,t){Ee(this,"plugin");Ee(this,"name");Ee(this,"file");this.name=t,this.plugin=e}}class rf extends nf{constructor(t,r){super(t,r);Ee(this,"settings",new Map);this.name=r??Kr,this.file=this.name.endsWith(".json")?this.name:`${this.name}.json`,this._defaultSettings()}async load(){let t=await this.plugin.loadData(this.file);if(console.debug("Load Setting Config:",t),t)for(let[r,s]of this.settings)s.value=(t==null?void 0:t[r])??s.value;return this.plugin.data[this.name]=t,t}async save(t){return t=t??this.dump(),await this.plugin.saveData(this.file,t),console.debug("Save Setting Config:",t),t}get(t){return this.settings.get(t)}getValue(t){var r;return(r=this.settings.get(t))==null?void 0:r.value}getSettingItems(t){let r=[];for(let[s,i]of this.settings)t&&i.group!==t||r.push(i);return r}set(t,r){this.settings.set(t,r)}setValue(t,r){let s=this.settings.get(t);s.value=r}dump(){let t={};for(let[r,s]of this.settings)t[r]=s.value;return t}_defaultSettings(){const t={group:" ",title:"",description:'<a href="https://item.taobao.com/item.htm?ft=t&id=877591591207&spm=a21dvs.23580594.0.0.621e2c1bjqRPCl&skuId=5719376381355"></a>, QQ: 710607849',type:"textinput",key:"apiKey",value:"",placeholder:"Enter your Key"};this.settings.set(t.key,t);const r={group:"custom",title:"",description:" ",type:"checkbox",key:"isPageContent",value:!1};this.settings.set(r.key,r);const s={group:"custom",title:"",description:" 1.0",type:"slider",key:"temperature",slider:{min:0,max:2,step:.1},value:1};this.settings.set(s.key,s);const i={group:"custom",title:"",description:", 4k",type:"number",key:"maxOutputLength",value:4e3};this.settings.set(i.key,i);const a={group:"custom",title:"",description:" 90 ",type:"number",key:"responseTimeout",value:90};this.settings.set(a.key,a);const o={group:"model",title:"",description:"",type:"select",key:"modelSelections",value:"deepseek-chat",options:{"deepseek-chat":"DeepSeek Chat","qwen-turbo-latest":"Qwen Turbo","qwen-plus-latest":"Qwen Plus","qwen-max-latest":"Qwen Max","qwen-max-longcontext":"Qwen Long","gpt-4o":"GPT 4o",o1:"GPT O1","o1-mini":"GPT O1 mini","gpt-4o-mini":"GPT 4o mini","gpt-4-turbo":"GPT 4 Turbo","claude-3-5-haiku-20241022":"Claude 3.5 Haiku","claude-3-5-sonnet-latest":"Claude 3.5 Sonnet","claude-3-opus-latest":"Claude 3 Opus"}};this.settings.set(o.key,o),this.load()}}function xi(n,e,t){const r=n.slice();return r[11]=e[t],r[12]=e,r[13]=t,r}function sf(n){var a,o,l,c;let e,t,r;function s(d){n[8](d,n[11])}let i={type:n[11].type,key:n[11].key,placeholder:(a=n[11])==null?void 0:a.placeholder,options:(o=n[11])==null?void 0:o.options,slider:(l=n[11])==null?void 0:l.slider,button:(c=n[11])==null?void 0:c.button};return n[11].value!==void 0&&(i.value=n[11].value),e=new ka.Input({props:i}),kt.push(()=>xa(e,"value",s)),e.$on("click",n[4]),e.$on("changed",n[5]),{c(){Ne(e.$$.fragment)},m(d,u){xe(e,d,u),r=!0},p(d,u){var m,f,p,g;n=d;const h={};u&4&&(h.type=n[11].type),u&4&&(h.key=n[11].key),u&4&&(h.placeholder=(m=n[11])==null?void 0:m.placeholder),u&4&&(h.options=(f=n[11])==null?void 0:f.options),u&4&&(h.slider=(p=n[11])==null?void 0:p.slider),u&4&&(h.button=(g=n[11])==null?void 0:g.button),!t&&u&4&&(t=!0,h.value=n[11].value,Aa(()=>t=!1)),e.$set(h)},i(d){r||(j(e.$$.fragment,d),r=!0)},o(d){z(e.$$.fragment,d),r=!1},d(d){Pe(e,d)}}}function Pi(n,e){var i;let t,r,s;return r=new ka.Wrap({props:{title:e[11].title,description:e[11].description,direction:(i=e[11])==null?void 0:i.direction,$$slots:{default:[sf]},$$scope:{ctx:e}}}),{key:n,first:null,c(){t=ys(),Ne(r.$$.fragment),this.first=t},m(a,o){V(a,t,o),xe(r,a,o),s=!0},p(a,o){var c;e=a;const l={};o&4&&(l.title=e[11].title),o&4&&(l.description=e[11].description),o&4&&(l.direction=(c=e[11])==null?void 0:c.direction),o&516&&(l.$$scope={dirty:o,ctx:e}),r.$set(l)},i(a){s||(j(r.$$.fragment,a),s=!0)},o(a){z(r.$$.fragment,a),s=!1},d(a){a&&q(t),Pe(r,a)}}}function ki(n){let e,t;return e=new tf({props:{apiKey:n[1].getValue("apiKey")}}),{c(){Ne(e.$$.fragment)},m(r,s){xe(e,r,s),t=!0},p(r,s){const i={};s&2&&(i.apiKey=r[1].getValue("apiKey")),e.$set(i)},i(r){t||(j(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){Pe(e,r)}}}function af(n){let e,t,r=[],s=new Map,i,a,o;const l=n[7].default,c=hs(l,n,n[9],null);let d=Ct(n[2]);const u=m=>m[11].key;for(let m=0;m<d.length;m+=1){let f=xi(n,d,m),p=u(f);s.set(p,r[m]=Pi(p,f))}let h=n[0]===" "&&ki(n);return{c(){e=P("div"),c&&c.c(),t=T();for(let m=0;m<r.length;m+=1)r[m].c();i=T(),h&&h.c(),R(e,"class",a="config__tab-container "+n[3]),R(e,"data-name",n[0])},m(m,f){V(m,e,f),c&&c.m(e,null),b(e,t);for(let p=0;p<r.length;p+=1)r[p]&&r[p].m(e,null);b(e,i),h&&h.m(e,null),o=!0},p(m,[f]){c&&c.p&&(!o||f&512)&&ps(c,l,m,m[9],o?ms(l,m[9],f,null):gs(m[9]),null),f&52&&(d=Ct(m[2]),nn(),r=sc(r,f,u,1,m,d,s,e,rc,Pi,i,xi),rn()),m[0]===" "?h?(h.p(m,f),f&1&&j(h,1)):(h=ki(m),h.c(),j(h,1),h.m(e,null)):h&&(nn(),z(h,1,1,()=>{h=null}),rn()),(!o||f&8&&a!==(a="config__tab-container "+m[3]))&&R(e,"class",a),(!o||f&1)&&R(e,"data-name",m[0])},i(m){if(!o){j(c,m);for(let f=0;f<d.length;f+=1)j(r[f]);j(h),o=!0}},o(m){z(c,m);for(let f=0;f<r.length;f+=1)z(r[f]);z(h),o=!1},d(m){m&&q(e),c&&c.d(m);for(let f=0;f<r.length;f+=1)r[f].d();h&&h.d()}}}function of(n,e,t){let r,{$$slots:s={},$$scope:i}=e,{group:a}=e,{settingStorage:o}=e,{display:l=!0}=e,c=o.getSettingItems(a);const d=Ea();function u({detail:f}){d("click",{key:f.key})}function h({detail:f}){d("changed",{group:a,...f})}function m(f,p){n.$$.not_equal(p.value,f)&&(p.value=f,t(2,c))}return n.$$set=f=>{"group"in f&&t(0,a=f.group),"settingStorage"in f&&t(1,o=f.settingStorage),"display"in f&&t(6,l=f.display),"$$scope"in f&&t(9,i=f.$$scope)},n.$$.update=()=>{n.$$.dirty&64&&t(3,r=l?"":"fn__none")},[a,o,c,r,u,h,l,s,m,i]}class Ya extends qe{constructor(e){super(),je(this,e,of,af,Ue,{group:0,settingStorage:1,display:6})}}const Gr="RFC3986",Qr={RFC1738:n=>String(n).replace(/%20/g,"+"),RFC3986:n=>String(n)},lf="RFC1738",cf=Array.isArray,Me=(()=>{const n=[];for(let e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n})(),Er=1024,uf=(n,e,t,r,s)=>{if(n.length===0)return n;let i=n;if(typeof n=="symbol"?i=Symbol.prototype.toString.call(n):typeof n!="string"&&(i=String(n)),t==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let a="";for(let o=0;o<i.length;o+=Er){const l=i.length>=Er?i.slice(o,o+Er):i,c=[];for(let d=0;d<l.length;++d){let u=l.charCodeAt(d);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||s===lf&&(u===40||u===41)){c[c.length]=l.charAt(d);continue}if(u<128){c[c.length]=Me[u];continue}if(u<2048){c[c.length]=Me[192|u>>6]+Me[128|u&63];continue}if(u<55296||u>=57344){c[c.length]=Me[224|u>>12]+Me[128|u>>6&63]+Me[128|u&63];continue}d+=1,u=65536+((u&1023)<<10|l.charCodeAt(d)&1023),c[c.length]=Me[240|u>>18]+Me[128|u>>12&63]+Me[128|u>>6&63]+Me[128|u&63]}a+=c.join("")}return a};function ff(n){return!n||typeof n!="object"?!1:!!(n.constructor&&n.constructor.isBuffer&&n.constructor.isBuffer(n))}function Ci(n,e){if(cf(n)){const t=[];for(let r=0;r<n.length;r+=1)t.push(e(n[r]));return t}return e(n)}const df=Object.prototype.hasOwnProperty,Za={brackets(n){return String(n)+"[]"},comma:"comma",indices(n,e){return String(n)+"["+e+"]"},repeat(n){return String(n)}},Ie=Array.isArray,hf=Array.prototype.push,eo=function(n,e){hf.apply(n,Ie(e)?e:[e])},mf=Date.prototype.toISOString,Y={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:uf,encodeValuesOnly:!1,format:Gr,formatter:Qr[Gr],indices:!1,serializeDate(n){return mf.call(n)},skipNulls:!1,strictNullHandling:!1};function pf(n){return typeof n=="string"||typeof n=="number"||typeof n=="boolean"||typeof n=="symbol"||typeof n=="bigint"}const Ar={};function to(n,e,t,r,s,i,a,o,l,c,d,u,h,m,f,p,g,k){let y=n,x=k,S=0,w=!1;for(;(x=x.get(Ar))!==void 0&&!w;){const I=x.get(n);if(S+=1,typeof I<"u"){if(I===S)throw new RangeError("Cyclic object value");w=!0}typeof x.get(Ar)>"u"&&(S=0)}if(typeof c=="function"?y=c(e,y):y instanceof Date?y=h==null?void 0:h(y):t==="comma"&&Ie(y)&&(y=Ci(y,function(I){return I instanceof Date?h==null?void 0:h(I):I})),y===null){if(i)return l&&!p?l(e,Y.encoder,g,"key",m):e;y=""}if(pf(y)||ff(y)){if(l){const I=p?e:l(e,Y.encoder,g,"key",m);return[(f==null?void 0:f(I))+"="+(f==null?void 0:f(l(y,Y.encoder,g,"value",m)))]}return[(f==null?void 0:f(e))+"="+(f==null?void 0:f(String(y)))]}const E=[];if(typeof y>"u")return E;let A;if(t==="comma"&&Ie(y))p&&l&&(y=Ci(y,l)),A=[{value:y.length>0?y.join(",")||null:void 0}];else if(Ie(c))A=c;else{const I=Object.keys(y);A=d?I.sort(d):I}const M=o?String(e).replace(/\./g,"%2E"):String(e),F=r&&Ie(y)&&y.length===1?M+"[]":M;if(s&&Ie(y)&&y.length===0)return F+"[]";for(let I=0;I<A.length;++I){const v=A[I],ee=typeof v=="object"&&typeof v.value<"u"?v.value:y[v];if(a&&ee===null)continue;const ge=u&&o?v.replace(/\./g,"%2E"):v,_e=Ie(y)?typeof t=="function"?t(F,ge):F:F+(u?"."+ge:"["+ge+"]");k.set(n,S);const He=new WeakMap;He.set(Ar,k),eo(E,to(ee,_e,t,r,s,i,a,o,t==="comma"&&p&&Ie(y)?null:l,c,d,u,h,m,f,p,g,He))}return E}function gf(n=Y){if(typeof n.allowEmptyArrays<"u"&&typeof n.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof n.encodeDotInKeys<"u"&&typeof n.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(n.encoder!==null&&typeof n.encoder<"u"&&typeof n.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=n.charset||Y.charset;if(typeof n.charset<"u"&&n.charset!=="utf-8"&&n.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=Gr;if(typeof n.format<"u"){if(!df.call(Qr,n.format))throw new TypeError("Unknown format option provided.");t=n.format}const r=Qr[t];let s=Y.filter;(typeof n.filter=="function"||Ie(n.filter))&&(s=n.filter);let i;if(n.arrayFormat&&n.arrayFormat in Za?i=n.arrayFormat:"indices"in n?i=n.indices?"indices":"repeat":i=Y.arrayFormat,"commaRoundTrip"in n&&typeof n.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const a=typeof n.allowDots>"u"?n.encodeDotInKeys?!0:Y.allowDots:!!n.allowDots;return{addQueryPrefix:typeof n.addQueryPrefix=="boolean"?n.addQueryPrefix:Y.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof n.allowEmptyArrays=="boolean"?!!n.allowEmptyArrays:Y.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof n.charsetSentinel=="boolean"?n.charsetSentinel:Y.charsetSentinel,commaRoundTrip:!!n.commaRoundTrip,delimiter:typeof n.delimiter>"u"?Y.delimiter:n.delimiter,encode:typeof n.encode=="boolean"?n.encode:Y.encode,encodeDotInKeys:typeof n.encodeDotInKeys=="boolean"?n.encodeDotInKeys:Y.encodeDotInKeys,encoder:typeof n.encoder=="function"?n.encoder:Y.encoder,encodeValuesOnly:typeof n.encodeValuesOnly=="boolean"?n.encodeValuesOnly:Y.encodeValuesOnly,filter:s,format:t,formatter:r,serializeDate:typeof n.serializeDate=="function"?n.serializeDate:Y.serializeDate,skipNulls:typeof n.skipNulls=="boolean"?n.skipNulls:Y.skipNulls,sort:typeof n.sort=="function"?n.sort:null,strictNullHandling:typeof n.strictNullHandling=="boolean"?n.strictNullHandling:Y.strictNullHandling}}function _f(n,e={}){let t=n;const r=gf(e);let s,i;typeof r.filter=="function"?(i=r.filter,t=i("",t)):Ie(r.filter)&&(i=r.filter,s=i);const a=[];if(typeof t!="object"||t===null)return"";const o=Za[r.arrayFormat],l=o==="comma"&&r.commaRoundTrip;s||(s=Object.keys(t)),r.sort&&s.sort(r.sort);const c=new WeakMap;for(let h=0;h<s.length;++h){const m=s[h];r.skipNulls&&t[m]===null||eo(a,to(t[m],m,o,l,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,c))}const d=a.join(r.delimiter);let u=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?u+="utf8=%26%2310003%3B&":u+="utf8=%E2%9C%93&"),d.length>0?u+d:""}const pt="4.78.1";let vi=!1,Yt,no,ro,Yr,so,io,ao,oo,lo;function yf(n,e={auto:!1}){if(vi)throw new Error(`you must \`import 'openai/shims/${n.kind}'\` before importing anything else from openai`);if(Yt)throw new Error(`can't \`import 'openai/shims/${n.kind}'\` after \`import 'openai/shims/${Yt}'\``);vi=e.auto,Yt=n.kind,no=n.fetch,ro=n.FormData,Yr=n.File,so=n.ReadableStream,io=n.getMultipartRequestOptions,ao=n.getDefaultAgent,oo=n.fileFromPath,lo=n.isFsReadStream}let wf=class{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};function bf({manuallyImported:n}={}){const e=n?"You may need to use polyfills":"Add one of these imports before your first `import  from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,r,s,i;try{t=fetch,r=Request,s=Response,i=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:t,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new wf(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:a=>!1}}Yt||yf(bf(),{auto:!0});class $ extends Error{}let fe=class Zr extends ${constructor(e,t,r,s){super(`${Zr.makeMessage(e,t,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"],this.error=t;const i=t;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,t,r){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,r,s){if(!e||!s)return new sr({message:r,cause:ns(t)});const i=t==null?void 0:t.error;return e===400?new co(e,i,r,s):e===401?new uo(e,i,r,s):e===403?new fo(e,i,r,s):e===404?new ho(e,i,r,s):e===409?new mo(e,i,r,s):e===422?new po(e,i,r,s):e===429?new go(e,i,r,s):e>=500?new _o(e,i,r,s):new Zr(e,i,r,s)}},ke=class extends fe{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},sr=class extends fe{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}},As=class extends sr{constructor({message:e}={}){super({message:e??"Request timed out."})}},co=class extends fe{},uo=class extends fe{},fo=class extends fe{},ho=class extends fe{},mo=class extends fe{},po=class extends fe{},go=class extends fe{},_o=class extends fe{};class yo extends ${constructor(){super("Could not parse response content as the length limit was reached")}}class wo extends ${constructor(){super("Could not parse response content as the request was rejected by the content filter")}}let ir=class es{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const r=es.NEWLINE_CHARS.has(t[t.length-1]||"");let s=t.split(es.NEWLINE_REGEXP);return r&&s.pop(),s.length===1&&!r?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),r||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new $(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new $(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new $("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}};ir.NEWLINE_CHARS=new Set([`
`,"\r"]);ir.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let an=class Wt{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const a of Sf(e,t))if(!i){if(a.data.startsWith("[DONE]")){i=!0;continue}if(a.event===null){let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(o&&o.error)throw new fe(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(a.event=="error")throw new fe(void 0,o.error,o.message,void 0);yield{event:a.event,data:o}}}i=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{i||t.abort()}}return new Wt(s,t)}static fromReadableStream(e,t){let r=!1;async function*s(){const a=new ir,o=bo(e);for await(const l of o)for(const c of a.decode(l))yield c;for(const l of a.flush())yield l}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(const o of s())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||t.abort()}}return new Wt(i,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const a=r.next();e.push(a),t.push(a)}return i.shift()}});return[new Wt(()=>s(e),this.controller),new Wt(()=>s(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new so({async start(){t=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:a}=await t.next();if(a)return s.close();const o=r.encode(JSON.stringify(i)+`
`);s.enqueue(o)}catch(i){s.error(i)}},async cancel(){var s;await((s=t.return)==null?void 0:s.call(t))}})}};async function*Sf(n,e){if(!n.body)throw e.abort(),new $("Attempted to iterate over a response with no body");const t=new Rf,r=new ir,s=bo(n.body);for await(const i of Ef(s))for(const a of r.decode(i)){const o=t.decode(a);o&&(yield o)}for(const i of r.flush()){const a=t.decode(i);a&&(yield a)}}async function*Ef(n){let e=new Uint8Array;for await(const t of n){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=Af(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}function Af(n){for(let r=0;r<n.length-2;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}let Rf=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,s]=xf(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}};function xf(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}function bo(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const So=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function",Eo=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&ar(n),ar=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",Pf=n=>Eo(n)||So(n)||lo(n);async function Ao(n,e,t){var s;if(n=await n,Eo(n))return n;if(So(n)){const i=await n.blob();e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=ar(i)?[await i.arrayBuffer()]:[i];return new Yr(a,e,t)}const r=await kf(n);if(e||(e=vf(n)??"unknown_file"),!(t!=null&&t.type)){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(t={...t,type:i})}return new Yr(r,e,t)}async function kf(n){var t;let e=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)e.push(n);else if(ar(n))e.push(await n.arrayBuffer());else if(Of(n))for await(const r of n)e.push(r);else throw new Error(`Unexpected data type: ${typeof n}; constructor: ${(t=n==null?void 0:n.constructor)==null?void 0:t.name}; props: ${Cf(n)}`);return e}function Cf(n){return`[${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}function vf(n){var e;return Rr(n.name)||Rr(n.filename)||((e=Rr(n.path))==null?void 0:e.split(/[\\/]/).pop())}const Rr=n=>{if(typeof n=="string")return n;if(typeof Buffer<"u"&&n instanceof Buffer)return String(n)},Of=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function",Oi=n=>n&&typeof n=="object"&&n.body&&n[Symbol.toStringTag]==="MultipartBody",vt=async n=>{const e=await Tf(n.body);return io(e,n)},Tf=async n=>{const e=new ro;return await Promise.all(Object.entries(n||{}).map(([t,r])=>ts(e,t,r))),e},ts=async(n,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")n.append(e,String(t));else if(Pf(t)){const r=await Ao(t);n.append(e,r)}else if(Array.isArray(t))await Promise.all(t.map(r=>ts(n,e+"[]",r)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([r,s])=>ts(n,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var Mf=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},If=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},yn;async function Ro(n){const{response:e}=n;if(n.options.stream)return At("response",e.status,e.url,e.headers,e.body),n.options.__streamClass?n.options.__streamClass.fromSSEResponse(e,n.controller):an.fromSSEResponse(e,n.controller);if(e.status===204)return null;if(n.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const i=await e.json();return At("response",e.status,e.url,e.headers,i),xo(i,e)}const s=await e.text();return At("response",e.status,e.url,e.headers,s),s}function xo(n,e){return!n||typeof n!="object"||Array.isArray(n)?n:Object.defineProperty(n,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}let Po=class ko extends Promise{constructor(e,t=Ro){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new ko(this.responsePromise,async t=>xo(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}},Ff=class{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=xr("maxRetries",t),this.timeout=xr("timeout",r),this.httpAgent=s,this.fetch=i??no}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Uf(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Wf()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&ar(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:t,...s,body:i}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var p;const{method:r,path:s,query:i,headers:a={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:Oi(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(o),c=this.buildURL(s,i);"timeout"in e&&xr("timeout",e.timeout);const d=e.timeout??this.timeout,u=e.httpAgent??this.httpAgent??ao(c),h=d+1e3;typeof((p=u==null?void 0:u.options)==null?void 0:p.timeout)=="number"&&h>(u.options.timeout??0)&&(u.options.timeout=h),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const m=this.buildHeaders({options:e,headers:a,contentLength:l,retryCount:t});return{req:{method:r,...o&&{body:o},headers:m,...u&&{agent:u},signal:e.signal??null},url:c,timeout:d}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:s}){const i={};r&&(i["content-length"]=r);const a=this.defaultHeaders(e);return Fi(i,a),Fi(i,t),Oi(e.body)&&Yt!=="node"&&delete i["content-type"],Ni(a,"x-stainless-retry-count")===void 0&&Ni(t,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),this.validateHeaders(i,t),i}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,r,s){return fe.generate(e,t,r,s)}request(e,t=null){return new Po(this.makeRequest(e,t))}async makeRequest(e,t){var u,h;const r=await e,s=r.maxRetries??this.maxRetries;t==null&&(t=s),await this.prepareOptions(r);const{req:i,url:a,timeout:o}=this.buildRequest(r,{retryCount:s-t});if(await this.prepareRequest(i,{url:a,options:r}),At("request",a,r,i.headers),(u=r.signal)!=null&&u.aborted)throw new ke;const l=new AbortController,c=await this.fetchWithTimeout(a,i,o,l).catch(ns);if(c instanceof Error){if((h=r.signal)!=null&&h.aborted)throw new ke;if(t)return this.retryRequest(r,t);throw c.name==="AbortError"?new As:new sr({cause:c})}const d=Bf(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const y=`retrying, ${t} attempts remaining`;return At(`response (error; ${y})`,c.status,a,d),this.retryRequest(r,t,d)}const m=await c.text().catch(y=>ns(y).message),f=jf(m),p=f?void 0:m;throw At(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,a,d,p),this.makeStatusError(c.status,f,p,d)}return{response:c,options:r,controller:l}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new Nf(this,r,e)}buildURL(e,t){const r=Hf(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return vo(s)||(t={...s,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new $(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,s){const{signal:i,...a}=t||{};i&&i.addEventListener("abort",()=>s.abort());const o=setTimeout(()=>s.abort(),r),l={signal:s.signal,...a};return l.method&&(l.method=l.method.toUpperCase()),this.fetch.call(void 0,e,l).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(s=o)}const a=r==null?void 0:r["retry-after"];if(a&&!s){const o=parseFloat(a);Number.isNaN(o)?s=Date.parse(a)-Date.now():s=o*1e3}if(!(s&&0<=s&&s<60*1e3)){const o=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,o)}return await fn(s),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const i=t-e,a=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${pt}`}},Co=class{constructor(e,t,r,s){yn.set(this,void 0),Mf(this,yn,e,"f"),this.options=s,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new $("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);t.query=void 0,t.path=e.url.toString()}return await If(this,yn,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(yn=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}},Nf=class extends Po{constructor(e,t,r){super(t,async s=>new r(e,s.response,await Ro(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}};const Bf=n=>new Proxy(Object.fromEntries(n.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),$f={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},de=n=>typeof n=="object"&&n!==null&&!vo(n)&&Object.keys(n).every(e=>Oo($f,e)),Lf=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pt,"X-Stainless-OS":Mi(Deno.build.os),"X-Stainless-Arch":Ti(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pt,"X-Stainless-OS":Mi(process.platform),"X-Stainless-Arch":Ti(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const n=Df();return n?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${n.browser}`,"X-Stainless-Runtime-Version":n.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Df(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const r=t.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,a=r[3]||0;return{browser:e,version:`${s}.${i}.${a}`}}}return null}const Ti=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",Mi=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Ii;const Uf=()=>Ii??(Ii=Lf()),jf=n=>{try{return JSON.parse(n)}catch{return}},qf=/^[a-z][a-z0-9+.-]*:/i,Hf=n=>qf.test(n),fn=n=>new Promise(e=>setTimeout(e,n)),xr=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new $(`${n} must be an integer`);if(e<0)throw new $(`${n} must be a positive integer`);return e},ns=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null)try{return new Error(JSON.stringify(n))}catch{}return new Error(n)},wn=n=>{var e,t,r,s,i;if(typeof process<"u")return((t=(e=process.env)==null?void 0:e[n])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(i=(s=(r=Deno.env)==null?void 0:r.get)==null?void 0:s.call(r,n))==null?void 0:i.trim()};function vo(n){if(!n)return!0;for(const e in n)return!1;return!0}function Oo(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Fi(n,e){for(const t in e){if(!Oo(e,t))continue;const r=t.toLowerCase();if(!r)continue;const s=e[t];s===null?delete n[r]:s!==void 0&&(n[r]=s)}}function At(n,...e){var t;typeof process<"u"&&((t=process==null?void 0:process.env)==null?void 0:t.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${n}`,...e)}const Wf=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)}),Jf=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Vf=n=>typeof(n==null?void 0:n.get)=="function",Ni=(n,e)=>{var r;const t=e.toLowerCase();if(Vf(n)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,a,o)=>a+o.toUpperCase());for(const i of[e,t,e.toUpperCase(),s]){const a=n.get(i);if(a)return a}}for(const[s,i]of Object.entries(n))if(s.toLowerCase()===t)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i};function Pr(n){return n!=null&&typeof n=="object"&&!Array.isArray(n)}let Xf=class extends Co{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}};class Oe extends Co{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const t=(r=e[e.length-1])==null?void 0:r.id;return t?{params:{after:t}}:null}}let D=class{constructor(e){this._client=e}},To=class extends D{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},Rs=class extends D{constructor(){super(...arguments),this.completions=new To(this._client)}};Rs.Completions=To;class Mo extends D{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}class Io extends D{create(e,t){return this._client.post("/audio/transcriptions",vt({body:e,...t}))}}class Fo extends D{create(e,t){return this._client.post("/audio/translations",vt({body:e,...t}))}}class dn extends D{constructor(){super(...arguments),this.transcriptions=new Io(this._client),this.translations=new Fo(this._client),this.speech=new Mo(this._client)}}dn.Transcriptions=Io;dn.Translations=Fo;dn.Speech=Mo;let xs=class extends D{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return de(e)?this.list({},e):this._client.getAPIList("/batches",Ps,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}};class Ps extends Oe{}xs.BatchesPage=Ps;class ks extends D{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/assistants/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return de(e)?this.list({},e):this._client.getAPIList("/assistants",Cs,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Cs extends Oe{}ks.AssistantsPage=Cs;function Bi(n){return typeof n.parse=="function"}const Rt=n=>(n==null?void 0:n.role)==="assistant",No=n=>(n==null?void 0:n.role)==="function",Bo=n=>(n==null?void 0:n.role)==="tool";var Ae=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},X=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},rs,In,Fn,Jt,Vt,Nn,Xt,Le,zt,Vn,Xn,gt,$o;class Lo{constructor(){rs.add(this),this.controller=new AbortController,In.set(this,void 0),Fn.set(this,()=>{}),Jt.set(this,()=>{}),Vt.set(this,void 0),Nn.set(this,()=>{}),Xt.set(this,()=>{}),Le.set(this,{}),zt.set(this,!1),Vn.set(this,!1),Xn.set(this,!1),gt.set(this,!1),Ae(this,In,new Promise((e,t)=>{Ae(this,Fn,e,"f"),Ae(this,Jt,t,"f")}),"f"),Ae(this,Vt,new Promise((e,t)=>{Ae(this,Nn,e,"f"),Ae(this,Xt,t,"f")}),"f"),X(this,In,"f").catch(()=>{}),X(this,Vt,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},X(this,rs,"m",$o).bind(this))},0)}_connected(){this.ended||(X(this,Fn,"f").call(this),this._emit("connect"))}get ended(){return X(this,zt,"f")}get errored(){return X(this,Vn,"f")}get aborted(){return X(this,Xn,"f")}abort(){this.controller.abort()}on(e,t){return(X(this,Le,"f")[e]||(X(this,Le,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=X(this,Le,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===t);return s>=0&&r.splice(s,1),this}once(e,t){return(X(this,Le,"f")[e]||(X(this,Le,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{Ae(this,gt,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){Ae(this,gt,!0,"f"),await X(this,Vt,"f")}_emit(e,...t){if(X(this,zt,"f"))return;e==="end"&&(Ae(this,zt,!0,"f"),X(this,Nn,"f").call(this));const r=X(this,Le,"f")[e];if(r&&(X(this,Le,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...t))),e==="abort"){const s=t[0];!X(this,gt,"f")&&!(r!=null&&r.length)&&Promise.reject(s),X(this,Jt,"f").call(this,s),X(this,Xt,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=t[0];!X(this,gt,"f")&&!(r!=null&&r.length)&&Promise.reject(s),X(this,Jt,"f").call(this,s),X(this,Xt,"f").call(this,s),this._emit("end")}}_emitFinal(){}}In=new WeakMap,Fn=new WeakMap,Jt=new WeakMap,Vt=new WeakMap,Nn=new WeakMap,Xt=new WeakMap,Le=new WeakMap,zt=new WeakMap,Vn=new WeakMap,Xn=new WeakMap,gt=new WeakMap,rs=new WeakSet,$o=function(e){if(Ae(this,Vn,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new ke),e instanceof ke)return Ae(this,Xn,!0,"f"),this._emit("abort",e);if(e instanceof $)return this._emit("error",e);if(e instanceof Error){const t=new $(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new $(String(e)))};function Do(n){return(n==null?void 0:n.$brand)==="auto-parseable-response-format"}function hn(n){return(n==null?void 0:n.$brand)==="auto-parseable-tool"}function zf(n,e){return!e||!Uo(e)?{...n,choices:n.choices.map(t=>({...t,message:{...t.message,parsed:null,tool_calls:t.message.tool_calls??[]}}))}:vs(n,e)}function vs(n,e){const t=n.choices.map(r=>{var s;if(r.finish_reason==="length")throw new yo;if(r.finish_reason==="content_filter")throw new wo;return{...r,message:{...r.message,tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(i=>Gf(e,i)))??[],parsed:r.message.content&&!r.message.refusal?Kf(e,r.message.content):null}}});return{...n,choices:t}}function Kf(n,e){var t,r;return((t=n.response_format)==null?void 0:t.type)!=="json_schema"?null:((r=n.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in n.response_format?n.response_format.$parseRaw(e):JSON.parse(e):null}function Gf(n,e){var r;const t=(r=n.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:hn(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function Qf(n,e){var r;if(!n)return!1;const t=(r=n.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return hn(t)||(t==null?void 0:t.function.strict)||!1}function Uo(n){var e;return Do(n.response_format)?!0:((e=n.tools)==null?void 0:e.some(t=>hn(t)||t.type==="function"&&t.function.strict===!0))??!1}function Yf(n){for(const e of n??[]){if(e.type!=="function")throw new $(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new $(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var le=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},ne,ss,zn,is,as,os,jo,ls;const $i=10;class qo extends Lo{constructor(){super(...arguments),ne.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(r=e.choices[0])==null?void 0:r.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(No(e)||Bo(e))&&e.content)this._emit("functionCallResult",e.content);else if(Rt(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Rt(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new $("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),le(this,ne,"m",ss).call(this)}async finalMessage(){return await this.done(),le(this,ne,"m",zn).call(this)}async finalFunctionCall(){return await this.done(),le(this,ne,"m",is).call(this)}async finalFunctionCallResult(){return await this.done(),le(this,ne,"m",as).call(this)}async totalUsage(){return await this.done(),le(this,ne,"m",os).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=le(this,ne,"m",zn).call(this);t&&this._emit("finalMessage",t);const r=le(this,ne,"m",ss).call(this);r&&this._emit("finalContent",r);const s=le(this,ne,"m",is).call(this);s&&this._emit("finalFunctionCall",s);const i=le(this,ne,"m",as).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",le(this,ne,"m",os).call(this))}async _createChatCompletion(e,t,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),le(this,ne,"m",jo).call(this,t);const i=await e.chat.completions.create({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(vs(i,t))}async _runChatCompletion(e,t,r){for(const s of t.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,t,r)}async _runFunctions(e,t,r){var h;const s="function",{function_call:i="auto",stream:a,...o}=t,l=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:c=$i}=r||{},d={};for(const m of t.functions)d[m.name||m.function.name]=m;const u=t.functions.map(m=>({name:m.name||m.function.name,parameters:m.parameters,description:m.description}));for(const m of t.messages)this._addMessage(m,!1);for(let m=0;m<c;++m){const p=(h=(await this._createChatCompletion(e,{...o,function_call:i,functions:u,messages:[...this.messages]},r)).choices[0])==null?void 0:h.message;if(!p)throw new $("missing message in ChatCompletion response");if(!p.function_call)return;const{name:g,arguments:k}=p.function_call,y=d[g];if(y){if(l&&l!==g){const E=`Invalid function_call: ${JSON.stringify(g)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:s,name:g,content:E});continue}}else{const E=`Invalid function_call: ${JSON.stringify(g)}. Available options are: ${u.map(A=>JSON.stringify(A.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:g,content:E});continue}let x;try{x=Bi(y)?await y.parse(k):k}catch(E){this._addMessage({role:s,name:g,content:E instanceof Error?E.message:String(E)});continue}const S=await y.function(x,this),w=le(this,ne,"m",ls).call(this,S);if(this._addMessage({role:s,name:g,content:w}),l)return}}async _runTools(e,t,r){var m,f,p;const s="tool",{tool_choice:i="auto",stream:a,...o}=t,l=typeof i!="string"&&((m=i==null?void 0:i.function)==null?void 0:m.name),{maxChatCompletions:c=$i}=r||{},d=t.tools.map(g=>{if(hn(g)){if(!g.$callback)throw new $("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:g.$callback,name:g.function.name,description:g.function.description||"",parameters:g.function.parameters,parse:g.$parseRaw,strict:!0}}}return g}),u={};for(const g of d)g.type==="function"&&(u[g.function.name||g.function.function.name]=g.function);const h="tools"in t?d.map(g=>g.type==="function"?{type:"function",function:{name:g.function.name||g.function.function.name,parameters:g.function.parameters,description:g.function.description,strict:g.function.strict}}:g):void 0;for(const g of t.messages)this._addMessage(g,!1);for(let g=0;g<c;++g){const y=(f=(await this._createChatCompletion(e,{...o,tool_choice:i,tools:h,messages:[...this.messages]},r)).choices[0])==null?void 0:f.message;if(!y)throw new $("missing message in ChatCompletion response");if(!((p=y.tool_calls)!=null&&p.length))return;for(const x of y.tool_calls){if(x.type!=="function")continue;const S=x.id,{name:w,arguments:E}=x.function,A=u[w];if(A){if(l&&l!==w){const v=`Invalid tool_call: ${JSON.stringify(w)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:s,tool_call_id:S,content:v});continue}}else{const v=`Invalid tool_call: ${JSON.stringify(w)}. Available options are: ${Object.keys(u).map(ee=>JSON.stringify(ee)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:S,content:v});continue}let M;try{M=Bi(A)?await A.parse(E):E}catch(v){const ee=v instanceof Error?v.message:String(v);this._addMessage({role:s,tool_call_id:S,content:ee});continue}const F=await A.function(M,this),I=le(this,ne,"m",ls).call(this,F);if(this._addMessage({role:s,tool_call_id:S,content:I}),l)return}}}}ne=new WeakSet,ss=function(){return le(this,ne,"m",zn).call(this).content??null},zn=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Rt(t)){const{function_call:r,...s}=t,i={...s,content:t.content??null,refusal:t.refusal??null};return r&&(i.function_call=r),i}}throw new $("stream ended without producing a ChatCompletionMessage with role=assistant")},is=function(){var e,t;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(Rt(s)&&(s!=null&&s.function_call))return s.function_call;if(Rt(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(t=s.tool_calls.at(-1))==null?void 0:t.function}},as=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(No(t)&&t.content!=null||Bo(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===t.tool_call_id))}))return t.content}},os=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},jo=function(e){if(e.n!=null&&e.n>1)throw new $("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},ls=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class on extends qo{static runFunctions(e,t,r){const s=new on,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,i)),s}static runTools(e,t,r){const s=new on,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,i)),s}_addMessage(e,t=!0){super._addMessage(e,t),Rt(e)&&e.content&&this._emit("content",e.content)}}const Ho=1,Wo=2,Jo=4,Vo=8,Xo=16,zo=32,Ko=64,Go=128,Qo=256,Yo=Go|Qo,Zo=Xo|zo|Yo|Ko,el=Ho|Wo|Zo,tl=Jo|Vo,Zf=el|tl,Z={STR:Ho,NUM:Wo,ARR:Jo,OBJ:Vo,NULL:Xo,BOOL:zo,NAN:Ko,INFINITY:Go,MINUS_INFINITY:Qo,INF:Yo,SPECIAL:Zo,ATOM:el,COLLECTION:tl,ALL:Zf};class ed extends Error{}class td extends Error{}function nd(n,e=Z.ALL){if(typeof n!="string")throw new TypeError(`expecting str, got ${typeof n}`);if(!n.trim())throw new Error(`${n} is empty`);return rd(n.trim(),e)}const rd=(n,e)=>{const t=n.length;let r=0;const s=h=>{throw new ed(`${h} at position ${r}`)},i=h=>{throw new td(`${h} at position ${r}`)},a=()=>(u(),r>=t&&s("Unexpected end of input"),n[r]==='"'?o():n[r]==="{"?l():n[r]==="["?c():n.substring(r,r+4)==="null"||Z.NULL&e&&t-r<4&&"null".startsWith(n.substring(r))?(r+=4,null):n.substring(r,r+4)==="true"||Z.BOOL&e&&t-r<4&&"true".startsWith(n.substring(r))?(r+=4,!0):n.substring(r,r+5)==="false"||Z.BOOL&e&&t-r<5&&"false".startsWith(n.substring(r))?(r+=5,!1):n.substring(r,r+8)==="Infinity"||Z.INFINITY&e&&t-r<8&&"Infinity".startsWith(n.substring(r))?(r+=8,1/0):n.substring(r,r+9)==="-Infinity"||Z.MINUS_INFINITY&e&&1<t-r&&t-r<9&&"-Infinity".startsWith(n.substring(r))?(r+=9,-1/0):n.substring(r,r+3)==="NaN"||Z.NAN&e&&t-r<3&&"NaN".startsWith(n.substring(r))?(r+=3,NaN):d()),o=()=>{const h=r;let m=!1;for(r++;r<t&&(n[r]!=='"'||m&&n[r-1]==="\\");)m=n[r]==="\\"?!m:!1,r++;if(n.charAt(r)=='"')try{return JSON.parse(n.substring(h,++r-Number(m)))}catch(f){i(String(f))}else if(Z.STR&e)try{return JSON.parse(n.substring(h,r-Number(m))+'"')}catch{return JSON.parse(n.substring(h,n.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},l=()=>{r++,u();const h={};try{for(;n[r]!=="}";){if(u(),r>=t&&Z.OBJ&e)return h;const m=o();u(),r++;try{const f=a();Object.defineProperty(h,m,{value:f,writable:!0,enumerable:!0,configurable:!0})}catch(f){if(Z.OBJ&e)return h;throw f}u(),n[r]===","&&r++}}catch{if(Z.OBJ&e)return h;s("Expected '}' at end of object")}return r++,h},c=()=>{r++;const h=[];try{for(;n[r]!=="]";)h.push(a()),u(),n[r]===","&&r++}catch{if(Z.ARR&e)return h;s("Expected ']' at end of array")}return r++,h},d=()=>{if(r===0){n==="-"&&Z.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n)}catch(m){if(Z.NUM&e)try{return n[n.length-1]==="."?JSON.parse(n.substring(0,n.lastIndexOf("."))):JSON.parse(n.substring(0,n.lastIndexOf("e")))}catch{}i(String(m))}}const h=r;for(n[r]==="-"&&r++;n[r]&&!",]}".includes(n[r]);)r++;r==t&&!(Z.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(n.substring(h,r))}catch{n.substring(h,r)==="-"&&Z.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n.substring(h,n.lastIndexOf("e")))}catch(f){i(String(f))}}},u=()=>{for(;r<t&&` 
\r	`.includes(n[r]);)r++};return a()},Li=n=>nd(n,Z.ALL^Z.NUM);var ft=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},U=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Q,Be,dt,We,kr,bn,Cr,vr,Or,Sn,Tr,Di;class ln extends qo{constructor(e){super(),Q.add(this),Be.set(this,void 0),dt.set(this,void 0),We.set(this,void 0),ft(this,Be,e,"f"),ft(this,dt,[],"f")}get currentChatCompletionSnapshot(){return U(this,We,"f")}static fromReadableStream(e){const t=new ln(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){const s=new ln(t);return s._run(()=>s._runChatCompletion(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,t,r){var a;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),U(this,Q,"m",kr).call(this);const i=await e.chat.completions.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const o of i)U(this,Q,"m",Cr).call(this,o);if((a=i.controller.signal)!=null&&a.aborted)throw new ke;return this._addChatCompletion(U(this,Q,"m",Sn).call(this))}async _fromReadableStream(e,t){var a;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),U(this,Q,"m",kr).call(this),this._connected();const s=an.fromReadableStream(e,this.controller);let i;for await(const o of s)i&&i!==o.id&&this._addChatCompletion(U(this,Q,"m",Sn).call(this)),U(this,Q,"m",Cr).call(this,o),i=o.id;if((a=s.controller.signal)!=null&&a.aborted)throw new ke;return this._addChatCompletion(U(this,Q,"m",Sn).call(this))}[(Be=new WeakMap,dt=new WeakMap,We=new WeakMap,Q=new WeakSet,kr=function(){this.ended||ft(this,We,void 0,"f")},bn=function(t){let r=U(this,dt,"f")[t.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},U(this,dt,"f")[t.index]=r,r)},Cr=function(t){var s,i,a,o,l,c,d,u,h,m,f,p,g,k,y;if(this.ended)return;const r=U(this,Q,"m",Di).call(this,t);this._emit("chunk",t,r);for(const x of t.choices){const S=r.choices[x.index];x.delta.content!=null&&((s=S.message)==null?void 0:s.role)==="assistant"&&((i=S.message)!=null&&i.content)&&(this._emit("content",x.delta.content,S.message.content),this._emit("content.delta",{delta:x.delta.content,snapshot:S.message.content,parsed:S.message.parsed})),x.delta.refusal!=null&&((a=S.message)==null?void 0:a.role)==="assistant"&&((o=S.message)!=null&&o.refusal)&&this._emit("refusal.delta",{delta:x.delta.refusal,snapshot:S.message.refusal}),((l=x.logprobs)==null?void 0:l.content)!=null&&((c=S.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(d=x.logprobs)==null?void 0:d.content,snapshot:((u=S.logprobs)==null?void 0:u.content)??[]}),((h=x.logprobs)==null?void 0:h.refusal)!=null&&((m=S.message)==null?void 0:m.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(f=x.logprobs)==null?void 0:f.refusal,snapshot:((p=S.logprobs)==null?void 0:p.refusal)??[]});const w=U(this,Q,"m",bn).call(this,S);S.finish_reason&&(U(this,Q,"m",Or).call(this,S),w.current_tool_call_index!=null&&U(this,Q,"m",vr).call(this,S,w.current_tool_call_index));for(const E of x.delta.tool_calls??[])w.current_tool_call_index!==E.index&&(U(this,Q,"m",Or).call(this,S),w.current_tool_call_index!=null&&U(this,Q,"m",vr).call(this,S,w.current_tool_call_index)),w.current_tool_call_index=E.index;for(const E of x.delta.tool_calls??[]){const A=(g=S.message.tool_calls)==null?void 0:g[E.index];A!=null&&A.type&&((A==null?void 0:A.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(k=A.function)==null?void 0:k.name,index:E.index,arguments:A.function.arguments,parsed_arguments:A.function.parsed_arguments,arguments_delta:((y=E.function)==null?void 0:y.arguments)??""}):(A==null||A.type,void 0))}}},vr=function(t,r){var a,o,l;if(U(this,Q,"m",bn).call(this,t).done_tool_calls.has(r))return;const i=(a=t.message.tool_calls)==null?void 0:a[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const c=(l=(o=U(this,Be,"f"))==null?void 0:o.tools)==null?void 0:l.find(d=>d.type==="function"&&d.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:hn(c)?c.$parseRaw(i.function.arguments):c!=null&&c.function.strict?JSON.parse(i.function.arguments):null})}else i.type},Or=function(t){var s,i;const r=U(this,Q,"m",bn).call(this,t);if(t.message.content&&!r.content_done){r.content_done=!0;const a=U(this,Q,"m",Tr).call(this);this._emit("content.done",{content:t.message.content,parsed:a?a.$parseRaw(t.message.content):null})}t.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(s=t.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(i=t.logprobs)!=null&&i.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},Sn=function(){if(this.ended)throw new $("stream has ended, this shouldn't happen");const t=U(this,We,"f");if(!t)throw new $("request ended without sending any chunks");return ft(this,We,void 0,"f"),ft(this,dt,[],"f"),sd(t,U(this,Be,"f"))},Tr=function(){var r;const t=(r=U(this,Be,"f"))==null?void 0:r.response_format;return Do(t)?t:null},Di=function(t){var r,s,i,a;let o=U(this,We,"f");const{choices:l,...c}=t;o?Object.assign(o,c):o=ft(this,We,{...c,choices:[]},"f");for(const{delta:d,finish_reason:u,index:h,logprobs:m=null,...f}of t.choices){let p=o.choices[h];if(p||(p=o.choices[h]={finish_reason:u,index:h,message:{},logprobs:m,...f}),m)if(!p.logprobs)p.logprobs=Object.assign({},m);else{const{content:E,refusal:A,...M}=m;Object.assign(p.logprobs,M),E&&((r=p.logprobs).content??(r.content=[]),p.logprobs.content.push(...E)),A&&((s=p.logprobs).refusal??(s.refusal=[]),p.logprobs.refusal.push(...A))}if(u&&(p.finish_reason=u,U(this,Be,"f")&&Uo(U(this,Be,"f")))){if(u==="length")throw new yo;if(u==="content_filter")throw new wo}if(Object.assign(p,f),!d)continue;const{content:g,refusal:k,function_call:y,role:x,tool_calls:S,...w}=d;if(Object.assign(p.message,w),k&&(p.message.refusal=(p.message.refusal||"")+k),x&&(p.message.role=x),y&&(p.message.function_call?(y.name&&(p.message.function_call.name=y.name),y.arguments&&((i=p.message.function_call).arguments??(i.arguments=""),p.message.function_call.arguments+=y.arguments)):p.message.function_call=y),g&&(p.message.content=(p.message.content||"")+g,!p.message.refusal&&U(this,Q,"m",Tr).call(this)&&(p.message.parsed=Li(p.message.content))),S){p.message.tool_calls||(p.message.tool_calls=[]);for(const{index:E,id:A,type:M,function:F,...I}of S){const v=(a=p.message.tool_calls)[E]??(a[E]={});Object.assign(v,I),A&&(v.id=A),M&&(v.type=M),F&&(v.function??(v.function={name:F.name??"",arguments:""})),F!=null&&F.name&&(v.function.name=F.name),F!=null&&F.arguments&&(v.function.arguments+=F.arguments,Qf(U(this,Be,"f"),v)&&(v.function.parsed_arguments=Li(v.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("chunk",s=>{const i=t.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,a)=>t.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new an(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function sd(n,e){const{id:t,choices:r,created:s,model:i,system_fingerprint:a,...o}=n,l={...o,id:t,choices:r.map(({message:c,finish_reason:d,index:u,logprobs:h,...m})=>{if(!d)throw new $(`missing finish_reason for choice ${u}`);const{content:f=null,function_call:p,tool_calls:g,...k}=c,y=c.role;if(!y)throw new $(`missing role for choice ${u}`);if(p){const{arguments:x,name:S}=p;if(x==null)throw new $(`missing function_call.arguments for choice ${u}`);if(!S)throw new $(`missing function_call.name for choice ${u}`);return{...m,message:{content:f,function_call:{arguments:x,name:S},role:y,refusal:c.refusal??null},finish_reason:d,index:u,logprobs:h}}return g?{...m,index:u,finish_reason:d,logprobs:h,message:{...k,role:y,content:f,refusal:c.refusal??null,tool_calls:g.map((x,S)=>{const{function:w,type:E,id:A,...M}=x,{arguments:F,name:I,...v}=w||{};if(A==null)throw new $(`missing choices[${u}].tool_calls[${S}].id
${En(n)}`);if(E==null)throw new $(`missing choices[${u}].tool_calls[${S}].type
${En(n)}`);if(I==null)throw new $(`missing choices[${u}].tool_calls[${S}].function.name
${En(n)}`);if(F==null)throw new $(`missing choices[${u}].tool_calls[${S}].function.arguments
${En(n)}`);return{...M,id:A,type:E,function:{...v,name:I,arguments:F}}})}}:{...m,message:{...k,content:f,role:y,refusal:c.refusal??null},finish_reason:d,index:u,logprobs:h}}),created:s,model:i,object:"chat.completion",...a?{system_fingerprint:a}:{}};return zf(l,e)}function En(n){return JSON.stringify(n)}class xt extends ln{static fromReadableStream(e){const t=new xt(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,r){const s=new xt(null),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,i)),s}static runTools(e,t,r){const s=new xt(t),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,i)),s}}let nl=class extends D{parse(e,t){return Yf(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>vs(r,e))}runFunctions(e,t){return e.stream?xt.runFunctions(this._client,e,t):on.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?xt.runTools(this._client,e,t):on.runTools(this._client,e,t)}stream(e,t){return ln.createChatCompletion(this._client,e,t)}};class rl extends D{constructor(){super(...arguments),this.completions=new nl(this._client)}}(function(n){n.Completions=nl})(rl);class sl extends D{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Os extends D{constructor(){super(...arguments),this.sessions=new sl(this._client)}}Os.Sessions=sl;var O=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},he=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},te,cs,Fe,Bn,Re,tt,bt,Ze,Kn,me,$n,Ln,Zt,Kt,Gt,Ui,ji,qi,Hi,Wi,Ji,Vi;class Ce extends Lo{constructor(){super(...arguments),te.add(this),cs.set(this,[]),Fe.set(this,{}),Bn.set(this,{}),Re.set(this,void 0),tt.set(this,void 0),bt.set(this,void 0),Ze.set(this,void 0),Kn.set(this,void 0),me.set(this,void 0),$n.set(this,void 0),Ln.set(this,void 0),Zt.set(this,void 0)}[(cs=new WeakMap,Fe=new WeakMap,Bn=new WeakMap,Re=new WeakMap,tt=new WeakMap,bt=new WeakMap,Ze=new WeakMap,Kn=new WeakMap,me=new WeakMap,$n=new WeakMap,Ln=new WeakMap,Zt=new WeakMap,te=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("event",s=>{const i=t.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,a)=>t.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new Ce;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var i;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=an.fromReadableStream(e,this.controller);for await(const a of s)O(this,te,"m",Kt).call(this,a);if((i=s.controller.signal)!=null&&i.aborted)throw new ke;return this._addRun(O(this,te,"m",Gt).call(this))}toReadableStream(){return new an(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,r,s,i){const a=new Ce;return a._run(()=>a._runToolAssistantStream(e,t,r,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,t,r,s,i){var c;const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},l=await e.submitToolOutputs(t,r,o,{...i,signal:this.controller.signal});this._connected();for await(const d of l)O(this,te,"m",Kt).call(this,d);if((c=l.controller.signal)!=null&&c.aborted)throw new ke;return this._addRun(O(this,te,"m",Gt).call(this))}static createThreadAssistantStream(e,t,r){const s=new Ce;return s._run(()=>s._threadAssistantStream(e,t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,t,r,s){const i=new Ce;return i._run(()=>i._runAssistantStream(e,t,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return O(this,$n,"f")}currentRun(){return O(this,Ln,"f")}currentMessageSnapshot(){return O(this,Re,"f")}currentRunStepSnapshot(){return O(this,Zt,"f")}async finalRunSteps(){return await this.done(),Object.values(O(this,Fe,"f"))}async finalMessages(){return await this.done(),Object.values(O(this,Bn,"f"))}async finalRun(){if(await this.done(),!O(this,tt,"f"))throw Error("Final run was not received.");return O(this,tt,"f")}async _createThreadAssistantStream(e,t,r){var o;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...t,stream:!0},a=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const l of a)O(this,te,"m",Kt).call(this,l);if((o=a.controller.signal)!=null&&o.aborted)throw new ke;return this._addRun(O(this,te,"m",Gt).call(this))}async _createAssistantStream(e,t,r,s){var l;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const a={...r,stream:!0},o=await e.create(t,a,{...s,signal:this.controller.signal});this._connected();for await(const c of o)O(this,te,"m",Kt).call(this,c);if((l=o.controller.signal)!=null&&l.aborted)throw new ke;return this._addRun(O(this,te,"m",Gt).call(this))}static accumulateDelta(e,t){for(const[r,s]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(Pr(i)&&Pr(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(a=>typeof a=="string"||typeof a=="number")){i.push(...s);continue}for(const a of s){if(!Pr(a))throw new Error(`Expected array delta entry to be an object but got: ${a}`);const o=a.index;if(o==null)throw console.error(a),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const l=i[o];l==null?i.push(a):i[o]=this.accumulateDelta(l,a)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,t,r){return await this._createThreadAssistantStream(t,e,r)}async _runAssistantStream(e,t,r,s){return await this._createAssistantStream(t,e,r,s)}async _runToolAssistantStream(e,t,r,s,i){return await this._createToolAssistantStream(r,e,t,s,i)}}Kt=function(e){if(!this.ended)switch(he(this,$n,e,"f"),O(this,te,"m",qi).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":O(this,te,"m",Vi).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":O(this,te,"m",ji).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":O(this,te,"m",Ui).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Gt=function(){if(this.ended)throw new $("stream has ended, this shouldn't happen");if(!O(this,tt,"f"))throw Error("Final run has not been received");return O(this,tt,"f")},Ui=function(e){const[t,r]=O(this,te,"m",Wi).call(this,e,O(this,Re,"f"));he(this,Re,t,"f"),O(this,Bn,"f")[t.id]=t;for(const s of r){const i=t.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,a=t.content[s.index];if(a&&a.type=="text")this._emit("textDelta",i,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=O(this,bt,"f")){if(O(this,Ze,"f"))switch(O(this,Ze,"f").type){case"text":this._emit("textDone",O(this,Ze,"f").text,O(this,Re,"f"));break;case"image_file":this._emit("imageFileDone",O(this,Ze,"f").image_file,O(this,Re,"f"));break}he(this,bt,s.index,"f")}he(this,Ze,t.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(O(this,bt,"f")!==void 0){const s=e.data.content[O(this,bt,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,O(this,Re,"f"));break;case"text":this._emit("textDone",s.text,O(this,Re,"f"));break}}O(this,Re,"f")&&this._emit("messageDone",e.data),he(this,Re,void 0,"f")}},ji=function(e){const t=O(this,te,"m",Hi).call(this,e);switch(he(this,Zt,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==O(this,Kn,"f")?this._emit("toolCallDelta",i,t.step_details.tool_calls[i.index]):(O(this,me,"f")&&this._emit("toolCallDone",O(this,me,"f")),he(this,Kn,i.index,"f"),he(this,me,t.step_details.tool_calls[i.index],"f"),O(this,me,"f")&&this._emit("toolCallCreated",O(this,me,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":he(this,Zt,void 0,"f"),e.data.step_details.type=="tool_calls"&&O(this,me,"f")&&(this._emit("toolCallDone",O(this,me,"f")),he(this,me,void 0,"f")),this._emit("runStepDone",e.data,t);break}},qi=function(e){O(this,cs,"f").push(e),this._emit("event",e)},Hi=function(e){switch(e.event){case"thread.run.step.created":return O(this,Fe,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=O(this,Fe,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=Ce.accumulateDelta(t,r.delta);O(this,Fe,"f")[e.data.id]=s}return O(this,Fe,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":O(this,Fe,"f")[e.data.id]=e.data;break}if(O(this,Fe,"f")[e.data.id])return O(this,Fe,"f")[e.data.id];throw new Error("No snapshot available")},Wi=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in t.content){let a=t.content[i.index];t.content[i.index]=O(this,te,"m",Ji).call(this,i,a)}else t.content[i.index]=i,r.push(i);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Ji=function(e,t){return Ce.accumulateDelta(t,e)},Vi=function(e){switch(he(this,Ln,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":he(this,tt,e.data,"f"),O(this,me,"f")&&(this._emit("toolCallDone",O(this,me,"f")),he(this,me,void 0,"f"));break}};let Ts=class extends D{create(e,t,r){return this._client.post(`/threads/${e}/messages`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,s){return this._client.post(`/threads/${e}/messages/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},r){return de(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,Ms,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}};class Ms extends Oe{}Ts.MessagesPage=Ms;class Is extends D{retrieve(e,t,r,s={},i){return de(s)?this.retrieve(e,t,r,{},s):this._client.get(`/threads/${e}/runs/${t}/steps/${r}`,{query:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,t,r={},s){return de(r)?this.list(e,t,{},r):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,Fs,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class Fs extends Oe{}Is.RunStepsPage=Fs;class mn extends D{constructor(){super(...arguments),this.steps=new Is(this._client)}create(e,t,r){const{include:s,...i}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:i,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:t.stream??!1})}retrieve(e,t,r){return this._client.get(`/threads/${e}/runs/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,s){return this._client.post(`/threads/${e}/runs/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},r){return de(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,Ns,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t,r);return await this.poll(e,s.id,r)}createAndStream(e,t,r){return Ce.createAssistantStream(e,this._client.beta.threads.runs,t,r)}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,t,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await fn(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,t,r){return Ce.createAssistantStream(e,this._client.beta.threads.runs,t,r)}submitToolOutputs(e,t,r,s){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,t,r,s){const i=await this.submitToolOutputs(e,t,r,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,t,r,s){return Ce.createToolAssistantStream(e,t,this._client.beta.threads.runs,r,s)}}class Ns extends Oe{}mn.RunsPage=Ns;mn.Steps=Is;mn.RunStepsPage=Fs;class Mt extends D{constructor(){super(...arguments),this.runs=new mn(this._client),this.messages=new Ts(this._client)}create(e={},t){return de(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/threads/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const r=await this.createAndRun(e,t);return await this.runs.poll(r.thread_id,r.id,t)}createAndRunStream(e,t){return Ce.createThreadAssistantStream(e,this._client.beta.threads,t)}}Mt.Runs=mn;Mt.RunsPage=Ns;Mt.Messages=Ts;Mt.MessagesPage=Ms;const id=async n=>{const e=await Promise.allSettled(n),t=e.filter(s=>s.status==="rejected");if(t.length){for(const s of t)console.error(s.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};let Bs=class extends D{create(e,t,r){return this._client.post(`/vector_stores/${e}/files`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,t={},r){return de(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,or,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t,r);return await this.poll(e,s.id,r)}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,t,{...r,headers:s}).withResponse(),a=i.data;switch(a.status){case"in_progress":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const l=i.response.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await fn(o);break;case"failed":case"completed":return a}}}async upload(e,t,r){const s=await this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,t,r){const s=await this.upload(e,t,r);return await this.poll(e,s.id,r)}};class or extends Oe{}Bs.VectorStoreFilesPage=or;class il extends D{create(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t);return await this.poll(e,s.id,r)}listFiles(e,t,r={},s){return de(r)?this.listFiles(e,t,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,or,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,t,{...r,headers:s}).withResponse();switch(i.status){case"in_progress":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await fn(o);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:t,fileIds:r=[]},s){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(s==null?void 0:s.maxConcurrency)??5,a=Math.min(i,t.length),o=this._client,l=t.values(),c=[...r];async function d(h){for(let m of h){const f=await o.files.create({file:m,purpose:"assistants"},s);c.push(f.id)}}const u=Array(a).fill(l).map(d);return await id(u),await this.createAndPoll(e,{file_ids:c})}}class It extends D{constructor(){super(...arguments),this.files=new Bs(this._client),this.fileBatches=new il(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/vector_stores/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return de(e)?this.list({},e):this._client.getAPIList("/vector_stores",$s,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class $s extends Oe{}It.VectorStoresPage=$s;It.Files=Bs;It.VectorStoreFilesPage=or;It.FileBatches=il;let Ke=class extends D{constructor(){super(...arguments),this.realtime=new Os(this._client),this.vectorStores=new It(this._client),this.chat=new rl(this._client),this.assistants=new ks(this._client),this.threads=new Mt(this._client)}};Ke.Realtime=Os;Ke.VectorStores=It;Ke.VectorStoresPage=$s;Ke.Assistants=ks;Ke.AssistantsPage=Cs;Ke.Threads=Mt;let al=class extends D{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}};class ol extends D{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}class Ls extends D{create(e,t){return this._client.post("/files",vt({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return de(e)?this.list({},e):this._client.getAPIList("/files",Ds,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let a=await this.retrieve(e);for(;!a.status||!s.has(a.status);)if(await fn(t),a=await this.retrieve(e),Date.now()-i>r)throw new As({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return a}}class Ds extends Oe{}Ls.FileObjectsPage=Ds;class Us extends D{list(e,t={},r){return de(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,js,{query:t,...r})}}class js extends Oe{}Us.FineTuningJobCheckpointsPage=js;class Ft extends D{constructor(){super(...arguments),this.checkpoints=new Us(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return de(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",qs,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return de(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Hs,{query:t,...r})}}class qs extends Oe{}class Hs extends Oe{}Ft.FineTuningJobsPage=qs;Ft.FineTuningJobEventsPage=Hs;Ft.Checkpoints=Us;Ft.FineTuningJobCheckpointsPage=js;class pn extends D{constructor(){super(...arguments),this.jobs=new Ft(this._client)}}pn.Jobs=Ft;pn.FineTuningJobsPage=qs;pn.FineTuningJobEventsPage=Hs;class ll extends D{createVariation(e,t){return this._client.post("/images/variations",vt({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",vt({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}let Ws=class extends D{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Js,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}};class Js extends Xf{}Ws.ModelsPage=Js;class cl extends D{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class ul extends D{create(e,t,r){return this._client.post(`/uploads/${e}/parts`,vt({body:t,...r}))}}class Vs extends D{constructor(){super(...arguments),this.parts=new ul(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,r){return this._client.post(`/uploads/${e}/complete`,{body:t,...r})}}Vs.Parts=ul;var fl;class L extends Ff{constructor({baseURL:e=wn("OPENAI_BASE_URL"),apiKey:t=wn("OPENAI_API_KEY"),organization:r=wn("OPENAI_ORG_ID")??null,project:s=wn("OPENAI_PROJECT_ID")??null,...i}={}){if(t===void 0)throw new $("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:t,organization:r,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&Jf())throw new $(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new al(this),this.chat=new Rs(this),this.embeddings=new ol(this),this.files=new Ls(this),this.images=new ll(this),this.audio=new dn(this),this.moderations=new cl(this),this.models=new Ws(this),this.fineTuning=new pn(this),this.beta=new Ke(this),this.batches=new xs(this),this.uploads=new Vs(this),this._options=a,this.apiKey=t,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return _f(e,{arrayFormat:"brackets"})}}fl=L;L.OpenAI=fl;L.DEFAULT_TIMEOUT=6e5;L.OpenAIError=$;L.APIError=fe;L.APIConnectionError=sr;L.APIConnectionTimeoutError=As;L.APIUserAbortError=ke;L.NotFoundError=ho;L.ConflictError=mo;L.RateLimitError=go;L.BadRequestError=co;L.AuthenticationError=uo;L.InternalServerError=_o;L.PermissionDeniedError=fo;L.UnprocessableEntityError=po;L.toFile=Ao;L.fileFromPath=oo;L.Completions=al;L.Chat=Rs;L.Embeddings=ol;L.Files=Ls;L.FileObjectsPage=Ds;L.Images=ll;L.Audio=dn;L.Moderations=cl;L.Models=Ws;L.ModelsPage=Js;L.FineTuning=pn;L.Beta=Ke;L.Batches=xs;L.BatchesPage=Ps;L.Uploads=Vs;const _t="0.33.1";let Xi=!1,en,dl,us,hl,ml,pl;function ad(n,e={auto:!1}){if(Xi)throw new Error(`you must \`import '@anthropic-ai/sdk/shims/${n.kind}'\` before importing anything else from @anthropic-ai/sdk`);if(en)throw new Error(`can't \`import '@anthropic-ai/sdk/shims/${n.kind}'\` after \`import '@anthropic-ai/sdk/shims/${en}'\``);Xi=e.auto,en=n.kind,dl=n.fetch,us=n.File,hl=n.ReadableStream,ml=n.getDefaultAgent,pl=n.fileFromPath}class od{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function ld({manuallyImported:n}={}){const e=n?"You may need to use polyfills":"Add one of these imports before your first `import  from '@anthropic-ai/sdk'`:\n- `import '@anthropic-ai/sdk/shims/node'` (if you're running on Node)\n- `import '@anthropic-ai/sdk/shims/web'` (otherwise)\n";let t,r,s,i;try{t=fetch,r=Request,s=Response,i=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:t,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new od(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/anthropics/anthropic-sdk-typescript#file-uploads")},isFsReadStream:a=>!1}}en||ad(ld(),{auto:!0});class J extends Error{}class se extends J{constructor(e,t,r,s){super(`${se.makeMessage(e,t,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["request-id"],this.error=t}static makeMessage(e,t,r){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,r,s){if(!e||!s)return new lr({message:r,cause:fs(t)});const i=t;return e===400?new _l(e,i,r,s):e===401?new yl(e,i,r,s):e===403?new wl(e,i,r,s):e===404?new bl(e,i,r,s):e===409?new Sl(e,i,r,s):e===422?new El(e,i,r,s):e===429?new Al(e,i,r,s):e>=500?new Rl(e,i,r,s):new se(e,i,r,s)}}class nt extends se{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class lr extends se{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class gl extends lr{constructor({message:e}={}){super({message:e??"Request timed out."})}}class _l extends se{}class yl extends se{}class wl extends se{}class bl extends se{}class Sl extends se{}class El extends se{}class Al extends se{}class Rl extends se{}class ze{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const r=ze.NEWLINE_CHARS.has(t[t.length-1]||"");let s=t.split(ze.NEWLINE_REGEXP);return r&&s.pop(),s.length===1&&!r?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),r||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new J(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new J(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new J("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}ze.NEWLINE_CHARS=new Set([`
`,"\r"]);ze.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class Ve{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const a of cd(e,t)){if(a.event==="completion")try{yield JSON.parse(a.data)}catch(o){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),o}if(a.event==="message_start"||a.event==="message_delta"||a.event==="message_stop"||a.event==="content_block_start"||a.event==="content_block_delta"||a.event==="content_block_stop")try{yield JSON.parse(a.data)}catch(o){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),o}if(a.event!=="ping"&&a.event==="error")throw se.generate(void 0,`SSE Error: ${a.data}`,a.data,kl(e.headers))}i=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{i||t.abort()}}return new Ve(s,t)}static fromReadableStream(e,t){let r=!1;async function*s(){const a=new ze,o=Xs(e);for await(const l of o)for(const c of a.decode(l))yield c;for(const l of a.flush())yield l}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(const o of s())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||t.abort()}}return new Ve(i,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const a=r.next();e.push(a),t.push(a)}return i.shift()}});return[new Ve(()=>s(e),this.controller),new Ve(()=>s(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new hl({async start(){t=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:a}=await t.next();if(a)return s.close();const o=r.encode(JSON.stringify(i)+`
`);s.enqueue(o)}catch(i){s.error(i)}},async cancel(){var s;await((s=t.return)==null?void 0:s.call(t))}})}}async function*cd(n,e){if(!n.body)throw e.abort(),new J("Attempted to iterate over a response with no body");const t=new dd,r=new ze,s=Xs(n.body);for await(const i of ud(s))for(const a of r.decode(i)){const o=t.decode(a);o&&(yield o)}for(const i of r.flush()){const a=t.decode(i);a&&(yield a)}}async function*ud(n){let e=new Uint8Array;for await(const t of n){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=fd(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}function fd(n){for(let r=0;r<n.length-2;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}class dd{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,s]=hd(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function hd(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}function Xs(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const md=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function",pd=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&cr(n),cr=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function";async function gd(n,e,t){var s;if(n=await n,pd(n))return n;if(md(n)){const i=await n.blob();e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=cr(i)?[await i.arrayBuffer()]:[i];return new us(a,e,t)}const r=await _d(n);if(e||(e=wd(n)??"unknown_file"),!(t!=null&&t.type)){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(t={...t,type:i})}return new us(r,e,t)}async function _d(n){var t;let e=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)e.push(n);else if(cr(n))e.push(await n.arrayBuffer());else if(bd(n))for await(const r of n)e.push(r);else throw new Error(`Unexpected data type: ${typeof n}; constructor: ${(t=n==null?void 0:n.constructor)==null?void 0:t.name}; props: ${yd(n)}`);return e}function yd(n){return`[${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}function wd(n){var e;return Mr(n.name)||Mr(n.filename)||((e=Mr(n.path))==null?void 0:e.split(/[\\/]/).pop())}const Mr=n=>{if(typeof n=="string")return n;if(typeof Buffer<"u"&&n instanceof Buffer)return String(n)},bd=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function",zi=n=>n&&typeof n=="object"&&n.body&&n[Symbol.toStringTag]==="MultipartBody";var Sd=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},Ed=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},An;async function xl(n){const{response:e}=n;if(n.options.stream)return Pt("response",e.status,e.url,e.headers,e.body),n.options.__streamClass?n.options.__streamClass.fromSSEResponse(e,n.controller):Ve.fromSSEResponse(e,n.controller);if(e.status===204)return null;if(n.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const i=await e.json();return Pt("response",e.status,e.url,e.headers,i),Pl(i,e)}const s=await e.text();return Pt("response",e.status,e.url,e.headers,s),s}function Pl(n,e){return!n||typeof n!="object"||Array.isArray(n)?n:Object.defineProperty(n,"_request_id",{value:e.headers.get("request-id"),enumerable:!1})}class ur extends Promise{constructor(e,t=xl){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new ur(this.responsePromise,async t=>Pl(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Ad{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=Ir("maxRetries",t),this.timeout=Ir("timeout",r),this.httpAgent=s,this.fetch=i??dl}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...vd(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Fd()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&cr(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:t,...s,body:i}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var p;const{method:r,path:s,query:i,headers:a={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:zi(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(o),c=this.buildURL(s,i);"timeout"in e&&Ir("timeout",e.timeout);const d=e.timeout??this.timeout,u=e.httpAgent??this.httpAgent??ml(c),h=d+1e3;typeof((p=u==null?void 0:u.options)==null?void 0:p.timeout)=="number"&&h>(u.options.timeout??0)&&(u.options.timeout=h),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const m=this.buildHeaders({options:e,headers:a,contentLength:l,retryCount:t});return{req:{method:r,...o&&{body:o},headers:m,...u&&{agent:u},signal:e.signal??null},url:c,timeout:d}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:s}){const i={};r&&(i["content-length"]=r);const a=this.defaultHeaders(e);return Yi(i,a),Yi(i,t),zi(e.body)&&en!=="node"&&delete i["content-type"],Zi(a,"x-stainless-retry-count")===void 0&&Zi(t,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),this.validateHeaders(i,t),i}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,r,s){return se.generate(e,t,r,s)}request(e,t=null){return new ur(this.makeRequest(e,t))}async makeRequest(e,t){var u,h;const r=await e,s=r.maxRetries??this.maxRetries;t==null&&(t=s),await this.prepareOptions(r);const{req:i,url:a,timeout:o}=this.buildRequest(r,{retryCount:s-t});if(await this.prepareRequest(i,{url:a,options:r}),Pt("request",a,r,i.headers),(u=r.signal)!=null&&u.aborted)throw new nt;const l=new AbortController,c=await this.fetchWithTimeout(a,i,o,l).catch(fs);if(c instanceof Error){if((h=r.signal)!=null&&h.aborted)throw new nt;if(t)return this.retryRequest(r,t);throw c.name==="AbortError"?new gl:new lr({cause:c})}const d=kl(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const y=`retrying, ${t} attempts remaining`;return Pt(`response (error; ${y})`,c.status,a,d),this.retryRequest(r,t,d)}const m=await c.text().catch(y=>fs(y).message),f=Od(m),p=f?void 0:m;throw Pt(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,a,d,p),this.makeStatusError(c.status,f,p,d)}return{response:c,options:r,controller:l}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new xd(this,r,e)}buildURL(e,t){const r=Md(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return Gn(s)||(t={...s,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new J(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,s){const{signal:i,...a}=t||{};i&&i.addEventListener("abort",()=>s.abort());const o=setTimeout(()=>s.abort(),r);return this.fetch.call(void 0,e,{signal:s.signal,...a}).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(s=o)}const a=r==null?void 0:r["retry-after"];if(a&&!s){const o=parseFloat(a);Number.isNaN(o)?s=Date.parse(a)-Date.now():s=o*1e3}if(!(s&&0<=s&&s<60*1e3)){const o=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,o)}return await Id(s),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const i=t-e,a=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${_t}`}}class Rd{constructor(e,t,r,s){An.set(this,void 0),Sd(this,An,e,"f"),this.options=s,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new J("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);t.query=void 0,t.path=e.url.toString()}return await Ed(this,An,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(An=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class xd extends ur{constructor(e,t,r){super(t,async s=>new r(e,s.response,await xl(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const kl=n=>new Proxy(Object.fromEntries(n.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),Pd={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},rt=n=>typeof n=="object"&&n!==null&&!Gn(n)&&Object.keys(n).every(e=>Cl(Pd,e)),kd=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_t,"X-Stainless-OS":Gi(Deno.build.os),"X-Stainless-Arch":Ki(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_t,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_t,"X-Stainless-OS":Gi(process.platform),"X-Stainless-Arch":Ki(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const n=Cd();return n?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_t,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${n.browser}`,"X-Stainless-Runtime-Version":n.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_t,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Cd(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const r=t.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,a=r[3]||0;return{browser:e,version:`${s}.${i}.${a}`}}}return null}const Ki=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",Gi=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Qi;const vd=()=>Qi??(Qi=kd()),Od=n=>{try{return JSON.parse(n)}catch{return}},Td=/^[a-z][a-z0-9+.-]*:/i,Md=n=>Td.test(n),Id=n=>new Promise(e=>setTimeout(e,n)),Ir=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new J(`${n} must be an integer`);if(e<0)throw new J(`${n} must be a positive integer`);return e},fs=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null)try{return new Error(JSON.stringify(n))}catch{}return new Error(String(n))},Fr=n=>{var e,t,r,s,i;if(typeof process<"u")return((t=(e=process.env)==null?void 0:e[n])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(i=(s=(r=Deno.env)==null?void 0:r.get)==null?void 0:s.call(r,n))==null?void 0:i.trim()};function Gn(n){if(!n)return!0;for(const e in n)return!1;return!0}function Cl(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Yi(n,e){for(const t in e){if(!Cl(e,t))continue;const r=t.toLowerCase();if(!r)continue;const s=e[t];s===null?delete n[r]:s!==void 0&&(n[r]=s)}}function Pt(n,...e){var t;typeof process<"u"&&((t=process==null?void 0:process.env)==null?void 0:t.DEBUG)==="true"&&console.log(`Anthropic:DEBUG:${n}`,...e)}const Fd=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)}),Nd=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Bd=n=>typeof(n==null?void 0:n.get)=="function",Zi=(n,e)=>{var r;const t=e.toLowerCase();if(Bd(n)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,a,o)=>a+o.toUpperCase());for(const i of[e,t,e.toUpperCase(),s]){const a=n.get(i);if(a)return a}}for(const[s,i]of Object.entries(n))if(s.toLowerCase()===t)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i};class fr extends Rd{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.has_more=r.has_more||!1,this.first_id=r.first_id||null,this.last_id=r.last_id||null}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var t;if((t=this.options.query)!=null&&t.before_id){const r=this.first_id;return r?{params:{before_id:r}}:null}const e=this.last_id;return e?{params:{after_id:e}}:null}}class Ge{constructor(e){this._client=e}}let zs=class extends Ge{retrieve(e,t){return this._client.get(`/v1/models/${e}?beta=true`,t)}list(e={},t){return rt(e)?this.list({},e):this._client.getAPIList("/v1/models?beta=true",Ks,{query:e,...t})}};class Ks extends fr{}zs.BetaModelInfosPage=Ks;class dr{constructor(e,t){this.iterator=e,this.controller=t}async*decoder(){const e=new ze;for await(const t of this.iterator)for(const r of e.decode(t))yield JSON.parse(r);for(const t of e.flush())yield JSON.parse(t)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(e,t){if(!e.body)throw t.abort(),new J("Attempted to iterate over a response with no body");return new dr(Xs(e.body),t)}}let Gs=class extends Ge{create(e,t){const{betas:r,...s}=e;return this._client.post("/v1/messages/batches?beta=true",{body:s,...t,headers:{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),...t==null?void 0:t.headers}})}retrieve(e,t={},r){if(rt(t))return this.retrieve(e,{},t);const{betas:s}=t;return this._client.get(`/v1/messages/batches/${e}?beta=true`,{...r,headers:{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString(),...r==null?void 0:r.headers}})}list(e={},t){if(rt(e))return this.list({},e);const{betas:r,...s}=e;return this._client.getAPIList("/v1/messages/batches?beta=true",Qs,{query:s,...t,headers:{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),...t==null?void 0:t.headers}})}cancel(e,t={},r){if(rt(t))return this.cancel(e,{},t);const{betas:s}=t;return this._client.post(`/v1/messages/batches/${e}/cancel?beta=true`,{...r,headers:{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString(),...r==null?void 0:r.headers}})}async results(e,t={},r){if(rt(t))return this.results(e,{},t);const s=await this.retrieve(e);if(!s.results_url)throw new J(`No batch \`results_url\`; Has it finished processing? ${s.processing_status} - ${s.id}`);const{betas:i}=t;return this._client.get(s.results_url,{...r,headers:{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString(),...r==null?void 0:r.headers},__binaryResponse:!0})._thenUnwrap((a,o)=>dr.fromResponse(o.response,o.controller))}};class Qs extends fr{}Gs.BetaMessageBatchesPage=Qs;let hr=class extends Ge{constructor(){super(...arguments),this.batches=new Gs(this._client)}create(e,t){const{betas:r,...s}=e;return this._client.post("/v1/messages?beta=true",{body:s,timeout:this._client._options.timeout??6e5,...t,headers:{...(r==null?void 0:r.toString())!=null?{"anthropic-beta":r==null?void 0:r.toString()}:void 0,...t==null?void 0:t.headers},stream:e.stream??!1})}countTokens(e,t){const{betas:r,...s}=e;return this._client.post("/v1/messages/count_tokens?beta=true",{body:s,...t,headers:{"anthropic-beta":[...r??[],"token-counting-2024-11-01"].toString(),...t==null?void 0:t.headers}})}};hr.Batches=Gs;hr.BetaMessageBatchesPage=Qs;class gn extends Ge{constructor(){super(...arguments),this.models=new zs(this._client),this.messages=new hr(this._client)}}gn.Models=zs;gn.BetaModelInfosPage=Ks;gn.Messages=hr;class vl extends Ge{create(e,t){return this._client.post("/v1/complete",{body:e,timeout:this._client._options.timeout??6e5,...t,stream:e.stream??!1})}}class Ys extends Ge{create(e,t){return this._client.post("/v1/messages/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/v1/messages/batches/${e}`,t)}list(e={},t){return rt(e)?this.list({},e):this._client.getAPIList("/v1/messages/batches",Zs,{query:e,...t})}cancel(e,t){return this._client.post(`/v1/messages/batches/${e}/cancel`,t)}async results(e,t){const r=await this.retrieve(e);if(!r.results_url)throw new J(`No batch \`results_url\`; Has it finished processing? ${r.processing_status} - ${r.id}`);return this._client.get(r.results_url,{...t,__binaryResponse:!0})._thenUnwrap((s,i)=>dr.fromResponse(i.response,i.controller))}}class Zs extends fr{}Ys.MessageBatchesPage=Zs;const $d=n=>{let e=0,t=[];for(;e<n.length;){let r=n[e];if(r==="\\"){e++;continue}if(r==="{"){t.push({type:"brace",value:"{"}),e++;continue}if(r==="}"){t.push({type:"brace",value:"}"}),e++;continue}if(r==="["){t.push({type:"paren",value:"["}),e++;continue}if(r==="]"){t.push({type:"paren",value:"]"}),e++;continue}if(r===":"){t.push({type:"separator",value:":"}),e++;continue}if(r===","){t.push({type:"delimiter",value:","}),e++;continue}if(r==='"'){let o="",l=!1;for(r=n[++e];r!=='"';){if(e===n.length){l=!0;break}if(r==="\\"){if(e++,e===n.length){l=!0;break}o+=r+n[e],r=n[++e]}else o+=r,r=n[++e]}r=n[++e],l||t.push({type:"string",value:o});continue}if(r&&/\s/.test(r)){e++;continue}let i=/[0-9]/;if(r&&i.test(r)||r==="-"||r==="."){let o="";for(r==="-"&&(o+=r,r=n[++e]);r&&i.test(r)||r===".";)o+=r,r=n[++e];t.push({type:"number",value:o});continue}let a=/[a-z]/i;if(r&&a.test(r)){let o="";for(;r&&a.test(r)&&e!==n.length;)o+=r,r=n[++e];if(o=="true"||o=="false"||o==="null")t.push({type:"name",value:o});else{e++;continue}continue}e++}return t},yt=n=>{if(n.length===0)return n;let e=n[n.length-1];switch(e.type){case"separator":return n=n.slice(0,n.length-1),yt(n);case"number":let t=e.value[e.value.length-1];if(t==="."||t==="-")return n=n.slice(0,n.length-1),yt(n);case"string":let r=n[n.length-2];if((r==null?void 0:r.type)==="delimiter")return n=n.slice(0,n.length-1),yt(n);if((r==null?void 0:r.type)==="brace"&&r.value==="{")return n=n.slice(0,n.length-1),yt(n);break;case"delimiter":return n=n.slice(0,n.length-1),yt(n)}return n},Ld=n=>{let e=[];return n.map(t=>{t.type==="brace"&&(t.value==="{"?e.push("}"):e.splice(e.lastIndexOf("}"),1)),t.type==="paren"&&(t.value==="["?e.push("]"):e.splice(e.lastIndexOf("]"),1))}),e.length>0&&e.reverse().map(t=>{t==="}"?n.push({type:"brace",value:"}"}):t==="]"&&n.push({type:"paren",value:"]"})}),n},Dd=n=>{let e="";return n.map(t=>{switch(t.type){case"string":e+='"'+t.value+'"';break;default:e+=t.value;break}}),e},Ud=n=>JSON.parse(Dd(Ld(yt($d(n)))));var oe=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},B=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},we,Je,Rn,xn,Ut,jt,Pn,qt,$e,Ht,kn,Cn,ht,Nr,ea,Br,$r,Lr,Dr,ta;const na="__json_buf";class Qn{constructor(){we.add(this),this.messages=[],this.receivedMessages=[],Je.set(this,void 0),this.controller=new AbortController,Rn.set(this,void 0),xn.set(this,()=>{}),Ut.set(this,()=>{}),jt.set(this,void 0),Pn.set(this,()=>{}),qt.set(this,()=>{}),$e.set(this,{}),Ht.set(this,!1),kn.set(this,!1),Cn.set(this,!1),ht.set(this,!1),Br.set(this,e=>{if(oe(this,kn,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new nt),e instanceof nt)return oe(this,Cn,!0,"f"),this._emit("abort",e);if(e instanceof J)return this._emit("error",e);if(e instanceof Error){const t=new J(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new J(String(e)))}),oe(this,Rn,new Promise((e,t)=>{oe(this,xn,e,"f"),oe(this,Ut,t,"f")}),"f"),oe(this,jt,new Promise((e,t)=>{oe(this,Pn,e,"f"),oe(this,qt,t,"f")}),"f"),B(this,Rn,"f").catch(()=>{}),B(this,jt,"f").catch(()=>{})}static fromReadableStream(e){const t=new Qn;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,r){const s=new Qn;for(const i of t.messages)s._addMessageParam(i);return s._run(()=>s._createMessage(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},B(this,Br,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,r){var a;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),B(this,we,"m",$r).call(this);const i=await e.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const o of i)B(this,we,"m",Lr).call(this,o);if((a=i.controller.signal)!=null&&a.aborted)throw new nt;B(this,we,"m",Dr).call(this)}_connected(){this.ended||(B(this,xn,"f").call(this),this._emit("connect"))}get ended(){return B(this,Ht,"f")}get errored(){return B(this,kn,"f")}get aborted(){return B(this,Cn,"f")}abort(){this.controller.abort()}on(e,t){return(B(this,$e,"f")[e]||(B(this,$e,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=B(this,$e,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===t);return s>=0&&r.splice(s,1),this}once(e,t){return(B(this,$e,"f")[e]||(B(this,$e,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{oe(this,ht,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){oe(this,ht,!0,"f"),await B(this,jt,"f")}get currentMessage(){return B(this,Je,"f")}async finalMessage(){return await this.done(),B(this,we,"m",Nr).call(this)}async finalText(){return await this.done(),B(this,we,"m",ea).call(this)}_emit(e,...t){if(B(this,Ht,"f"))return;e==="end"&&(oe(this,Ht,!0,"f"),B(this,Pn,"f").call(this));const r=B(this,$e,"f")[e];if(r&&(B(this,$e,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...t))),e==="abort"){const s=t[0];!B(this,ht,"f")&&!(r!=null&&r.length)&&Promise.reject(s),B(this,Ut,"f").call(this,s),B(this,qt,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=t[0];!B(this,ht,"f")&&!(r!=null&&r.length)&&Promise.reject(s),B(this,Ut,"f").call(this,s),B(this,qt,"f").call(this,s),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",B(this,we,"m",Nr).call(this))}async _fromReadableStream(e,t){var i;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),B(this,we,"m",$r).call(this),this._connected();const s=Ve.fromReadableStream(e,this.controller);for await(const a of s)B(this,we,"m",Lr).call(this,a);if((i=s.controller.signal)!=null&&i.aborted)throw new nt;B(this,we,"m",Dr).call(this)}[(Je=new WeakMap,Rn=new WeakMap,xn=new WeakMap,Ut=new WeakMap,jt=new WeakMap,Pn=new WeakMap,qt=new WeakMap,$e=new WeakMap,Ht=new WeakMap,kn=new WeakMap,Cn=new WeakMap,ht=new WeakMap,Br=new WeakMap,we=new WeakSet,Nr=function(){if(this.receivedMessages.length===0)throw new J("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},ea=function(){if(this.receivedMessages.length===0)throw new J("stream ended without producing a Message with role=assistant");const t=this.receivedMessages.at(-1).content.filter(r=>r.type==="text").map(r=>r.text);if(t.length===0)throw new J("stream ended without producing a content block with type=text");return t.join(" ")},$r=function(){this.ended||oe(this,Je,void 0,"f")},Lr=function(t){if(this.ended)return;const r=B(this,we,"m",ta).call(this,t);switch(this._emit("streamEvent",t,r),t.type){case"content_block_delta":{const s=r.content.at(-1);t.delta.type==="text_delta"&&s.type==="text"?this._emit("text",t.delta.text,s.text||""):t.delta.type==="input_json_delta"&&s.type==="tool_use"&&s.input&&this._emit("inputJson",t.delta.partial_json,s.input);break}case"message_stop":{this._addMessageParam(r),this._addMessage(r,!0);break}case"content_block_stop":{this._emit("contentBlock",r.content.at(-1));break}case"message_start":{oe(this,Je,r,"f");break}}},Dr=function(){if(this.ended)throw new J("stream has ended, this shouldn't happen");const t=B(this,Je,"f");if(!t)throw new J("request ended without sending any chunks");return oe(this,Je,void 0,"f"),t},ta=function(t){let r=B(this,Je,"f");if(t.type==="message_start"){if(r)throw new J(`Unexpected event order, got ${t.type} before receiving "message_stop"`);return t.message}if(!r)throw new J(`Unexpected event order, got ${t.type} before "message_start"`);switch(t.type){case"message_stop":return r;case"message_delta":return r.stop_reason=t.delta.stop_reason,r.stop_sequence=t.delta.stop_sequence,r.usage.output_tokens=t.usage.output_tokens,r;case"content_block_start":return r.content.push(t.content_block),r;case"content_block_delta":{const s=r.content.at(t.index);if((s==null?void 0:s.type)==="text"&&t.delta.type==="text_delta")s.text+=t.delta.text;else if((s==null?void 0:s.type)==="tool_use"&&t.delta.type==="input_json_delta"){let i=s[na]||"";i+=t.delta.partial_json,Object.defineProperty(s,na,{value:i,enumerable:!1,writable:!0}),i&&(s.input=Ud(i))}return r}case"content_block_stop":return r}},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("streamEvent",s=>{const i=t.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,a)=>t.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Ve(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class mr extends Ge{constructor(){super(...arguments),this.batches=new Ys(this._client)}create(e,t){return e.model in ra&&console.warn(`The model '${e.model}' is deprecated and will reach end-of-life on ${ra[e.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`),this._client.post("/v1/messages",{body:e,timeout:this._client._options.timeout??6e5,...t,stream:e.stream??!1})}stream(e,t){return Qn.createMessage(this,e,t)}countTokens(e,t){return this._client.post("/v1/messages/count_tokens",{body:e,...t})}}const ra={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024"};mr.Batches=Ys;mr.MessageBatchesPage=Zs;class ei extends Ge{retrieve(e,t){return this._client.get(`/v1/models/${e}`,t)}list(e={},t){return rt(e)?this.list({},e):this._client.getAPIList("/v1/models",ti,{query:e,...t})}}class ti extends fr{}ei.ModelInfosPage=ti;var Ol;class H extends Ad{constructor({baseURL:e=Fr("ANTHROPIC_BASE_URL"),apiKey:t=Fr("ANTHROPIC_API_KEY")??null,authToken:r=Fr("ANTHROPIC_AUTH_TOKEN")??null,...s}={}){const i={apiKey:t,authToken:r,...s,baseURL:e||"https://api.anthropic.com"};if(!i.dangerouslyAllowBrowser&&Nd())throw new J(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Anthropic({ apiKey, dangerouslyAllowBrowser: true });
`);super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new vl(this),this.messages=new mr(this),this.models=new ei(this),this.beta=new gn(this),this._options=i,this.apiKey=t,this.authToken=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01",...this._options.defaultHeaders}}validateHeaders(e,t){if(!(this.apiKey&&e["x-api-key"])&&t["x-api-key"]!==null&&!(this.authToken&&e.authorization)&&t.authorization!==null)throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}authHeaders(e){const t=this.apiKeyAuth(e),r=this.bearerAuth(e);return t!=null&&!Gn(t)?t:r!=null&&!Gn(r)?r:{}}apiKeyAuth(e){return this.apiKey==null?{}:{"X-Api-Key":this.apiKey}}bearerAuth(e){return this.authToken==null?{}:{Authorization:`Bearer ${this.authToken}`}}}Ol=H;H.Anthropic=Ol;H.HUMAN_PROMPT=`

Human:`;H.AI_PROMPT=`

Assistant:`;H.DEFAULT_TIMEOUT=6e5;H.AnthropicError=J;H.APIError=se;H.APIConnectionError=lr;H.APIConnectionTimeoutError=gl;H.APIUserAbortError=nt;H.NotFoundError=bl;H.ConflictError=Sl;H.RateLimitError=Al;H.BadRequestError=_l;H.AuthenticationError=yl;H.InternalServerError=Rl;H.PermissionDeniedError=wl;H.UnprocessableEntityError=El;H.toFile=gd;H.fileFromPath=pl;H.Completions=vl;H.Messages=mr;H.Models=ei;H.ModelInfosPage=ti;H.Beta=gn;function sa(n){let e,t,r,s,i,a,o=n[8]&&ia();return{c(){e=P("div"),t=P("div"),r=ce(n[7]),s=T(),o&&o.c(),C(t,"max-height","250px"),C(t,"overflow-y","auto"),C(t,"margin-top","10px"),C(t,"white-space","pre-wrap"),C(t,"line-height","1.3"),C(t,"scrollbar-width","thin"),C(e,"width","94%"),C(e,"padding","3%"),C(e,"align-self","center"),C(e,"background","var(--b3-card-background)")},m(l,c){V(l,e,c),b(e,t),b(t,r),n[14](t),b(e,s),o&&o.m(e,null),a=!0},p(l,c){(!a||c&128)&&Xe(r,l[7]),l[8]?o||(o=ia(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},i(l){a||(l&&it(()=>{a&&(i||(i=qn(e,Hn,{duration:200},!0)),i.run(1))}),a=!0)},o(l){l&&(i||(i=qn(e,Hn,{duration:200},!1)),i.run(0)),a=!1},d(l){l&&q(e),n[14](null),o&&o.d(),l&&i&&i.end()}}}function ia(n){let e;return{c(){e=P("div"),e.innerHTML='<span style="color: var(--b3-theme-primary);">...</span>',C(e,"width","100%"),C(e,"text-align","center"),C(e,"border-top","1px solid var(--b3-border-color)")},m(t,r){V(t,e,r)},d(t){t&&q(e)}}}function aa(n){let e,t,r;return t=new Ya({props:{group:"custom",settingStorage:n[0],display:!0}}),t.$on("changed",n[22]),{c(){e=P("div"),Ne(t.$$.fragment),C(e,"margin-top","10px"),C(e,"padding","10px"),C(e,"background","none"),C(e,"border-radius","4px"),C(e,"border","1px solid var(--b3-border-color)")},m(s,i){V(s,e,i),xe(t,e,null),r=!0},p(s,i){const a={};i&1&&(a.settingStorage=s[0]),t.$set(a)},i(s){r||(j(t.$$.fragment,s),r=!0)},o(s){z(t.$$.fragment,s),r=!1},d(s){s&&q(e),Pe(t)}}}function jd(n){let e,t,r,s,i,a,o,l,c,d,u,h,m,f,p,g,k,y=n[6]&&sa(n);function x(E){n[19](E)}let S={type:"select",key:"modelSelections",fnSize:!1,options:n[0].get("modelSelections").options,style:"margin-right: 5px;font-size: 12px; padding: 2px 4px; border-radius: 4px; border: 1px solid #ddd; height: 2em; background: transparent;"};n[5]!==void 0&&(S.value=n[5]),a=new Pa({props:S}),kt.push(()=>xa(a,"value",x)),a.$on("changed",n[20]);let w=n[4]&&aa(n);return{c(){e=P("div"),y&&y.c(),t=T(),r=P("div"),s=P("input"),i=T(),Ne(a.$$.fragment),l=T(),c=P("button"),c.textContent="",d=T(),u=P("button"),u.innerHTML='<svg width="20" height="20" viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" class="svelte-sx9euk"></path></svg>',m=T(),f=P("div"),w&&w.c(),R(s,"type","text"),R(s,"placeholder"," AI ... "),R(s,"class",".b3-text-field fn__block fn__flex-center"),C(s,"width","calc(100% - 120px)"),C(s,"height","3em"),C(s,"white-space","normal"),C(s,"background","transparent"),C(s,"border","0"),C(s,"outline","none"),C(s,"margin-left","0.5em"),R(c,"type","button"),R(c,"class","ai-instruction-params-button svelte-sx9euk"),C(c,"font-size","12px"),C(c,"color","#666"),C(c,"text-decoration","none"),C(c,"background","none"),C(c,"border","none"),C(c,"padding","0"),C(c,"cursor","pointer"),C(c,"margin-right","35px"),C(c,"white-space","nowrap"),R(u,"type","button"),R(u,"class","ai-instruction-submit-button svelte-sx9euk"),C(u,"position","absolute"),C(u,"right","10px"),C(u,"top","50%"),C(u,"transform","translateY(-50%)"),C(u,"opacity","0.6"),C(u,"cursor","pointer"),C(u,"background","none"),C(u,"border","none"),C(u,"padding","0"),C(r,"width","100%"),C(r,"height","100%"),C(r,"display","flex"),C(r,"position","relative"),C(r,"align-items","center"),C(f,"width","100%"),C(e,"width","100%")},m(E,A){V(E,e,A),y&&y.m(e,null),b(e,t),b(e,r),b(r,s),n[15](s),be(s,n[1]),b(r,i),xe(a,r,null),b(r,l),b(r,c),b(r,d),b(r,u),b(e,m),b(e,f),w&&w.m(f,null),p=!0,g||(k=[W(s,"input",n[16]),W(s,"keydown",n[11]),W(s,"focus",n[17]),W(s,"blur",n[18]),W(c,"click",n[21]),W(u,"click",n[10]),W(u,"keydown",n[11])],g=!0)},p(E,[A]){E[6]?y?(y.p(E,A),A&64&&j(y,1)):(y=sa(E),y.c(),j(y,1),y.m(e,t)):y&&(nn(),z(y,1,1,()=>{y=null}),rn()),A&2&&s.value!==E[1]&&be(s,E[1]);const M={};A&1&&(M.options=E[0].get("modelSelections").options),!o&&A&32&&(o=!0,M.value=E[5],Aa(()=>o=!1)),a.$set(M),E[4]?w?(w.p(E,A),A&16&&j(w,1)):(w=aa(E),w.c(),j(w,1),w.m(f,null)):w&&(nn(),z(w,1,1,()=>{w=null}),rn())},i(E){p||(j(y),j(a.$$.fragment,E),E&&it(()=>{p&&(h||(h=qn(r,Hn,{duration:200},!0)),h.run(1))}),j(w),p=!0)},o(E){z(y),z(a.$$.fragment,E),E&&(h||(h=qn(r,Hn,{duration:200},!1)),h.run(0)),z(w),p=!1},d(E){E&&q(e),y&&y.d(),n[15](null),Pe(a),E&&h&&h.end(),w&&w.d(),g=!1,ae(k)}}}function qd(n,e,t){let{openai:r}=e,{claude:s}=e,{settingStorage:i}=e,a="",o=!1,l,c=!1,d=i.getValue("modelSelections"),u=!1,h="",m=!1,f;function p(){const v=lc();let ee=[];if(v.trim())ee.push({role:"user",content:`:${v}

:${a}`});else if(i.getValue("isPageContent")){const{title:ge,content:_e}=cc();ee.push({role:"user",content:`:${ge}

:${_e}

${a}`})}else ee.push({role:"user",content:`${a}`});k(r,s,d,i,ee)}function g(v){v.key==="Enter"?p():v.key==="Escape"&&console.debug("ai")}async function k(v,ee,ge,_e,He){var ot,Nt,lt,Bt,ct,$t;t(6,u=!0),t(8,m=!0),t(7,h="");try{if(ge.includes("claude")){const Qe=await ee.messages.stream({model:ge,max_tokens:(ot=_e.get("maxOutputLength"))==null?void 0:ot.value,messages:He});for await(const Se of Qe)if(Se.type==="content_block_delta"){const Ye="text"in Se.delta?Se.delta.text:Se.delta.toString();t(7,h+=Ye),f&&t(9,f.scrollTop=f.scrollHeight,f)}return}const ye=await v.chat.completions.create({model:ge,max_tokens:(Nt=_e.get("maxOutputLength"))==null?void 0:Nt.value,temperature:(lt=_e.get("temperature"))==null?void 0:lt.value,stream:!0,messages:He});for await(const Qe of ye)if(($t=(ct=(Bt=Qe.choices)==null?void 0:Bt[0])==null?void 0:ct.delta)!=null&&$t.content){const Se=Qe.choices[0].delta.content;t(7,h+=Se),f&&t(9,f.scrollTop=f.scrollHeight,f)}}catch(ye){console.error(":",ye),t(7,h+=`
: `+ye.message)}finally{await navigator.clipboard.writeText(h),fa(""),t(8,m=!1)}}Sa(()=>{l.focus()});function y(v){kt[v?"unshift":"push"](()=>{f=v,t(9,f)})}function x(v){kt[v?"unshift":"push"](()=>{l=v,t(3,l)})}function S(){a=this.value,t(1,a)}const w=()=>t(2,o=!0),E=()=>t(2,o=!1);function A(v){d=v,t(5,d)}const M=({detail:v})=>{i.setValue(v.key,v.value),i.save()},F=()=>{t(4,c=!c),c&&i.save()},I=({detail:v})=>{i.setValue(v.key,v.value),i.save()};return n.$$set=v=>{"openai"in v&&t(12,r=v.openai),"claude"in v&&t(13,s=v.claude),"settingStorage"in v&&t(0,i=v.settingStorage)},[i,a,o,l,c,d,u,h,m,f,p,g,r,s,y,x,S,w,E,A,M,F,I]}class Hd extends qe{constructor(e){super(),je(this,e,qd,jd,Ue,{openai:12,claude:13,settingStorage:0})}}function Wd(n,e,t){const r=new wt.Dialog({title:"",content:'<div id="ai-instruction""></div>',width:"40%",hideCloseIcon:!0});new Hd({target:r.element.querySelector("#ai-instruction"),props:{openai:e,claude:t,settingStorage:n}})}function Jd(n){let e,t,r,s,i,a=[{type:"button"},n[4],{class:r=["b3-button",n[3],n[2]].join(" ")},{style:n[1]}],o={};for(let l=0;l<a.length;l+=1)o=Dn(o,a[l]);return{c(){e=P("button"),t=ce(n[0]),si(e,o)},m(l,c){V(l,e,c),b(e,t),e.autofocus&&e.focus(),s||(i=W(e,"click",n[8]),s=!0)},p(l,[c]){c&1&&Wl(t,l[0],o.contenteditable),si(e,o=ic(a,[{type:"button"},c&16&&l[4],c&12&&r!==(r=["b3-button",l[3],l[2]].join(" "))&&{class:r},c&2&&{style:l[1]}]))},i:ie,o:ie,d(l){l&&q(e),s=!1,i()}}}function Vd(n,e,t){let r,s,i,{text:a=!1}=e,{outline:o=!1}=e,{backgroundColor:l=void 0}=e,{label:c=""}=e;function d(u){Gl.call(this,n,u)}return n.$$set=u=>{t(4,e=Dn(Dn({},e),ri(u))),"text"in u&&t(5,a=u.text),"outline"in u&&t(6,o=u.outline),"backgroundColor"in u&&t(7,l=u.backgroundColor),"label"in u&&t(0,c=u.label)},n.$$.update=()=>{n.$$.dirty&64&&t(3,r=o?"b3-button--outline":""),n.$$.dirty&32&&t(2,s=a?"b3-button--text":""),n.$$.dirty&128&&t(1,i=l?`background-color: ${l}`:"")},e=ri(e),[c,i,s,r,e,a,o,l,d]}class oa extends qe{constructor(e){super(),je(this,e,Vd,Jd,Ue,{text:5,outline:6,backgroundColor:7,label:0})}}function Xd(n){let e,t,r,s,i,a,o,l,c,d,u,h,m,f,p,g,k,y,x,S,w,E,A;return{c(){e=P("div"),t=P("h2"),t.textContent="token",r=T(),s=P("p"),s.textContent=`token
         1
        1 1  1  1  token`,i=T(),a=P("h2"),a.textContent="Temperature ",o=T(),l=P("p"),l.innerHTML=`<span data-type="code">temperature</span> 
        1.0
        <span data-type="code">temperature</span>`,c=T(),d=P("table"),d.innerHTML="<thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>/</td> <td>0.0</td></tr> <tr><td>/</td> <td>1.0</td></tr> <tr><td></td> <td>1.3</td></tr> <tr><td></td> <td>1.3</td></tr> <tr><td>/</td> <td>1.5</td></tr></tbody>",u=T(),h=P("h2"),h.textContent="model",m=T(),f=P("p"),f.textContent=" = token   ",p=T(),g=P("table"),g.innerHTML='<thead><tr><th></th> <th></th> <th></th> <th><br/></th> <th></th></tr></thead> <tbody><tr><td><span data-type="strong">deepseek-chat</span></td> <td>64K</td> <td>8K</td> <td>1/tokens</td> <td>2/tokens</td></tr> <tr><td>qwen-max</td> <td>32,768</td> <td>8,192</td> <td>20/tokens</td> <td>60/tokens</td></tr> <tr><td>qwen-plus</td> <td>129,024</td> <td>8,192</td> <td>0.8/tokens</td> <td>2/tokens</td></tr> <tr><td>qwen-turbo</td> <td>1,000,000</td> <td>8,192</td> <td>0.3/tokens</td> <td>0.6/tokens</td></tr> <tr><td>qwen-long</td> <td>10,000,000</td> <td>6,000</td> <td>0.25/tokens</td> <td>1/tokens</td></tr> <tr><td><span data-type="s">gpt-3.5-turbo</span></td> <td></td> <td></td> <td><span data-type="s">6/tokens</span></td> <td><span data-type="s">18/tokens</span></td></tr> <tr><td>gpt-4o-mini</td> <td></td> <td></td> <td>1.8/tokens</td> <td>7.2/tokens</td></tr> <tr><td>gpt-4o</td> <td></td> <td></td> <td>30/tokens</td> <td>120/tokens</td></tr> <tr><td><span data-type="strong text" style="color: var(--b3-font-color8);">gpt-4-turbo</span></td> <td></td> <td></td> <td>120/tokens</td> <td>360/tokens</td></tr> <tr><td>claude-3-5-haiku</td> <td></td> <td></td> <td>12/tokens</td> <td>60/tokens</td></tr> <tr><td>claude-3-5-sonnet</td> <td></td> <td></td> <td>36/tokens</td> <td>180/tokens</td></tr> <tr><td><span data-type="strong text" style="color: var(--b3-font-color8);">claude-3-opus</span></td> <td></td> <td></td> <td>180/tokens</td> <td>900/tokens</td></tr> <tr><td>gemini-1.5-flash</td> <td></td> <td></td> <td>0.896/tokens</td> <td>3.6/tokens</td></tr> <tr><td>gemini-1.5-pro</td> <td></td> <td></td> <td>15/tokens</td> <td>60/tokens</td></tr></tbody>',k=T(),y=P("h3"),y.textContent="",x=T(),S=P("p"),S.innerHTML='<a href="https://www.datalearner.com/ai-models/leaderboard/datalearner-llm-leaderboard"></a>',w=T(),E=P("p"),E.innerHTML='<a href="https://www.datalearner.com/ai-models/leaderboard/datalearner-llm-coding-leaderboard#google_vignette"></a>',R(e,"class",A="b3-typography "+n[0]),C(e,"margin","10px auto"),C(e,"max-height","80vh"),C(e,"overflow-y","auto"),C(e,"width","95%"),C(e,"max-width","1200px")},m(M,F){V(M,e,F),b(e,t),b(e,r),b(e,s),b(e,i),b(e,a),b(e,o),b(e,l),b(e,c),b(e,d),b(e,u),b(e,h),b(e,m),b(e,f),b(e,p),b(e,g),b(e,k),b(e,y),b(e,x),b(e,S),b(e,w),b(e,E)},p(M,[F]){F&1&&A!==(A="b3-typography "+M[0])&&R(e,"class",A)},i:ie,o:ie,d(M){M&&q(e)}}}function zd(n,e,t){let r,{display:s=!0}=e;return n.$$set=i=>{"display"in i&&t(1,s=i.display)},n.$$.update=()=>{n.$$.dirty&2&&t(0,r=s?"":"fn__none")},[r,s]}let Kd=class extends qe{constructor(e){super(),je(this,e,zd,Xd,Ue,{display:1})}};function Gd(n){let e,t,r,s,i,a,o,l,c,d,u,h,m,f,p,g,k,y,x,S,w,E,A,M,F,I,v,ee,ge,_e,He,ot,Nt,lt,Bt,ct,$t,ye,Qe,Se;return{c(){e=P("div"),t=P("h1"),t.textContent="",r=T(),s=P("h2"),s.textContent="",i=T(),a=P("p"),a.textContent="option + command + k",o=T(),l=P("div"),l.innerHTML='<img src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/yyy.jpg" alt=""/>',c=T(),d=P("h3"),d.textContent="",u=T(),h=P("div"),h.innerHTML='<img src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/xx.jpg" alt=""/>',m=T(),f=P("h3"),f.textContent="",p=T(),g=P("div"),g.innerHTML='<img src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/WechatIMG252.jpg" alt=""/>',k=T(),y=P("h3"),y.textContent="",x=T(),S=P("p"),S.textContent="",w=T(),E=P("div"),E.innerHTML='<video controls="" src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/%E6%97%A0%E4%B8%AD%E7%94%9F%E6%9C%89.mp4" data-src=""></video>',A=T(),M=P("h3"),M.textContent="",F=T(),I=P("div"),I.innerHTML='<video controls="" src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/%E6%80%BB%E7%BB%93%E6%96%87%E6%A1%A3.mp4" data-src=""></video>',v=T(),ee=P("h3"),ee.textContent="",ge=T(),_e=P("div"),_e.innerHTML='<video controls="" src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/%E6%89%A9%E5%86%99.mp4" data-src=""></video>',He=T(),ot=P("h2"),ot.textContent="",Nt=T(),lt=P("p"),lt.textContent="...",Bt=T(),ct=P("h2"),ct.textContent="",$t=T(),ye=P("img"),R(a,"id","20250116161508-2ifhw0n"),R(l,"class","iframe"),R(h,"class","iframe"),R(g,"class","iframe"),R(E,"class","iframe"),R(I,"class","iframe"),R(_e,"class","iframe"),Fl(ye.src,Qe="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/WechatIMG6765.jpg")||R(ye,"src",Qe),R(ye,"alt",""),C(ye,"width","50%"),C(ye,"height","auto"),R(e,"class",Se="b3-typography "+n[0]),C(e,"max-width","800px"),C(e,"margin","0 auto")},m(Ye,pr){V(Ye,e,pr),b(e,t),b(e,r),b(e,s),b(e,i),b(e,a),b(e,o),b(e,l),b(e,c),b(e,d),b(e,u),b(e,h),b(e,m),b(e,f),b(e,p),b(e,g),b(e,k),b(e,y),b(e,x),b(e,S),b(e,w),b(e,E),b(e,A),b(e,M),b(e,F),b(e,I),b(e,v),b(e,ee),b(e,ge),b(e,_e),b(e,He),b(e,ot),b(e,Nt),b(e,lt),b(e,Bt),b(e,ct),b(e,$t),b(e,ye)},p(Ye,[pr]){pr&1&&Se!==(Se="b3-typography "+Ye[0])&&R(e,"class",Se)},i:ie,o:ie,d(Ye){Ye&&q(e)}}}function Qd(n,e,t){let r,{display:s=!0}=e;return n.$$set=i=>{"display"in i&&t(1,s=i.display)},n.$$.update=()=>{n.$$.dirty&2&&t(0,r=s?"":"fn__none")},[r,s]}let Yd=class extends qe{constructor(e){super(),je(this,e,Qd,Gd,Ue,{display:1})}};function la(n,e,t){const r=n.slice();return r[8]=e[t],r}function ca(n){let e,t,r,s,i;function a(){return n[4](n[8])}return{c(){e=P("li"),t=P("span"),t.textContent=`${n[8]}`,r=T(),R(t,"class","b3-list-item__text"),R(e,"data-name","editor"),R(e,"class","b3-list-item svelte-1fh5pey"),K(e,"b3-list-item--focus",n[8]===n[2])},m(o,l){V(o,e,l),b(e,t),b(e,r),s||(i=[W(e,"click",a),W(e,"keydown",eh)],s=!0)},p(o,l){n=o,l&12&&K(e,"b3-list-item--focus",n[8]===n[2])},d(o){o&&q(e),s=!1,ae(i)}}}function Zd(n){let e,t,r,s,i,a,o,l,c,d,u,h,m,f,p,g,k,y,x=Ct(n[3]),S=[];for(let w=0;w<x.length;w+=1)S[w]=ca(la(n,x,w));return i=new Ya({props:{group:n[3][0],settingStorage:n[0],display:n[2]===n[3][0]}}),i.$on("changed",n[5]),o=new Kd({props:{display:n[2]===n[3][2]}}),c=new Yd({props:{display:n[2]===n[3][3]}}),h=new oa({props:{label:"",text:!0,outline:!0}}),h.$on("click",n[6]),g=new oa({props:{label:"",text:!1,outline:!1}}),g.$on("click",n[7]),{c(){e=P("div"),t=P("ul");for(let w=0;w<S.length;w+=1)S[w].c();r=T(),s=P("div"),Ne(i.$$.fragment),a=T(),Ne(o.$$.fragment),l=T(),Ne(c.$$.fragment),d=T(),u=P("div"),Ne(h.$$.fragment),m=T(),f=P("div"),p=T(),Ne(g.$$.fragment),R(t,"class","b3-tab-bar b3-list b3-list--background svelte-1fh5pey"),R(f,"class","fn__space"),R(u,"class",k="b3-dialog__action "+(n[2]==n[3][0]?"":"fn__none")),R(s,"class","config__tab-wrap"),R(e,"class","fn__flex-1 fn__flex config__panel svelte-1fh5pey")},m(w,E){V(w,e,E),b(e,t);for(let A=0;A<S.length;A+=1)S[A]&&S[A].m(t,null);b(e,r),b(e,s),xe(i,s,null),b(s,a),xe(o,s,null),b(s,l),xe(c,s,null),b(s,d),b(s,u),xe(h,u,null),b(u,m),b(u,f),b(u,p),xe(g,u,null),y=!0},p(w,[E]){if(E&12){x=Ct(w[3]);let I;for(I=0;I<x.length;I+=1){const v=la(w,x,I);S[I]?S[I].p(v,E):(S[I]=ca(v),S[I].c(),S[I].m(t,null))}for(;I<S.length;I+=1)S[I].d(1);S.length=x.length}const A={};E&1&&(A.settingStorage=w[0]),E&4&&(A.display=w[2]===w[3][0]),i.$set(A);const M={};E&4&&(M.display=w[2]===w[3][2]),o.$set(M);const F={};E&4&&(F.display=w[2]===w[3][3]),c.$set(F),(!y||E&4&&k!==(k="b3-dialog__action "+(w[2]==w[3][0]?"":"fn__none")))&&R(u,"class",k)},i(w){y||(j(i.$$.fragment,w),j(o.$$.fragment,w),j(c.$$.fragment,w),j(h.$$.fragment,w),j(g.$$.fragment,w),y=!0)},o(w){z(i.$$.fragment,w),z(o.$$.fragment,w),z(c.$$.fragment,w),z(h.$$.fragment,w),z(g.$$.fragment,w),y=!1},d(w){w&&q(e),ya(S,w),Pe(i),Pe(o),Pe(c),Pe(h),Pe(g)}}}const eh=()=>{};function th(n,e,t){let r=[" "," prompt"," "," "],s=r[0],{settingStorage:i}=e,{dialog:a}=e;const o=u=>{t(2,s=u)},l=({detail:u})=>{i.setValue(u.key,u.value)},c=()=>{i.load(),a.destroy()},d=()=>{i.save(),a.destroy()};return n.$$set=u=>{"settingStorage"in u&&t(0,i=u.settingStorage),"dialog"in u&&t(1,a=u.dialog)},[i,a,s,r,o,l,c,d]}class nh extends qe{constructor(e){super(),je(this,e,th,Zd,Ue,{settingStorage:0,dialog:1})}}const rh=`<symbol id="iconFace" viewBox="0 0 32 32">
<path d="M13.667 17.333c0 0.92-0.747 1.667-1.667 1.667s-1.667-0.747-1.667-1.667 0.747-1.667 1.667-1.667 1.667 0.747 1.667 1.667zM20 15.667c-0.92 0-1.667 0.747-1.667 1.667s0.747 1.667 1.667 1.667 1.667-0.747 1.667-1.667-0.747-1.667-1.667-1.667zM29.333 16c0 7.36-5.973 13.333-13.333 13.333s-13.333-5.973-13.333-13.333 5.973-13.333 13.333-13.333 13.333 5.973 13.333 13.333zM14.213 5.493c1.867 3.093 5.253 5.173 9.12 5.173 0.613 0 1.213-0.067 1.787-0.16-1.867-3.093-5.253-5.173-9.12-5.173-0.613 0-1.213 0.067-1.787 0.16zM5.893 12.627c2.28-1.293 4.040-3.4 4.88-5.92-2.28 1.293-4.040 3.4-4.88 5.92zM26.667 16c0-1.040-0.16-2.040-0.44-2.987-0.933 0.2-1.893 0.32-2.893 0.32-4.173 0-7.893-1.92-10.347-4.92-1.4 3.413-4.187 6.093-7.653 7.4 0.013 0.053 0 0.12 0 0.187 0 5.88 4.787 10.667 10.667 10.667s10.667-4.787 10.667-10.667z"></path>
</symbol>`,sh=`<symbol id="iconSaving" viewBox="0 0 32 32">
<path d="M20 13.333c0-0.733 0.6-1.333 1.333-1.333s1.333 0.6 1.333 1.333c0 0.733-0.6 1.333-1.333 1.333s-1.333-0.6-1.333-1.333zM10.667 12h6.667v-2.667h-6.667v2.667zM29.333 10v9.293l-3.76 1.253-2.24 7.453h-7.333v-2.667h-2.667v2.667h-7.333c0 0-3.333-11.28-3.333-15.333s3.28-7.333 7.333-7.333h6.667c1.213-1.613 3.147-2.667 5.333-2.667 1.107 0 2 0.893 2 2 0 0.28-0.053 0.533-0.16 0.773-0.187 0.453-0.347 0.973-0.427 1.533l3.027 3.027h2.893zM26.667 12.667h-1.333l-4.667-4.667c0-0.867 0.12-1.72 0.347-2.547-1.293 0.333-2.347 1.293-2.787 2.547h-8.227c-2.573 0-4.667 2.093-4.667 4.667 0 2.507 1.627 8.867 2.68 12.667h2.653v-2.667h8v2.667h2.68l2.067-6.867 3.253-1.093v-4.707z"></path>
</symbol>`;class ih extends wt.Plugin{constructor(t){super(t);Ee(this,"_isMobile");Ee(this,"_settingStorage");Ee(this,"_openai");Ee(this,"_claude");this._settingStorage=new rf(this,Kr),this._isMobile=wt.getFrontend()==="mobile"||wt.getFrontend()==="browser-mobile"}async onload(){console.log("onload...."),this._settingStorage.load().then(()=>{const t=this._settingStorage.getValue("apiKey");this._openai=new L({baseURL:`${Ri}/v1`,apiKey:t,dangerouslyAllowBrowser:!0}),this._claude=new H({baseURL:`${Ri}/claude`,apiKey:t,dangerouslyAllowBrowser:!0})}),this.addIcons(rh),this.addIcons(sh),this.addCommand({langKey:"getSelectedText",hotkey:"K",callback:()=>Wd(this._settingStorage,this._openai,this._claude)}),console.log("onload....end")}onLayoutReady(){}uninstall(){this.removeData(Kr),Il("AI")}openSetting(){if(!this._settingStorage)return;if(this._isMobile){fa("");return}let t=new wt.Dialog({title:"AI",width:"70%",height:"60%",content:'<div class="b3-dialog__content" id="AISettingPanel" ></div>'});new nh({target:t.element.querySelector("#AISettingPanel"),props:{settingStorage:this._settingStorage,dialog:t}})}}module.exports=ih;
