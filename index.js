"use strict";var Bl=Object.defineProperty;var Ll=(n,e,t)=>e in n?Bl(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Re=(n,e,t)=>Ll(n,typeof e!="symbol"?e+"":e,t);const Rt=require("siyuan");async function ma(n,e){let t=await Rt.fetchSyncPost(n,e);return t.code===0?t.data:null}async function pa(n,e=7e3){return ma("/api/notification/pushMsg",{msg:n,timeout:e})}async function $l(n,e=7e3){return ma("/api/notification/pushErrMsg",{msg:n,timeout:e})}function ue(){}const ga=n=>n;function Un(n,e){for(const t in e)n[t]=e[t];return n}function _a(n){return n()}function ri(){return Object.create(null)}function re(n){n.forEach(_a)}function ds(n){return typeof n=="function"}function Le(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let wn;function Dl(n,e){return n===e?!0:(wn||(wn=document.createElement("a")),wn.href=e,n===wn.href)}function jl(n){return Object.keys(n).length===0}function hs(n,e,t,r){if(n){const s=ya(n,e,t,r);return n[0](s)}}function ya(n,e,t,r){return n[1]&&r?Un(t.ctx.slice(),n[1](r(e))):t.ctx}function ms(n,e,t,r){if(n[2]&&r){const s=n[2](r(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const i=[],a=Math.max(e.dirty.length,s.length);for(let o=0;o<a;o+=1)i[o]=e.dirty[o]|s[o];return i}return e.dirty|s}return e.dirty}function ps(n,e,t,r,s,i){if(s){const a=ya(e,t,r,i);n.p(a,s)}}function gs(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let r=0;r<t;r++)e[r]=-1;return e}return-1}function si(n){const e={};for(const t in n)t[0]!=="$"&&(e[t]=n[t]);return e}const Ul=["",!0,1,"true","contenteditable"],wa=typeof window<"u";let ql=wa?()=>window.performance.now():()=>Date.now(),_s=wa?n=>requestAnimationFrame(n):ue;const Pt=new Set;function ba(n){Pt.forEach(e=>{e.c(n)||(Pt.delete(e),e.f())}),Pt.size!==0&&_s(ba)}function Hl(n){let e;return Pt.size===0&&_s(ba),{promise:new Promise(t=>{Pt.add(e={c:n,f:t})}),abort(){Pt.delete(e)}}}function y(n,e){n.appendChild(e)}function Sa(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function Wl(n){const e=C("style");return e.textContent="/* empty */",Jl(Sa(n),e),e.sheet}function Jl(n,e){return y(n.head||n,e),e.sheet}function J(n,e,t){n.insertBefore(e,t||null)}function q(n){n.parentNode&&n.parentNode.removeChild(n)}function Ea(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function C(n){return document.createElement(n)}function ie(n){return document.createTextNode(n)}function O(){return ie(" ")}function ys(){return ie("")}function D(n,e,t,r){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}function A(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}const Vl=["width","height"];function ii(n,e){const t=Object.getOwnPropertyDescriptors(n.__proto__);for(const r in e)e[r]==null?n.removeAttribute(r):r==="style"?n.style.cssText=e[r]:r==="__value"?n.value=n[r]=e[r]:t[r]&&t[r].set&&Vl.indexOf(r)===-1?n[r]=e[r]:A(n,r,e[r])}function jr(n){return n===""?null:+n}function Xl(n){return Array.from(n.childNodes)}function Oe(n,e){e=""+e,n.data!==e&&(n.data=e)}function zl(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function Kl(n,e,t){~Ul.indexOf(t)?zl(n,e):Oe(n,e)}function ne(n,e){n.value=e??""}function x(n,e,t,r){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,"")}function ai(n,e,t){for(let r=0;r<n.options.length;r+=1){const s=n.options[r];if(s.__value===e){s.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function Gl(n){const e=n.querySelector(":checked");return e&&e.__value}function G(n,e,t){n.classList.toggle(e,!!t)}function Aa(n,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:r})}const qn=new Map;let Hn=0;function Ql(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function Yl(n,e){const t={stylesheet:Wl(e),rules:{}};return qn.set(n,t),t}function oi(n,e,t,r,s,i,a,o=0){const l=16.666/r;let c=`{
`;for(let _=0;_<=1;_+=l){const k=e+(t-e)*i(_);c+=_*100+`%{${a(k,1-k)}}
`}const d=c+`100% {${a(t,1-t)}}
}`,u=`__svelte_${Ql(d)}_${o}`,h=Sa(n),{stylesheet:m,rules:f}=qn.get(h)||Yl(h,n);f[u]||(f[u]=!0,m.insertRule(`@keyframes ${u} ${d}`,m.cssRules.length));const p=n.style.animation||"";return n.style.animation=`${p?`${p}, `:""}${u} ${r}ms linear ${s}ms 1 both`,Hn+=1,u}function Zl(n,e){const t=(n.style.animation||"").split(", "),r=t.filter(e?i=>i.indexOf(e)<0:i=>i.indexOf("__svelte")===-1),s=t.length-r.length;s&&(n.style.animation=r.join(", "),Hn-=s,Hn||ec())}function ec(){_s(()=>{Hn||(qn.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&q(e)}),qn.clear())})}let an;function tn(n){an=n}function Ra(){if(!an)throw new Error("Function called outside component initialization");return an}function ws(n){Ra().$$.on_mount.push(n)}function ka(){const n=Ra();return(e,t,{cancelable:r=!1}={})=>{const s=n.$$.callbacks[e];if(s){const i=Aa(e,t,{cancelable:r});return s.slice().forEach(a=>{a.call(n,i)}),!i.defaultPrevented}return!0}}function tc(n,e){const t=n.$$.callbacks[e.type];t&&t.slice().forEach(r=>r.call(this,e))}const wt=[],Mt=[];let Ct=[];const Ur=[],nc=Promise.resolve();let qr=!1;function rc(){qr||(qr=!0,nc.then(Ca))}function We(n){Ct.push(n)}function Pa(n){Ur.push(n)}const gr=new Set;let pt=0;function Ca(){if(pt!==0)return;const n=an;do{try{for(;pt<wt.length;){const e=wt[pt];pt++,tn(e),sc(e.$$)}}catch(e){throw wt.length=0,pt=0,e}for(tn(null),wt.length=0,pt=0;Mt.length;)Mt.pop()();for(let e=0;e<Ct.length;e+=1){const t=Ct[e];gr.has(t)||(gr.add(t),t())}Ct.length=0}while(wt.length);for(;Ur.length;)Ur.pop()();qr=!1,gr.clear(),tn(n)}function sc(n){if(n.fragment!==null){n.update(),re(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(We)}}function ic(n){const e=[],t=[];Ct.forEach(r=>n.indexOf(r)===-1?e.push(r):t.push(r)),t.forEach(r=>r()),Ct=e}let qt;function ac(){return qt||(qt=Promise.resolve(),qt.then(()=>{qt=null})),qt}function _r(n,e,t){n.dispatchEvent(Aa(`${e?"intro":"outro"}${t}`))}const Tn=new Set;let He;function ct(){He={r:0,c:[],p:He}}function ut(){He.r||re(He.c),He=He.p}function j(n,e){n&&n.i&&(Tn.delete(n),n.i(e))}function W(n,e,t,r){if(n&&n.o){if(Tn.has(n))return;Tn.add(n),He.c.push(()=>{Tn.delete(n),r&&(t&&n.d(1),r())}),n.o(e)}else r&&r()}const oc={duration:0};function Ke(n,e,t,r){let i=e(n,t,{direction:"both"}),a=r?0:1,o=null,l=null,c=null,d;function u(){c&&Zl(n,c)}function h(f,p){const _=f.b-a;return p*=Math.abs(_),{a,b:f.b,d:_,duration:p,start:f.start,end:f.start+p,group:f.group}}function m(f){const{delay:p=0,duration:_=300,easing:k=ga,tick:g=ue,css:E}=i||oc,b={start:ql()+p,b:f};f||(b.group=He,He.r+=1),"inert"in n&&(f?d!==void 0&&(n.inert=d):(d=n.inert,n.inert=!0)),o||l?l=b:(E&&(u(),c=oi(n,a,f,_,p,k,E)),f&&g(0,1),o=h(b,_),We(()=>_r(n,f,"start")),Hl(R=>{if(l&&R>l.start&&(o=h(l,_),l=null,_r(n,o.b,"start"),E&&(u(),c=oi(n,a,o.b,o.duration,0,k,i.css))),o){if(R>=o.end)g(a=o.b,1-a),_r(n,o.b,"end"),l||(o.b?u():--o.group.r||re(o.group.c)),o=null;else if(R>=o.start){const P=R-o.start;a=o.a+o.d*k(P/o.duration),g(a,1-a)}}return!!(o||l)}))}return{run(f){ds(i)?ac().then(()=>{i=i({direction:f?"in":"out"}),m(f)}):m(f)},end(){u(),o=l=null}}}function Ge(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function xa(n,e){W(n,1,1,()=>{e.delete(n.key)})}function va(n,e,t,r,s,i,a,o,l,c,d,u){let h=n.length,m=i.length,f=h;const p={};for(;f--;)p[n[f].key]=f;const _=[],k=new Map,g=new Map,E=[];for(f=m;f--;){const S=u(s,i,f),M=t(S);let I=a.get(M);I?E.push(()=>I.p(S,e)):(I=c(M,S),I.c()),k.set(M,_[f]=I),M in p&&g.set(M,Math.abs(f-p[M]))}const b=new Set,R=new Set;function P(S){j(S,1),S.m(o,d),a.set(S.key,S),d=S.first,m--}for(;h&&m;){const S=_[m-1],M=n[h-1],I=S.key,N=M.key;S===M?(d=S.first,h--,m--):k.has(N)?!a.has(I)||b.has(I)?P(S):R.has(N)?h--:g.get(I)>g.get(N)?(R.add(I),P(S)):(b.add(N),h--):(l(M,a),h--)}for(;h--;){const S=n[h];k.has(S.key)||l(S,a)}for(;m;)P(_[m-1]);return re(E),_}function lc(n,e){const t={},r={},s={$$scope:1};let i=n.length;for(;i--;){const a=n[i],o=e[i];if(o){for(const l in a)l in o||(r[l]=1);for(const l in o)s[l]||(t[l]=o[l],s[l]=1);n[i]=o}else for(const l in a)s[l]=1}for(const a in r)a in t||(t[a]=void 0);return t}function Oa(n,e,t){const r=n.$$.props[e];r!==void 0&&(n.$$.bound[r]=t,t(n.$$.ctx[r]))}function Ce(n){n&&n.c()}function Se(n,e,t){const{fragment:r,after_update:s}=n.$$;r&&r.m(e,t),We(()=>{const i=n.$$.on_mount.map(_a).filter(ds);n.$$.on_destroy?n.$$.on_destroy.push(...i):re(i),n.$$.on_mount=[]}),s.forEach(We)}function Ee(n,e){const t=n.$$;t.fragment!==null&&(ic(t.after_update),re(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function cc(n,e){n.$$.dirty[0]===-1&&(wt.push(n),rc(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function $e(n,e,t,r,s,i,a=null,o=[-1]){const l=an;tn(n);const c=n.$$={fragment:null,ctx:[],props:i,update:ue,not_equal:s,bound:ri(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:ri(),dirty:o,skip_bound:!1,root:e.target||l.$$.root};a&&a(c.root);let d=!1;if(c.ctx=t?t(n,e.props||{},(u,h,...m)=>{const f=m.length?m[0]:h;return c.ctx&&s(c.ctx[u],c.ctx[u]=f)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](f),d&&cc(n,u)),h}):[],c.update(),d=!0,re(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){const u=Xl(e.target);c.fragment&&c.fragment.l(u),u.forEach(q)}else c.fragment&&c.fragment.c();e.intro&&j(n.$$.fragment),Se(n,e.target,e.anchor),Ca()}tn(l)}class De{constructor(){Re(this,"$$");Re(this,"$$set")}$destroy(){Ee(this,1),this.$destroy=ue}$on(e,t){if(!ds(t))return ue;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!jl(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const uc="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(uc);function Qe(n,{delay:e=0,duration:t=400,easing:r=ga}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:r,css:i=>`opacity: ${i*s}`}}function fc(){const n=window.getSelection();return n?n.toString():""}function dc(){let n="",e="";return n=document.getElementsByClassName("protyle-title__input")[0].textContent,document.querySelectorAll("[data-node-index]").forEach(r=>{e+=r.textContent+`
`}),{title:n,content:e}}function li(n,e,t){const r=n.slice();return r[0]=e[t][0],r[18]=e[t][1],r}function hc(n){let e,t,r,s,i,a,o;return{c(){e=C("div"),t=C("input"),A(t,"id","fontSize"),A(t,"min",r=n[5].min),A(t,"max",s=n[5].max),A(t,"step",i=n[5].step),A(t,"type","range"),A(t,"style",n[8]),G(t,"b3-slider",!0),G(t,"fn__size200",n[7]),A(e,"class","b3-tooltips b3-tooltips__n"),A(e,"aria-label",n[0])},m(l,c){J(l,e,c),y(e,t),ne(t,n[0]),a||(o=[D(t,"change",n[16]),D(t,"input",n[16]),D(t,"change",n[10])],a=!0)},p(l,c){c&32&&r!==(r=l[5].min)&&A(t,"min",r),c&32&&s!==(s=l[5].max)&&A(t,"max",s),c&32&&i!==(i=l[5].step)&&A(t,"step",i),c&256&&A(t,"style",l[8]),c&17&&ne(t,l[0]),c&128&&G(t,"fn__size200",l[7]),c&17&&A(e,"aria-label",l[0])},d(l){l&&q(e),a=!1,re(o)}}}function mc(n){let e,t,r,s=Ge(Object.entries(n[4])),i=[];for(let a=0;a<s.length;a+=1)i[a]=ci(li(n,s,a));return{c(){e=C("select");for(let a=0;a<i.length;a+=1)i[a].c();A(e,"id","iconPosition"),A(e,"style",n[8]),n[0]===void 0&&We(()=>n[15].call(e)),G(e,"b3-select",!0),G(e,"fn__flex-center",!0),G(e,"fn__size200",n[7])},m(a,o){J(a,e,o);for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(e,null);ai(e,n[0],!0),t||(r=[D(e,"change",n[15]),D(e,"change",n[10])],t=!0)},p(a,o){if(o&16){s=Ge(Object.entries(a[4]));let l;for(l=0;l<s.length;l+=1){const c=li(a,s,l);i[l]?i[l].p(c,o):(i[l]=ci(c),i[l].c(),i[l].m(e,null))}for(;l<i.length;l+=1)i[l].d(1);i.length=s.length}o&256&&A(e,"style",a[8]),o&17&&ai(e,a[0]),o&128&&G(e,"fn__size200",a[7])},d(a){a&&q(e),Ea(i,a),t=!1,re(r)}}}function pc(n){let e,t=n[6].label+"",r,s,i;return{c(){e=C("button"),r=ie(t),A(e,"id",n[2]),A(e,"style",n[8]),G(e,"b3-button",!0),G(e,"b3-button--outline",!0),G(e,"fn__flex-center",!0),G(e,"fn__size200",n[7])},m(a,o){J(a,e,o),y(e,r),s||(i=D(e,"click",n[9]),s=!0)},p(a,o){o&64&&t!==(t=a[6].label+"")&&Oe(r,t),o&4&&A(e,"id",a[2]),o&256&&A(e,"style",a[8]),o&128&&G(e,"fn__size200",a[7])},d(a){a&&q(e),s=!1,i()}}}function gc(n){let e,t,r;return{c(){e=C("input"),A(e,"id",n[2]),A(e,"type","number"),A(e,"style",n[8]),G(e,"b3-text-field",!0),G(e,"fn__flex-center",!0),G(e,"fn__size200",n[7])},m(s,i){J(s,e,i),ne(e,n[0]),t||(r=[D(e,"input",n[14]),D(e,"change",n[10])],t=!0)},p(s,i){i&4&&A(e,"id",s[2]),i&256&&A(e,"style",s[8]),i&17&&jr(e.value)!==s[0]&&ne(e,s[0]),i&128&&G(e,"fn__size200",s[7])},d(s){s&&q(e),t=!1,re(r)}}}function _c(n){let e,t,r,s;return{c(){e=C("textarea"),A(e,"class","b3-text-field fn__block"),A(e,"style",t=`resize: vertical; height: 10em; white-space: nowrap; ${n[8]}`)},m(i,a){J(i,e,a),ne(e,n[0]),r||(s=[D(e,"input",n[13]),D(e,"change",n[10])],r=!0)},p(i,a){a&256&&t!==(t=`resize: vertical; height: 10em; white-space: nowrap; ${i[8]}`)&&A(e,"style",t),a&17&&ne(e,i[0])},d(i){i&&q(e),r=!1,re(s)}}}function yc(n){let e,t,r;return{c(){e=C("input"),A(e,"id",n[2]),A(e,"placeholder",n[3]),A(e,"style",n[8]),G(e,"b3-text-field",!0),G(e,"fn__flex-center",!0),G(e,"fn__size200",n[7])},m(s,i){J(s,e,i),ne(e,n[0]),t||(r=[D(e,"input",n[12]),D(e,"change",n[10])],t=!0)},p(s,i){i&4&&A(e,"id",s[2]),i&8&&A(e,"placeholder",s[3]),i&256&&A(e,"style",s[8]),i&17&&e.value!==s[0]&&ne(e,s[0]),i&128&&G(e,"fn__size200",s[7])},d(s){s&&q(e),t=!1,re(r)}}}function wc(n){let e,t,r;return{c(){e=C("input"),A(e,"class","b3-switch fn__flex-center"),A(e,"id",n[2]),A(e,"type","checkbox"),A(e,"style",n[8])},m(s,i){J(s,e,i),e.checked=n[0],t||(r=[D(e,"change",n[11]),D(e,"change",n[10])],t=!0)},p(s,i){i&4&&A(e,"id",s[2]),i&256&&A(e,"style",s[8]),i&17&&(e.checked=s[0])},d(s){s&&q(e),t=!1,re(r)}}}function ci(n){let e,t=n[18]+"",r,s;return{c(){e=C("option"),r=ie(t),e.__value=s=n[0],ne(e,e.__value)},m(i,a){J(i,e,a),y(e,r)},p(i,a){a&16&&t!==(t=i[18]+"")&&Oe(r,t),a&16&&s!==(s=i[0])&&(e.__value=s,ne(e,e.__value))},d(i){i&&q(e)}}}function bc(n){let e;function t(i,a){if(i[1]==="checkbox")return wc;if(i[1]==="textinput")return yc;if(i[1]==="textarea")return _c;if(i[1]==="number")return gc;if(i[1]==="button")return pc;if(i[1]==="select")return mc;if(i[1]=="slider")return hc}let r=t(n),s=r&&r(n);return{c(){s&&s.c(),e=ys()},m(i,a){s&&s.m(i,a),J(i,e,a)},p(i,[a]){r===(r=t(i))&&s?s.p(i,a):(s&&s.d(1),s=r&&r(i),s&&(s.c(),s.m(e.parentNode,e)))},i:ue,o:ue,d(i){i&&q(e),s&&s.d(i)}}}function Sc(n,e,t){let{type:r}=e,{key:s}=e,{value:i}=e,{placeholder:a=""}=e,{options:o={}}=e,{slider:l={min:0,max:100,step:1}}=e,{button:c={label:i,callback:()=>{}}}=e,{fnSize:d=!0}=e,{style:u=""}=e;const h=ka();function m(){c==null||c.callback(),h("click",{key:s})}function f(){h("changed",{key:s,value:i})}function p(){i=this.checked,t(0,i),t(4,o)}function _(){i=this.value,t(0,i),t(4,o)}function k(){i=this.value,t(0,i),t(4,o)}function g(){i=jr(this.value),t(0,i),t(4,o)}function E(){i=Gl(this),t(0,i),t(4,o)}function b(){i=jr(this.value),t(0,i),t(4,o)}return n.$$set=R=>{"type"in R&&t(1,r=R.type),"key"in R&&t(2,s=R.key),"value"in R&&t(0,i=R.value),"placeholder"in R&&t(3,a=R.placeholder),"options"in R&&t(4,o=R.options),"slider"in R&&t(5,l=R.slider),"button"in R&&t(6,c=R.button),"fnSize"in R&&t(7,d=R.fnSize),"style"in R&&t(8,u=R.style)},[i,r,s,a,o,l,c,d,u,m,f,p,_,k,g,E,b]}class Ta extends De{constructor(e){super(),$e(this,e,Sc,bc,Le,{type:1,key:2,value:0,placeholder:3,options:4,slider:5,button:6,fnSize:7,style:8})}}function Ec(n){let e,t,r,s,i,a,o,l,c,d;const u=n[4].default,h=hs(u,n,n[3],null);return{c(){e=C("div"),t=C("div"),r=C("span"),s=ie(n[0]),i=O(),a=C("div"),o=O(),l=C("span"),c=O(),h&&h.c(),A(r,"class","title svelte-ikiu6h"),A(a,"class","b3-label__text"),A(t,"class","fn__flex-1"),A(l,"class","fn__space"),A(e,"class","item-wrap fn__flex b3-label config__item svelte-ikiu6h")},m(m,f){J(m,e,f),y(e,t),y(t,r),y(r,s),y(t,i),y(t,a),a.innerHTML=n[1],y(e,o),y(e,l),y(e,c),h&&h.m(e,null),d=!0},p(m,f){(!d||f&1)&&Oe(s,m[0]),(!d||f&2)&&(a.innerHTML=m[1]),h&&h.p&&(!d||f&8)&&ps(h,u,m,m[3],d?ms(u,m[3],f,null):gs(m[3]),null)},i(m){d||(j(h,m),d=!0)},o(m){W(h,m),d=!1},d(m){m&&q(e),h&&h.d(m)}}}function Ac(n){let e,t,r,s,i,a,o,l,c,d,u;const h=n[4].default,m=hs(h,n,n[3],null);return{c(){e=C("div"),t=C("div"),r=C("span"),s=ie(n[0]),i=O(),a=C("div"),o=O(),l=C("div"),c=O(),d=C("div"),m&&m.c(),A(r,"class","title svelte-ikiu6h"),A(a,"class","b3-label__text"),A(l,"class","fn__hr"),x(d,"display","flex"),x(d,"flex-direction","column"),x(d,"gap","5px"),x(d,"position","relative"),A(t,"class","fn__block"),A(e,"class","item-wrap b3-label svelte-ikiu6h"),A(e,"data-key","CustomCSS")},m(f,p){J(f,e,p),y(e,t),y(t,r),y(r,s),y(t,i),y(t,a),a.innerHTML=n[1],y(t,o),y(t,l),y(t,c),y(t,d),m&&m.m(d,null),u=!0},p(f,p){(!u||p&1)&&Oe(s,f[0]),(!u||p&2)&&(a.innerHTML=f[1]),m&&m.p&&(!u||p&8)&&ps(m,h,f,f[3],u?ms(h,f[3],p,null):gs(f[3]),null)},i(f){u||(j(m,f),u=!0)},o(f){W(m,f),u=!1},d(f){f&&q(e),m&&m.d(f)}}}function Rc(n){let e,t,r,s;const i=[Ac,Ec],a=[];function o(l,c){return l[2]==="row"?0:1}return e=o(n),t=a[e]=i[e](n),{c(){t.c(),r=ys()},m(l,c){a[e].m(l,c),J(l,r,c),s=!0},p(l,[c]){let d=e;e=o(l),e===d?a[e].p(l,c):(ct(),W(a[d],1,1,()=>{a[d]=null}),ut(),t=a[e],t?t.p(l,c):(t=a[e]=i[e](l),t.c()),j(t,1),t.m(r.parentNode,r))},i(l){s||(j(t),s=!0)},o(l){W(t),s=!1},d(l){l&&q(r),a[e].d(l)}}}function kc(n,e,t){let{$$slots:r={},$$scope:s}=e,{title:i}=e,{description:a}=e,{direction:o="column"}=e;return n.$$set=l=>{"title"in l&&t(0,i=l.title),"description"in l&&t(1,a=l.description),"direction"in l&&t(2,o=l.direction),"$$scope"in l&&t(3,s=l.$$scope)},[i,a,o,s,r]}class Pc extends De{constructor(e){super(),$e(this,e,kc,Rc,Le,{title:0,description:1,direction:2})}}const Ma={Wrap:Pc,Input:Ta};function Ia(n,e){return function(){return n.apply(e,arguments)}}const{toString:Cc}=Object.prototype,{getPrototypeOf:bs}=Object,Yn=(n=>e=>{const t=Cc.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Te=n=>(n=n.toLowerCase(),e=>Yn(e)===n),Zn=n=>e=>typeof e===n,{isArray:Ft}=Array,on=Zn("undefined");function xc(n){return n!==null&&!on(n)&&n.constructor!==null&&!on(n.constructor)&&ye(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const Fa=Te("ArrayBuffer");function vc(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&Fa(n.buffer),e}const Oc=Zn("string"),ye=Zn("function"),Na=Zn("number"),er=n=>n!==null&&typeof n=="object",Tc=n=>n===!0||n===!1,Mn=n=>{if(Yn(n)!=="object")return!1;const e=bs(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Mc=Te("Date"),Ic=Te("File"),Fc=Te("Blob"),Nc=Te("FileList"),Bc=n=>er(n)&&ye(n.pipe),Lc=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||ye(n.append)&&((e=Yn(n))==="formdata"||e==="object"&&ye(n.toString)&&n.toString()==="[object FormData]"))},$c=Te("URLSearchParams"),[Dc,jc,Uc,qc]=["ReadableStream","Request","Response","Headers"].map(Te),Hc=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function fn(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,s;if(typeof n!="object"&&(n=[n]),Ft(n))for(r=0,s=n.length;r<s;r++)e.call(null,n[r],r,n);else{const i=t?Object.getOwnPropertyNames(n):Object.keys(n),a=i.length;let o;for(r=0;r<a;r++)o=i[r],e.call(null,n[o],o,n)}}function Ba(n,e){e=e.toLowerCase();const t=Object.keys(n);let r=t.length,s;for(;r-- >0;)if(s=t[r],e===s.toLowerCase())return s;return null}const st=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,La=n=>!on(n)&&n!==st;function Hr(){const{caseless:n}=La(this)&&this||{},e={},t=(r,s)=>{const i=n&&Ba(e,s)||s;Mn(e[i])&&Mn(r)?e[i]=Hr(e[i],r):Mn(r)?e[i]=Hr({},r):Ft(r)?e[i]=r.slice():e[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&fn(arguments[r],t);return e}const Wc=(n,e,t,{allOwnKeys:r}={})=>(fn(e,(s,i)=>{t&&ye(s)?n[i]=Ia(s,t):n[i]=s},{allOwnKeys:r}),n),Jc=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),Vc=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},Xc=(n,e,t,r)=>{let s,i,a;const o={};if(e=e||{},n==null)return e;do{for(s=Object.getOwnPropertyNames(n),i=s.length;i-- >0;)a=s[i],(!r||r(a,n,e))&&!o[a]&&(e[a]=n[a],o[a]=!0);n=t!==!1&&bs(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},zc=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},Kc=n=>{if(!n)return null;if(Ft(n))return n;let e=n.length;if(!Na(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},Gc=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&bs(Uint8Array)),Qc=(n,e)=>{const r=(n&&n[Symbol.iterator]).call(n);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(n,i[0],i[1])}},Yc=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},Zc=Te("HTMLFormElement"),eu=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,s){return r.toUpperCase()+s}),ui=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),tu=Te("RegExp"),$a=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};fn(t,(s,i)=>{let a;(a=e(s,i,n))!==!1&&(r[i]=a||s)}),Object.defineProperties(n,r)},nu=n=>{$a(n,(e,t)=>{if(ye(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(ye(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},ru=(n,e)=>{const t={},r=s=>{s.forEach(i=>{t[i]=!0})};return Ft(n)?r(n):r(String(n).split(e)),t},su=()=>{},iu=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e,yr="abcdefghijklmnopqrstuvwxyz",fi="0123456789",Da={DIGIT:fi,ALPHA:yr,ALPHA_DIGIT:yr+yr.toUpperCase()+fi},au=(n=16,e=Da.ALPHA_DIGIT)=>{let t="";const{length:r}=e;for(;n--;)t+=e[Math.random()*r|0];return t};function ou(n){return!!(n&&ye(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator])}const lu=n=>{const e=new Array(10),t=(r,s)=>{if(er(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const i=Ft(r)?[]:{};return fn(r,(a,o)=>{const l=t(a,s+1);!on(l)&&(i[o]=l)}),e[s]=void 0,i}}return r};return t(n,0)},cu=Te("AsyncFunction"),uu=n=>n&&(er(n)||ye(n))&&ye(n.then)&&ye(n.catch),ja=((n,e)=>n?setImmediate:e?((t,r)=>(st.addEventListener("message",({source:s,data:i})=>{s===st&&i===t&&r.length&&r.shift()()},!1),s=>{r.push(s),st.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",ye(st.postMessage)),fu=typeof queueMicrotask<"u"?queueMicrotask.bind(st):typeof process<"u"&&process.nextTick||ja,w={isArray:Ft,isArrayBuffer:Fa,isBuffer:xc,isFormData:Lc,isArrayBufferView:vc,isString:Oc,isNumber:Na,isBoolean:Tc,isObject:er,isPlainObject:Mn,isReadableStream:Dc,isRequest:jc,isResponse:Uc,isHeaders:qc,isUndefined:on,isDate:Mc,isFile:Ic,isBlob:Fc,isRegExp:tu,isFunction:ye,isStream:Bc,isURLSearchParams:$c,isTypedArray:Gc,isFileList:Nc,forEach:fn,merge:Hr,extend:Wc,trim:Hc,stripBOM:Jc,inherits:Vc,toFlatObject:Xc,kindOf:Yn,kindOfTest:Te,endsWith:zc,toArray:Kc,forEachEntry:Qc,matchAll:Yc,isHTMLForm:Zc,hasOwnProperty:ui,hasOwnProp:ui,reduceDescriptors:$a,freezeMethods:nu,toObjectSet:ru,toCamelCase:eu,noop:su,toFiniteNumber:iu,findKey:Ba,global:st,isContextDefined:La,ALPHABET:Da,generateString:au,isSpecCompliantForm:ou,toJSONObject:lu,isAsyncFn:cu,isThenable:uu,setImmediate:ja,asap:fu};function F(n,e,t,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}w.inherits(F,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:w.toJSONObject(this.config),code:this.code,status:this.status}}});const Ua=F.prototype,qa={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{qa[n]={value:n}});Object.defineProperties(F,qa);Object.defineProperty(Ua,"isAxiosError",{value:!0});F.from=(n,e,t,r,s,i)=>{const a=Object.create(Ua);return w.toFlatObject(n,a,function(l){return l!==Error.prototype},o=>o!=="isAxiosError"),F.call(a,n.message,e,t,r,s),a.cause=n,a.name=n.name,i&&Object.assign(a,i),a};const du=null;function Wr(n){return w.isPlainObject(n)||w.isArray(n)}function Ha(n){return w.endsWith(n,"[]")?n.slice(0,-2):n}function di(n,e,t){return n?n.concat(e).map(function(s,i){return s=Ha(s),!t&&i?"["+s+"]":s}).join(t?".":""):e}function hu(n){return w.isArray(n)&&!n.some(Wr)}const mu=w.toFlatObject(w,{},null,function(e){return/^is[A-Z]/.test(e)});function tr(n,e,t){if(!w.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=w.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,_){return!w.isUndefined(_[p])});const r=t.metaTokens,s=t.visitor||d,i=t.dots,a=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&w.isSpecCompliantForm(e);if(!w.isFunction(s))throw new TypeError("visitor must be a function");function c(f){if(f===null)return"";if(w.isDate(f))return f.toISOString();if(!l&&w.isBlob(f))throw new F("Blob is not supported. Use a Buffer instead.");return w.isArrayBuffer(f)||w.isTypedArray(f)?l&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function d(f,p,_){let k=f;if(f&&!_&&typeof f=="object"){if(w.endsWith(p,"{}"))p=r?p:p.slice(0,-2),f=JSON.stringify(f);else if(w.isArray(f)&&hu(f)||(w.isFileList(f)||w.endsWith(p,"[]"))&&(k=w.toArray(f)))return p=Ha(p),k.forEach(function(E,b){!(w.isUndefined(E)||E===null)&&e.append(a===!0?di([p],b,i):a===null?p:p+"[]",c(E))}),!1}return Wr(f)?!0:(e.append(di(_,p,i),c(f)),!1)}const u=[],h=Object.assign(mu,{defaultVisitor:d,convertValue:c,isVisitable:Wr});function m(f,p){if(!w.isUndefined(f)){if(u.indexOf(f)!==-1)throw Error("Circular reference detected in "+p.join("."));u.push(f),w.forEach(f,function(k,g){(!(w.isUndefined(k)||k===null)&&s.call(e,k,w.isString(g)?g.trim():g,p,h))===!0&&m(k,p?p.concat(g):[g])}),u.pop()}}if(!w.isObject(n))throw new TypeError("data must be an object");return m(n),e}function hi(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function Ss(n,e){this._pairs=[],n&&tr(n,this,e)}const Wa=Ss.prototype;Wa.append=function(e,t){this._pairs.push([e,t])};Wa.toString=function(e){const t=e?function(r){return e.call(this,r,hi)}:hi;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function pu(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ja(n,e,t){if(!e)return n;const r=t&&t.encode||pu;w.isFunction(t)&&(t={serialize:t});const s=t&&t.serialize;let i;if(s?i=s(e,t):i=w.isURLSearchParams(e)?e.toString():new Ss(e,t).toString(r),i){const a=n.indexOf("#");a!==-1&&(n=n.slice(0,a)),n+=(n.indexOf("?")===-1?"?":"&")+i}return n}class mi{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){w.forEach(this.handlers,function(r){r!==null&&e(r)})}}const Va={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},gu=typeof URLSearchParams<"u"?URLSearchParams:Ss,_u=typeof FormData<"u"?FormData:null,yu=typeof Blob<"u"?Blob:null,wu={isBrowser:!0,classes:{URLSearchParams:gu,FormData:_u,Blob:yu},protocols:["http","https","file","blob","url","data"]},Es=typeof window<"u"&&typeof document<"u",Jr=typeof navigator=="object"&&navigator||void 0,bu=Es&&(!Jr||["ReactNative","NativeScript","NS"].indexOf(Jr.product)<0),Su=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Eu=Es&&window.location.href||"http://localhost",Au=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Es,hasStandardBrowserEnv:bu,hasStandardBrowserWebWorkerEnv:Su,navigator:Jr,origin:Eu},Symbol.toStringTag,{value:"Module"})),oe={...Au,...wu};function Ru(n,e){return tr(n,new oe.classes.URLSearchParams,Object.assign({visitor:function(t,r,s,i){return oe.isNode&&w.isBuffer(t)?(this.append(r,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function ku(n){return w.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Pu(n){const e={},t=Object.keys(n);let r;const s=t.length;let i;for(r=0;r<s;r++)i=t[r],e[i]=n[i];return e}function Xa(n){function e(t,r,s,i){let a=t[i++];if(a==="__proto__")return!0;const o=Number.isFinite(+a),l=i>=t.length;return a=!a&&w.isArray(s)?s.length:a,l?(w.hasOwnProp(s,a)?s[a]=[s[a],r]:s[a]=r,!o):((!s[a]||!w.isObject(s[a]))&&(s[a]=[]),e(t,r,s[a],i)&&w.isArray(s[a])&&(s[a]=Pu(s[a])),!o)}if(w.isFormData(n)&&w.isFunction(n.entries)){const t={};return w.forEachEntry(n,(r,s)=>{e(ku(r),s,t,0)}),t}return null}function Cu(n,e,t){if(w.isString(n))try{return(e||JSON.parse)(n),w.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(0,JSON.stringify)(n)}const dn={transitional:Va,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",s=r.indexOf("application/json")>-1,i=w.isObject(e);if(i&&w.isHTMLForm(e)&&(e=new FormData(e)),w.isFormData(e))return s?JSON.stringify(Xa(e)):e;if(w.isArrayBuffer(e)||w.isBuffer(e)||w.isStream(e)||w.isFile(e)||w.isBlob(e)||w.isReadableStream(e))return e;if(w.isArrayBufferView(e))return e.buffer;if(w.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Ru(e,this.formSerializer).toString();if((o=w.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return tr(o?{"files[]":e}:e,l&&new l,this.formSerializer)}}return i||s?(t.setContentType("application/json",!1),Cu(e)):e}],transformResponse:[function(e){const t=this.transitional||dn.transitional,r=t&&t.forcedJSONParsing,s=this.responseType==="json";if(w.isResponse(e)||w.isReadableStream(e))return e;if(e&&w.isString(e)&&(r&&!this.responseType||s)){const a=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(o){if(a)throw o.name==="SyntaxError"?F.from(o,F.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:oe.classes.FormData,Blob:oe.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};w.forEach(["delete","get","head","post","put","patch"],n=>{dn.headers[n]={}});const xu=w.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),vu=n=>{const e={};let t,r,s;return n&&n.split(`
`).forEach(function(a){s=a.indexOf(":"),t=a.substring(0,s).trim().toLowerCase(),r=a.substring(s+1).trim(),!(!t||e[t]&&xu[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},pi=Symbol("internals");function Ht(n){return n&&String(n).trim().toLowerCase()}function In(n){return n===!1||n==null?n:w.isArray(n)?n.map(In):String(n)}function Ou(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const Tu=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function wr(n,e,t,r,s){if(w.isFunction(r))return r.call(this,e,t);if(s&&(e=t),!!w.isString(e)){if(w.isString(r))return e.indexOf(r)!==-1;if(w.isRegExp(r))return r.test(e)}}function Mu(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function Iu(n,e){const t=w.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(s,i,a){return this[r].call(this,e,s,i,a)},configurable:!0})})}class he{constructor(e){e&&this.set(e)}set(e,t,r){const s=this;function i(o,l,c){const d=Ht(l);if(!d)throw new Error("header name must be a non-empty string");const u=w.findKey(s,d);(!u||s[u]===void 0||c===!0||c===void 0&&s[u]!==!1)&&(s[u||l]=In(o))}const a=(o,l)=>w.forEach(o,(c,d)=>i(c,d,l));if(w.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(w.isString(e)&&(e=e.trim())&&!Tu(e))a(vu(e),t);else if(w.isHeaders(e))for(const[o,l]of e.entries())i(l,o,r);else e!=null&&i(t,e,r);return this}get(e,t){if(e=Ht(e),e){const r=w.findKey(this,e);if(r){const s=this[r];if(!t)return s;if(t===!0)return Ou(s);if(w.isFunction(t))return t.call(this,s,r);if(w.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Ht(e),e){const r=w.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||wr(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let s=!1;function i(a){if(a=Ht(a),a){const o=w.findKey(r,a);o&&(!t||wr(r,r[o],o,t))&&(delete r[o],s=!0)}}return w.isArray(e)?e.forEach(i):i(e),s}clear(e){const t=Object.keys(this);let r=t.length,s=!1;for(;r--;){const i=t[r];(!e||wr(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const t=this,r={};return w.forEach(this,(s,i)=>{const a=w.findKey(r,i);if(a){t[a]=In(s),delete t[i];return}const o=e?Mu(i):String(i).trim();o!==i&&delete t[i],t[o]=In(s),r[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return w.forEach(this,(r,s)=>{r!=null&&r!==!1&&(t[s]=e&&w.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[pi]=this[pi]={accessors:{}}).accessors,s=this.prototype;function i(a){const o=Ht(a);r[o]||(Iu(s,a),r[o]=!0)}return w.isArray(e)?e.forEach(i):i(e),this}}he.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);w.reduceDescriptors(he.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});w.freezeMethods(he);function br(n,e){const t=this||dn,r=e||t,s=he.from(r.headers);let i=r.data;return w.forEach(n,function(o){i=o.call(t,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function za(n){return!!(n&&n.__CANCEL__)}function Nt(n,e,t){F.call(this,n??"canceled",F.ERR_CANCELED,e,t),this.name="CanceledError"}w.inherits(Nt,F,{__CANCEL__:!0});function Ka(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new F("Request failed with status code "+t.status,[F.ERR_BAD_REQUEST,F.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Fu(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function Nu(n,e){n=n||10;const t=new Array(n),r=new Array(n);let s=0,i=0,a;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),d=r[i];a||(a=c),t[s]=l,r[s]=c;let u=i,h=0;for(;u!==s;)h+=t[u++],u=u%n;if(s=(s+1)%n,s===i&&(i=(i+1)%n),c-a<e)return;const m=d&&c-d;return m?Math.round(h*1e3/m):void 0}}function Bu(n,e){let t=0,r=1e3/e,s,i;const a=(c,d=Date.now())=>{t=d,s=null,i&&(clearTimeout(i),i=null),n.apply(null,c)};return[(...c)=>{const d=Date.now(),u=d-t;u>=r?a(c,d):(s=c,i||(i=setTimeout(()=>{i=null,a(s)},r-u)))},()=>s&&a(s)]}const Wn=(n,e,t=3)=>{let r=0;const s=Nu(50,250);return Bu(i=>{const a=i.loaded,o=i.lengthComputable?i.total:void 0,l=a-r,c=s(l),d=a<=o;r=a;const u={loaded:a,total:o,progress:o?a/o:void 0,bytes:l,rate:c||void 0,estimated:c&&o&&d?(o-a)/c:void 0,event:i,lengthComputable:o!=null,[e?"download":"upload"]:!0};n(u)},t)},gi=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},_i=n=>(...e)=>w.asap(()=>n(...e)),Lu=oe.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,oe.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(oe.origin),oe.navigator&&/(msie|trident)/i.test(oe.navigator.userAgent)):()=>!0,$u=oe.hasStandardBrowserEnv?{write(n,e,t,r,s,i){const a=[n+"="+encodeURIComponent(e)];w.isNumber(t)&&a.push("expires="+new Date(t).toGMTString()),w.isString(r)&&a.push("path="+r),w.isString(s)&&a.push("domain="+s),i===!0&&a.push("secure"),document.cookie=a.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Du(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function ju(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function Ga(n,e){return n&&!Du(e)?ju(n,e):e}const yi=n=>n instanceof he?{...n}:n;function ft(n,e){e=e||{};const t={};function r(c,d,u,h){return w.isPlainObject(c)&&w.isPlainObject(d)?w.merge.call({caseless:h},c,d):w.isPlainObject(d)?w.merge({},d):w.isArray(d)?d.slice():d}function s(c,d,u,h){if(w.isUndefined(d)){if(!w.isUndefined(c))return r(void 0,c,u,h)}else return r(c,d,u,h)}function i(c,d){if(!w.isUndefined(d))return r(void 0,d)}function a(c,d){if(w.isUndefined(d)){if(!w.isUndefined(c))return r(void 0,c)}else return r(void 0,d)}function o(c,d,u){if(u in e)return r(c,d);if(u in n)return r(void 0,c)}const l={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(c,d,u)=>s(yi(c),yi(d),u,!0)};return w.forEach(Object.keys(Object.assign({},n,e)),function(d){const u=l[d]||s,h=u(n[d],e[d],d);w.isUndefined(h)&&u!==o||(t[d]=h)}),t}const Qa=n=>{const e=ft({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:a,auth:o}=e;e.headers=a=he.from(a),e.url=Ja(Ga(e.baseURL,e.url),n.params,n.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let l;if(w.isFormData(t)){if(oe.hasStandardBrowserEnv||oe.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((l=a.getContentType())!==!1){const[c,...d]=l?l.split(";").map(u=>u.trim()).filter(Boolean):[];a.setContentType([c||"multipart/form-data",...d].join("; "))}}if(oe.hasStandardBrowserEnv&&(r&&w.isFunction(r)&&(r=r(e)),r||r!==!1&&Lu(e.url))){const c=s&&i&&$u.read(i);c&&a.set(s,c)}return e},Uu=typeof XMLHttpRequest<"u",qu=Uu&&function(n){return new Promise(function(t,r){const s=Qa(n);let i=s.data;const a=he.from(s.headers).normalize();let{responseType:o,onUploadProgress:l,onDownloadProgress:c}=s,d,u,h,m,f;function p(){m&&m(),f&&f(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let _=new XMLHttpRequest;_.open(s.method.toUpperCase(),s.url,!0),_.timeout=s.timeout;function k(){if(!_)return;const E=he.from("getAllResponseHeaders"in _&&_.getAllResponseHeaders()),R={data:!o||o==="text"||o==="json"?_.responseText:_.response,status:_.status,statusText:_.statusText,headers:E,config:n,request:_};Ka(function(S){t(S),p()},function(S){r(S),p()},R),_=null}"onloadend"in _?_.onloadend=k:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(k)},_.onabort=function(){_&&(r(new F("Request aborted",F.ECONNABORTED,n,_)),_=null)},_.onerror=function(){r(new F("Network Error",F.ERR_NETWORK,n,_)),_=null},_.ontimeout=function(){let b=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const R=s.transitional||Va;s.timeoutErrorMessage&&(b=s.timeoutErrorMessage),r(new F(b,R.clarifyTimeoutError?F.ETIMEDOUT:F.ECONNABORTED,n,_)),_=null},i===void 0&&a.setContentType(null),"setRequestHeader"in _&&w.forEach(a.toJSON(),function(b,R){_.setRequestHeader(R,b)}),w.isUndefined(s.withCredentials)||(_.withCredentials=!!s.withCredentials),o&&o!=="json"&&(_.responseType=s.responseType),c&&([h,f]=Wn(c,!0),_.addEventListener("progress",h)),l&&_.upload&&([u,m]=Wn(l),_.upload.addEventListener("progress",u),_.upload.addEventListener("loadend",m)),(s.cancelToken||s.signal)&&(d=E=>{_&&(r(!E||E.type?new Nt(null,n,_):E),_.abort(),_=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const g=Fu(s.url);if(g&&oe.protocols.indexOf(g)===-1){r(new F("Unsupported protocol "+g+":",F.ERR_BAD_REQUEST,n));return}_.send(i||null)})},Hu=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,s;const i=function(c){if(!s){s=!0,o();const d=c instanceof Error?c:this.reason;r.abort(d instanceof F?d:new Nt(d instanceof Error?d.message:d))}};let a=e&&setTimeout(()=>{a=null,i(new F(`timeout ${e} of ms exceeded`,F.ETIMEDOUT))},e);const o=()=>{n&&(a&&clearTimeout(a),a=null,n.forEach(c=>{c.unsubscribe?c.unsubscribe(i):c.removeEventListener("abort",i)}),n=null)};n.forEach(c=>c.addEventListener("abort",i));const{signal:l}=r;return l.unsubscribe=()=>w.asap(o),l}},Wu=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,s;for(;r<t;)s=r+e,yield n.slice(r,s),r=s},Ju=async function*(n,e){for await(const t of Vu(n))yield*Wu(t,e)},Vu=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},wi=(n,e,t,r)=>{const s=Ju(n,e);let i=0,a,o=l=>{a||(a=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:c,value:d}=await s.next();if(c){o(),l.close();return}let u=d.byteLength;if(t){let h=i+=u;t(h)}l.enqueue(new Uint8Array(d))}catch(c){throw o(c),c}},cancel(l){return o(l),s.return()}},{highWaterMark:2})},nr=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Ya=nr&&typeof ReadableStream=="function",Xu=nr&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),Za=(n,...e)=>{try{return!!n(...e)}catch{return!1}},zu=Ya&&Za(()=>{let n=!1;const e=new Request(oe.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),bi=64*1024,Vr=Ya&&Za(()=>w.isReadableStream(new Response("").body)),Jn={stream:Vr&&(n=>n.body)};nr&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Jn[e]&&(Jn[e]=w.isFunction(n[e])?t=>t[e]():(t,r)=>{throw new F(`Response type '${e}' is not supported`,F.ERR_NOT_SUPPORT,r)})})})(new Response);const Ku=async n=>{if(n==null)return 0;if(w.isBlob(n))return n.size;if(w.isSpecCompliantForm(n))return(await new Request(oe.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(w.isArrayBufferView(n)||w.isArrayBuffer(n))return n.byteLength;if(w.isURLSearchParams(n)&&(n=n+""),w.isString(n))return(await Xu(n)).byteLength},Gu=async(n,e)=>{const t=w.toFiniteNumber(n.getContentLength());return t??Ku(e)},Qu=nr&&(async n=>{let{url:e,method:t,data:r,signal:s,cancelToken:i,timeout:a,onDownloadProgress:o,onUploadProgress:l,responseType:c,headers:d,withCredentials:u="same-origin",fetchOptions:h}=Qa(n);c=c?(c+"").toLowerCase():"text";let m=Hu([s,i&&i.toAbortSignal()],a),f;const p=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let _;try{if(l&&zu&&t!=="get"&&t!=="head"&&(_=await Gu(d,r))!==0){let R=new Request(e,{method:"POST",body:r,duplex:"half"}),P;if(w.isFormData(r)&&(P=R.headers.get("content-type"))&&d.setContentType(P),R.body){const[S,M]=gi(_,Wn(_i(l)));r=wi(R.body,bi,S,M)}}w.isString(u)||(u=u?"include":"omit");const k="credentials"in Request.prototype;f=new Request(e,{...h,signal:m,method:t.toUpperCase(),headers:d.normalize().toJSON(),body:r,duplex:"half",credentials:k?u:void 0});let g=await fetch(f);const E=Vr&&(c==="stream"||c==="response");if(Vr&&(o||E&&p)){const R={};["status","statusText","headers"].forEach(I=>{R[I]=g[I]});const P=w.toFiniteNumber(g.headers.get("content-length")),[S,M]=o&&gi(P,Wn(_i(o),!0))||[];g=new Response(wi(g.body,bi,S,()=>{M&&M(),p&&p()}),R)}c=c||"text";let b=await Jn[w.findKey(Jn,c)||"text"](g,n);return!E&&p&&p(),await new Promise((R,P)=>{Ka(R,P,{data:b,headers:he.from(g.headers),status:g.status,statusText:g.statusText,config:n,request:f})})}catch(k){throw p&&p(),k&&k.name==="TypeError"&&/fetch/i.test(k.message)?Object.assign(new F("Network Error",F.ERR_NETWORK,n,f),{cause:k.cause||k}):F.from(k,k&&k.code,n,f)}}),Xr={http:du,xhr:qu,fetch:Qu};w.forEach(Xr,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const Si=n=>`- ${n}`,Yu=n=>w.isFunction(n)||n===null||n===!1,eo={getAdapter:n=>{n=w.isArray(n)?n:[n];const{length:e}=n;let t,r;const s={};for(let i=0;i<e;i++){t=n[i];let a;if(r=t,!Yu(t)&&(r=Xr[(a=String(t)).toLowerCase()],r===void 0))throw new F(`Unknown adapter '${a}'`);if(r)break;s[a||"#"+i]=r}if(!r){const i=Object.entries(s).map(([o,l])=>`adapter ${o} `+(l===!1?"is not supported by the environment":"is not available in the build"));let a=e?i.length>1?`since :
`+i.map(Si).join(`
`):" "+Si(i[0]):"as no adapter specified";throw new F("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:Xr};function Sr(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new Nt(null,n)}function Ei(n){return Sr(n),n.headers=he.from(n.headers),n.data=br.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),eo.getAdapter(n.adapter||dn.adapter)(n).then(function(r){return Sr(n),r.data=br.call(n,n.transformResponse,r),r.headers=he.from(r.headers),r},function(r){return za(r)||(Sr(n),r&&r.response&&(r.response.data=br.call(n,n.transformResponse,r.response),r.response.headers=he.from(r.response.headers))),Promise.reject(r)})}const to="1.7.9",rr={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{rr[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const Ai={};rr.transitional=function(e,t,r){function s(i,a){return"[Axios v"+to+"] Transitional option '"+i+"'"+a+(r?". "+r:"")}return(i,a,o)=>{if(e===!1)throw new F(s(a," has been removed"+(t?" in "+t:"")),F.ERR_DEPRECATED);return t&&!Ai[a]&&(Ai[a]=!0,console.warn(s(a," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,a,o):!0}};rr.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function Zu(n,e,t){if(typeof n!="object")throw new F("options must be an object",F.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let s=r.length;for(;s-- >0;){const i=r[s],a=e[i];if(a){const o=n[i],l=o===void 0||a(o,i,n);if(l!==!0)throw new F("option "+i+" must be "+l,F.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new F("Unknown option "+i,F.ERR_BAD_OPTION)}}const Fn={assertOptions:Zu,validators:rr},Ie=Fn.validators;class lt{constructor(e){this.defaults=e,this.interceptors={request:new mi,response:new mi}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=ft(this.defaults,t);const{transitional:r,paramsSerializer:s,headers:i}=t;r!==void 0&&Fn.assertOptions(r,{silentJSONParsing:Ie.transitional(Ie.boolean),forcedJSONParsing:Ie.transitional(Ie.boolean),clarifyTimeoutError:Ie.transitional(Ie.boolean)},!1),s!=null&&(w.isFunction(s)?t.paramsSerializer={serialize:s}:Fn.assertOptions(s,{encode:Ie.function,serialize:Ie.function},!0)),Fn.assertOptions(t,{baseUrl:Ie.spelling("baseURL"),withXsrfToken:Ie.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=i&&w.merge(i.common,i[t.method]);i&&w.forEach(["delete","get","head","post","put","patch","common"],f=>{delete i[f]}),t.headers=he.concat(a,i);const o=[];let l=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(t)===!1||(l=l&&p.synchronous,o.unshift(p.fulfilled,p.rejected))});const c=[];this.interceptors.response.forEach(function(p){c.push(p.fulfilled,p.rejected)});let d,u=0,h;if(!l){const f=[Ei.bind(this),void 0];for(f.unshift.apply(f,o),f.push.apply(f,c),h=f.length,d=Promise.resolve(t);u<h;)d=d.then(f[u++],f[u++]);return d}h=o.length;let m=t;for(u=0;u<h;){const f=o[u++],p=o[u++];try{m=f(m)}catch(_){p.call(this,_);break}}try{d=Ei.call(this,m)}catch(f){return Promise.reject(f)}for(u=0,h=c.length;u<h;)d=d.then(c[u++],c[u++]);return d}getUri(e){e=ft(this.defaults,e);const t=Ga(e.baseURL,e.url);return Ja(t,e.params,e.paramsSerializer)}}w.forEach(["delete","get","head","options"],function(e){lt.prototype[e]=function(t,r){return this.request(ft(r||{},{method:e,url:t,data:(r||{}).data}))}});w.forEach(["post","put","patch"],function(e){function t(r){return function(i,a,o){return this.request(ft(o||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}lt.prototype[e]=t(),lt.prototype[e+"Form"]=t(!0)});class As{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(i){t=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const a=new Promise(o=>{r.subscribe(o),i=o}).then(s);return a.cancel=function(){r.unsubscribe(i)},a},e(function(i,a,o){r.reason||(r.reason=new Nt(i,a,o),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new As(function(s){e=s}),cancel:e}}}function ef(n){return function(t){return n.apply(null,t)}}function tf(n){return w.isObject(n)&&n.isAxiosError===!0}const zr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(zr).forEach(([n,e])=>{zr[e]=n});function no(n){const e=new lt(n),t=Ia(lt.prototype.request,e);return w.extend(t,lt.prototype,e,{allOwnKeys:!0}),w.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return no(ft(n,s))},t}const Y=no(dn);Y.Axios=lt;Y.CanceledError=Nt;Y.CancelToken=As;Y.isCancel=za;Y.VERSION=to;Y.toFormData=tr;Y.AxiosError=F;Y.Cancel=Y.CanceledError;Y.all=function(e){return Promise.all(e)};Y.spread=ef;Y.isAxiosError=tf;Y.mergeConfig=ft;Y.AxiosHeaders=he;Y.formToJSON=n=>Xa(w.isHTMLForm(n)?new FormData(n):n);Y.getAdapter=eo.getAdapter;Y.HttpStatusCode=zr;Y.default=Y;async function Ri(n){if(!n||n.length==0)return[0,0];const e={method:"POST",url:atob("aHR0cHM6Ly9hcGkuZ2Vla3NwaGVyZS5vbmxpbmUvYWRtaW4tYXBpL2FpZ2MvYmFsYW5jZS90b2tlbg=="),headers:{"content-type":"application/json"},data:{apikey:n.replace("sk-","")}};let t=await Y.request(e);return!t||t.status!=200?[0,0]:t.data.data}function nf(n){let e,t,r="余额查询",s,i,a,o,l,c,d,u,h=new Date(n[2]).toLocaleString()+"",m,f,p,_,k;return{c(){e=C("label"),t=C("div"),s=ie(r),i=O(),a=C("div"),o=ie("账 户 余 额 : "),l=ie(n[1]),c=ie(` ¥
            `),d=C("br"),u=ie(` 
            有 效 期 : `),m=ie(h),f=O(),p=C("button"),p.textContent="刷新",A(a,"class","b3-label__text"),A(t,"class","fn__flex-1"),A(p,"class","b3-button b3-button--outline fn__flex-center fn__size200"),A(e,"class","fn__flex b3-label")},m(g,E){J(g,e,E),y(e,t),y(t,s),y(t,i),y(t,a),y(a,o),y(a,l),y(a,c),y(a,d),y(a,u),y(a,m),y(e,f),y(e,p),_||(k=D(p,"click",n[3]),_=!0)},p(g,[E]){E&2&&Oe(l,g[1]),E&4&&h!==(h=new Date(g[2]).toLocaleString()+"")&&Oe(m,h)},i:ue,o:ue,d(g){g&&q(e),_=!1,k()}}}function rf(n,e,t){let{apiKey:r}=e,s=0,i=0;ws(()=>{Ri(r).then(o=>{t(1,s=Math.round(o.money*10)/10),t(2,i=o.expiredTime*1e3)})});const a=async()=>{Ri(r).then(o=>{t(2,i=o.expiredTime*1e3),t(1,s=Math.round(o.money*10)/10)})};return n.$$set=o=>{"apiKey"in o&&t(0,r=o.apiKey)},[r,s,i,a]}let sf=class extends De{constructor(e){super(),$e(this,e,rf,nf,Le,{apiKey:0})}};const Kr="siyuan-ai-plugin-setting",ki=atob("aHR0cHM6Ly9vbmVhcGkuZ2Vla3NwaGVyZS5vbmxpbmU=");class af{constructor(e,t){Re(this,"plugin");Re(this,"name");Re(this,"file");this.name=t,this.plugin=e}}class of extends af{constructor(t,r){super(t,r);Re(this,"settings",new Map);this.name=r??Kr,this.file=this.name.endsWith(".json")?this.name:`${this.name}.json`,this._defaultSettings()}async load(){let t=await this.plugin.loadData(this.file);if(console.debug("Load Setting Config:",t),t)for(let[r,s]of this.settings)s.value=(t==null?void 0:t[r])??s.value;return this.plugin.data[this.name]=t,t}async save(t){return t=t??this.dump(),await this.plugin.saveData(this.file,t),console.debug("Save Setting Config:",t),t}get(t){return this.settings.get(t)}getValue(t){var r;return(r=this.settings.get(t))==null?void 0:r.value}getSettingItems(t){let r=[];for(let[s,i]of this.settings)t&&i.group!==t||r.push(i);return r}set(t,r){this.settings.set(t,r)}setValue(t,r){let s=this.settings.get(t);s.value=r}dump(){let t={};for(let[r,s]of this.settings)t[r]=s.value;return t}_defaultSettings(){const t={group:"🌈 设置",title:"密钥",description:'<a href="https://item.taobao.com/item.htm?ft=t&id=877591591207&spm=a21dvs.23580594.0.0.621e2c1bjqRPCl&skuId=5719376381355">密钥购买链接</a>, 售后QQ群: 710607849',type:"textinput",key:"apiKey",value:"",placeholder:"Enter your Key"};this.settings.set(t.key,t);const r={group:"custom",title:"获取页面文本",description:"当未选中文本使用指令模式时，是否获取当前页面的全部文本作为大模型的输入。默认为 否。",type:"checkbox",key:"isPageContent",value:!1};this.settings.set(r.key,r);const s={group:"custom",title:"温度",description:"温度值越小，模型生成的内容越准确。温度值越高，模型生成内容越多样。默认为 1.0。",type:"slider",key:"temperature",slider:{min:0,max:2,step:.1},value:1};this.settings.set(s.key,s);const i={group:"custom",title:"最大长度",description:"输出文本的最大长度,默认为 4k。",type:"number",key:"maxOutputLength",value:4e3};this.settings.set(i.key,i);const a={group:"custom",title:"请求超时时间",description:"发起请求的超时时间，超过该时间，取消请求，单位：秒。默认为 90 秒。",type:"number",key:"responseTimeout",value:90};this.settings.set(a.key,a);const o={group:"model",title:"模型",description:"选择模型",type:"select",key:"modelSelections",value:"deepseek-chat",options:{"deepseek-chat":"DeepSeek Chat","qwen-turbo-latest":"Qwen Turbo","qwen-plus-latest":"Qwen Plus","qwen-max-latest":"Qwen Max","qwen-max-longcontext":"Qwen Long","gpt-4o":"GPT 4o",o1:"GPT O1","o1-mini":"GPT O1 mini","gpt-4o-mini":"GPT 4o mini","gpt-4-turbo":"GPT 4 Turbo","claude-3-5-haiku-20241022":"Claude 3.5 Haiku","claude-3-5-sonnet-latest":"Claude 3.5 Sonnet","claude-3-opus-latest":"Claude 3 Opus"}};this.settings.set(o.key,o),this.load()}}function Pi(n,e,t){const r=n.slice();return r[11]=e[t],r[12]=e,r[13]=t,r}function lf(n){var a,o,l,c;let e,t,r;function s(d){n[8](d,n[11])}let i={type:n[11].type,key:n[11].key,placeholder:(a=n[11])==null?void 0:a.placeholder,options:(o=n[11])==null?void 0:o.options,slider:(l=n[11])==null?void 0:l.slider,button:(c=n[11])==null?void 0:c.button};return n[11].value!==void 0&&(i.value=n[11].value),e=new Ma.Input({props:i}),Mt.push(()=>Oa(e,"value",s)),e.$on("click",n[4]),e.$on("changed",n[5]),{c(){Ce(e.$$.fragment)},m(d,u){Se(e,d,u),r=!0},p(d,u){var m,f,p,_;n=d;const h={};u&4&&(h.type=n[11].type),u&4&&(h.key=n[11].key),u&4&&(h.placeholder=(m=n[11])==null?void 0:m.placeholder),u&4&&(h.options=(f=n[11])==null?void 0:f.options),u&4&&(h.slider=(p=n[11])==null?void 0:p.slider),u&4&&(h.button=(_=n[11])==null?void 0:_.button),!t&&u&4&&(t=!0,h.value=n[11].value,Pa(()=>t=!1)),e.$set(h)},i(d){r||(j(e.$$.fragment,d),r=!0)},o(d){W(e.$$.fragment,d),r=!1},d(d){Ee(e,d)}}}function Ci(n,e){var i;let t,r,s;return r=new Ma.Wrap({props:{title:e[11].title,description:e[11].description,direction:(i=e[11])==null?void 0:i.direction,$$slots:{default:[lf]},$$scope:{ctx:e}}}),{key:n,first:null,c(){t=ys(),Ce(r.$$.fragment),this.first=t},m(a,o){J(a,t,o),Se(r,a,o),s=!0},p(a,o){var c;e=a;const l={};o&4&&(l.title=e[11].title),o&4&&(l.description=e[11].description),o&4&&(l.direction=(c=e[11])==null?void 0:c.direction),o&516&&(l.$$scope={dirty:o,ctx:e}),r.$set(l)},i(a){s||(j(r.$$.fragment,a),s=!0)},o(a){W(r.$$.fragment,a),s=!1},d(a){a&&q(t),Ee(r,a)}}}function xi(n){let e,t;return e=new sf({props:{apiKey:n[1].getValue("apiKey")}}),{c(){Ce(e.$$.fragment)},m(r,s){Se(e,r,s),t=!0},p(r,s){const i={};s&2&&(i.apiKey=r[1].getValue("apiKey")),e.$set(i)},i(r){t||(j(e.$$.fragment,r),t=!0)},o(r){W(e.$$.fragment,r),t=!1},d(r){Ee(e,r)}}}function cf(n){let e,t,r=[],s=new Map,i,a,o;const l=n[7].default,c=hs(l,n,n[9],null);let d=Ge(n[2]);const u=m=>m[11].key;for(let m=0;m<d.length;m+=1){let f=Pi(n,d,m),p=u(f);s.set(p,r[m]=Ci(p,f))}let h=n[0]==="🌈 设置"&&xi(n);return{c(){e=C("div"),c&&c.c(),t=O();for(let m=0;m<r.length;m+=1)r[m].c();i=O(),h&&h.c(),A(e,"class",a="config__tab-container "+n[3]),A(e,"data-name",n[0])},m(m,f){J(m,e,f),c&&c.m(e,null),y(e,t);for(let p=0;p<r.length;p+=1)r[p]&&r[p].m(e,null);y(e,i),h&&h.m(e,null),o=!0},p(m,[f]){c&&c.p&&(!o||f&512)&&ps(c,l,m,m[9],o?ms(l,m[9],f,null):gs(m[9]),null),f&52&&(d=Ge(m[2]),ct(),r=va(r,f,u,1,m,d,s,e,xa,Ci,i,Pi),ut()),m[0]==="🌈 设置"?h?(h.p(m,f),f&1&&j(h,1)):(h=xi(m),h.c(),j(h,1),h.m(e,null)):h&&(ct(),W(h,1,1,()=>{h=null}),ut()),(!o||f&8&&a!==(a="config__tab-container "+m[3]))&&A(e,"class",a),(!o||f&1)&&A(e,"data-name",m[0])},i(m){if(!o){j(c,m);for(let f=0;f<d.length;f+=1)j(r[f]);j(h),o=!0}},o(m){W(c,m);for(let f=0;f<r.length;f+=1)W(r[f]);W(h),o=!1},d(m){m&&q(e),c&&c.d(m);for(let f=0;f<r.length;f+=1)r[f].d();h&&h.d()}}}function uf(n,e,t){let r,{$$slots:s={},$$scope:i}=e,{group:a}=e,{settingStorage:o}=e,{display:l=!0}=e,c=o.getSettingItems(a);const d=ka();function u({detail:f}){d("click",{key:f.key})}function h({detail:f}){d("changed",{group:a,...f})}function m(f,p){n.$$.not_equal(p.value,f)&&(p.value=f,t(2,c))}return n.$$set=f=>{"group"in f&&t(0,a=f.group),"settingStorage"in f&&t(1,o=f.settingStorage),"display"in f&&t(6,l=f.display),"$$scope"in f&&t(9,i=f.$$scope)},n.$$.update=()=>{n.$$.dirty&64&&t(3,r=l?"":"fn__none")},[a,o,c,r,u,h,l,s,m,i]}class ro extends De{constructor(e){super(),$e(this,e,uf,cf,Le,{group:0,settingStorage:1,display:6})}}const Gr="RFC3986",Qr={RFC1738:n=>String(n).replace(/%20/g,"+"),RFC3986:n=>String(n)},ff="RFC1738",df=Array.isArray,Fe=(()=>{const n=[];for(let e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n})(),Er=1024,hf=(n,e,t,r,s)=>{if(n.length===0)return n;let i=n;if(typeof n=="symbol"?i=Symbol.prototype.toString.call(n):typeof n!="string"&&(i=String(n)),t==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let a="";for(let o=0;o<i.length;o+=Er){const l=i.length>=Er?i.slice(o,o+Er):i,c=[];for(let d=0;d<l.length;++d){let u=l.charCodeAt(d);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||s===ff&&(u===40||u===41)){c[c.length]=l.charAt(d);continue}if(u<128){c[c.length]=Fe[u];continue}if(u<2048){c[c.length]=Fe[192|u>>6]+Fe[128|u&63];continue}if(u<55296||u>=57344){c[c.length]=Fe[224|u>>12]+Fe[128|u>>6&63]+Fe[128|u&63];continue}d+=1,u=65536+((u&1023)<<10|l.charCodeAt(d)&1023),c[c.length]=Fe[240|u>>18]+Fe[128|u>>12&63]+Fe[128|u>>6&63]+Fe[128|u&63]}a+=c.join("")}return a};function mf(n){return!n||typeof n!="object"?!1:!!(n.constructor&&n.constructor.isBuffer&&n.constructor.isBuffer(n))}function vi(n,e){if(df(n)){const t=[];for(let r=0;r<n.length;r+=1)t.push(e(n[r]));return t}return e(n)}const pf=Object.prototype.hasOwnProperty,so={brackets(n){return String(n)+"[]"},comma:"comma",indices(n,e){return String(n)+"["+e+"]"},repeat(n){return String(n)}},Ne=Array.isArray,gf=Array.prototype.push,io=function(n,e){gf.apply(n,Ne(e)?e:[e])},_f=Date.prototype.toISOString,ee={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:hf,encodeValuesOnly:!1,format:Gr,formatter:Qr[Gr],indices:!1,serializeDate(n){return _f.call(n)},skipNulls:!1,strictNullHandling:!1};function yf(n){return typeof n=="string"||typeof n=="number"||typeof n=="boolean"||typeof n=="symbol"||typeof n=="bigint"}const Ar={};function ao(n,e,t,r,s,i,a,o,l,c,d,u,h,m,f,p,_,k){let g=n,E=k,b=0,R=!1;for(;(E=E.get(Ar))!==void 0&&!R;){const N=E.get(n);if(b+=1,typeof N<"u"){if(N===b)throw new RangeError("Cyclic object value");R=!0}typeof E.get(Ar)>"u"&&(b=0)}if(typeof c=="function"?g=c(e,g):g instanceof Date?g=h==null?void 0:h(g):t==="comma"&&Ne(g)&&(g=vi(g,function(N){return N instanceof Date?h==null?void 0:h(N):N})),g===null){if(i)return l&&!p?l(e,ee.encoder,_,"key",m):e;g=""}if(yf(g)||mf(g)){if(l){const N=p?e:l(e,ee.encoder,_,"key",m);return[(f==null?void 0:f(N))+"="+(f==null?void 0:f(l(g,ee.encoder,_,"value",m)))]}return[(f==null?void 0:f(e))+"="+(f==null?void 0:f(String(g)))]}const P=[];if(typeof g>"u")return P;let S;if(t==="comma"&&Ne(g))p&&l&&(g=vi(g,l)),S=[{value:g.length>0?g.join(",")||null:void 0}];else if(Ne(c))S=c;else{const N=Object.keys(g);S=d?N.sort(d):N}const M=o?String(e).replace(/\./g,"%2E"):String(e),I=r&&Ne(g)&&g.length===1?M+"[]":M;if(s&&Ne(g)&&g.length===0)return I+"[]";for(let N=0;N<S.length;++N){const v=S[N],Q=typeof v=="object"&&typeof v.value<"u"?v.value:g[v];if(a&&Q===null)continue;const X=u&&o?v.replace(/\./g,"%2E"):v,ce=Ne(g)?typeof t=="function"?t(I,X):I:I+(u?"."+X:"["+X+"]");k.set(n,b);const Je=new WeakMap;Je.set(Ar,k),io(P,ao(Q,ce,t,r,s,i,a,o,t==="comma"&&p&&Ne(g)?null:l,c,d,u,h,m,f,p,_,Je))}return P}function wf(n=ee){if(typeof n.allowEmptyArrays<"u"&&typeof n.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof n.encodeDotInKeys<"u"&&typeof n.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(n.encoder!==null&&typeof n.encoder<"u"&&typeof n.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=n.charset||ee.charset;if(typeof n.charset<"u"&&n.charset!=="utf-8"&&n.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=Gr;if(typeof n.format<"u"){if(!pf.call(Qr,n.format))throw new TypeError("Unknown format option provided.");t=n.format}const r=Qr[t];let s=ee.filter;(typeof n.filter=="function"||Ne(n.filter))&&(s=n.filter);let i;if(n.arrayFormat&&n.arrayFormat in so?i=n.arrayFormat:"indices"in n?i=n.indices?"indices":"repeat":i=ee.arrayFormat,"commaRoundTrip"in n&&typeof n.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const a=typeof n.allowDots>"u"?n.encodeDotInKeys?!0:ee.allowDots:!!n.allowDots;return{addQueryPrefix:typeof n.addQueryPrefix=="boolean"?n.addQueryPrefix:ee.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof n.allowEmptyArrays=="boolean"?!!n.allowEmptyArrays:ee.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof n.charsetSentinel=="boolean"?n.charsetSentinel:ee.charsetSentinel,commaRoundTrip:!!n.commaRoundTrip,delimiter:typeof n.delimiter>"u"?ee.delimiter:n.delimiter,encode:typeof n.encode=="boolean"?n.encode:ee.encode,encodeDotInKeys:typeof n.encodeDotInKeys=="boolean"?n.encodeDotInKeys:ee.encodeDotInKeys,encoder:typeof n.encoder=="function"?n.encoder:ee.encoder,encodeValuesOnly:typeof n.encodeValuesOnly=="boolean"?n.encodeValuesOnly:ee.encodeValuesOnly,filter:s,format:t,formatter:r,serializeDate:typeof n.serializeDate=="function"?n.serializeDate:ee.serializeDate,skipNulls:typeof n.skipNulls=="boolean"?n.skipNulls:ee.skipNulls,sort:typeof n.sort=="function"?n.sort:null,strictNullHandling:typeof n.strictNullHandling=="boolean"?n.strictNullHandling:ee.strictNullHandling}}function bf(n,e={}){let t=n;const r=wf(e);let s,i;typeof r.filter=="function"?(i=r.filter,t=i("",t)):Ne(r.filter)&&(i=r.filter,s=i);const a=[];if(typeof t!="object"||t===null)return"";const o=so[r.arrayFormat],l=o==="comma"&&r.commaRoundTrip;s||(s=Object.keys(t)),r.sort&&s.sort(r.sort);const c=new WeakMap;for(let h=0;h<s.length;++h){const m=s[h];r.skipNulls&&t[m]===null||io(a,ao(t[m],m,o,l,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,c))}const d=a.join(r.delimiter);let u=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?u+="utf8=%26%2310003%3B&":u+="utf8=%E2%9C%93&"),d.length>0?u+d:""}const bt="4.78.1";let Oi=!1,nn,oo,lo,Yr,co,uo,fo,ho,mo;function Sf(n,e={auto:!1}){if(Oi)throw new Error(`you must \`import 'openai/shims/${n.kind}'\` before importing anything else from openai`);if(nn)throw new Error(`can't \`import 'openai/shims/${n.kind}'\` after \`import 'openai/shims/${nn}'\``);Oi=e.auto,nn=n.kind,oo=n.fetch,lo=n.FormData,Yr=n.File,co=n.ReadableStream,uo=n.getMultipartRequestOptions,fo=n.getDefaultAgent,ho=n.fileFromPath,mo=n.isFsReadStream}let Ef=class{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};function Af({manuallyImported:n}={}){const e=n?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,r,s,i;try{t=fetch,r=Request,s=Response,i=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:t,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new Ef(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:a=>!1}}nn||Sf(Af(),{auto:!0});class L extends Error{}let me=class Zr extends L{constructor(e,t,r,s){super(`${Zr.makeMessage(e,t,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"],this.error=t;const i=t;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,t,r){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,r,s){if(!e||!s)return new sr({message:r,cause:ns(t)});const i=t==null?void 0:t.error;return e===400?new po(e,i,r,s):e===401?new go(e,i,r,s):e===403?new _o(e,i,r,s):e===404?new yo(e,i,r,s):e===409?new wo(e,i,r,s):e===422?new bo(e,i,r,s):e===429?new So(e,i,r,s):e>=500?new Eo(e,i,r,s):new Zr(e,i,r,s)}},xe=class extends me{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},sr=class extends me{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}},Rs=class extends sr{constructor({message:e}={}){super({message:e??"Request timed out."})}},po=class extends me{},go=class extends me{},_o=class extends me{},yo=class extends me{},wo=class extends me{},bo=class extends me{},So=class extends me{},Eo=class extends me{};class Ao extends L{constructor(){super("Could not parse response content as the length limit was reached")}}class Ro extends L{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}let ir=class es{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const r=es.NEWLINE_CHARS.has(t[t.length-1]||"");let s=t.split(es.NEWLINE_REGEXP);return r&&s.pop(),s.length===1&&!r?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),r||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new L(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new L(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new L("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}};ir.NEWLINE_CHARS=new Set([`
`,"\r"]);ir.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let ln=class zt{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const a of Rf(e,t))if(!i){if(a.data.startsWith("[DONE]")){i=!0;continue}if(a.event===null){let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(o&&o.error)throw new me(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(a.event=="error")throw new me(void 0,o.error,o.message,void 0);yield{event:a.event,data:o}}}i=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{i||t.abort()}}return new zt(s,t)}static fromReadableStream(e,t){let r=!1;async function*s(){const a=new ir,o=ko(e);for await(const l of o)for(const c of a.decode(l))yield c;for(const l of a.flush())yield l}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(const o of s())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||t.abort()}}return new zt(i,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const a=r.next();e.push(a),t.push(a)}return i.shift()}});return[new zt(()=>s(e),this.controller),new zt(()=>s(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new co({async start(){t=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:a}=await t.next();if(a)return s.close();const o=r.encode(JSON.stringify(i)+`
`);s.enqueue(o)}catch(i){s.error(i)}},async cancel(){var s;await((s=t.return)==null?void 0:s.call(t))}})}};async function*Rf(n,e){if(!n.body)throw e.abort(),new L("Attempted to iterate over a response with no body");const t=new Cf,r=new ir,s=ko(n.body);for await(const i of kf(s))for(const a of r.decode(i)){const o=t.decode(a);o&&(yield o)}for(const i of r.flush()){const a=t.decode(i);a&&(yield a)}}async function*kf(n){let e=new Uint8Array;for await(const t of n){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=Pf(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}function Pf(n){for(let r=0;r<n.length-2;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}let Cf=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,s]=xf(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}};function xf(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}function ko(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const Po=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function",Co=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&ar(n),ar=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",vf=n=>Co(n)||Po(n)||mo(n);async function xo(n,e,t){var s;if(n=await n,Co(n))return n;if(Po(n)){const i=await n.blob();e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=ar(i)?[await i.arrayBuffer()]:[i];return new Yr(a,e,t)}const r=await Of(n);if(e||(e=Mf(n)??"unknown_file"),!(t!=null&&t.type)){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(t={...t,type:i})}return new Yr(r,e,t)}async function Of(n){var t;let e=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)e.push(n);else if(ar(n))e.push(await n.arrayBuffer());else if(If(n))for await(const r of n)e.push(r);else throw new Error(`Unexpected data type: ${typeof n}; constructor: ${(t=n==null?void 0:n.constructor)==null?void 0:t.name}; props: ${Tf(n)}`);return e}function Tf(n){return`[${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}function Mf(n){var e;return Rr(n.name)||Rr(n.filename)||((e=Rr(n.path))==null?void 0:e.split(/[\\/]/).pop())}const Rr=n=>{if(typeof n=="string")return n;if(typeof Buffer<"u"&&n instanceof Buffer)return String(n)},If=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function",Ti=n=>n&&typeof n=="object"&&n.body&&n[Symbol.toStringTag]==="MultipartBody",It=async n=>{const e=await Ff(n.body);return uo(e,n)},Ff=async n=>{const e=new lo;return await Promise.all(Object.entries(n||{}).map(([t,r])=>ts(e,t,r))),e},ts=async(n,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")n.append(e,String(t));else if(vf(t)){const r=await xo(t);n.append(e,r)}else if(Array.isArray(t))await Promise.all(t.map(r=>ts(n,e+"[]",r)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([r,s])=>ts(n,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var Nf=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},Bf=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},bn;async function vo(n){const{response:e}=n;if(n.options.stream)return xt("response",e.status,e.url,e.headers,e.body),n.options.__streamClass?n.options.__streamClass.fromSSEResponse(e,n.controller):ln.fromSSEResponse(e,n.controller);if(e.status===204)return null;if(n.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const i=await e.json();return xt("response",e.status,e.url,e.headers,i),Oo(i,e)}const s=await e.text();return xt("response",e.status,e.url,e.headers,s),s}function Oo(n,e){return!n||typeof n!="object"||Array.isArray(n)?n:Object.defineProperty(n,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}let To=class Mo extends Promise{constructor(e,t=vo){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new Mo(this.responsePromise,async t=>Oo(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}},Lf=class{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=kr("maxRetries",t),this.timeout=kr("timeout",r),this.httpAgent=s,this.fetch=i??oo}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Hf(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Xf()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&ar(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:t,...s,body:i}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var p;const{method:r,path:s,query:i,headers:a={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:Ti(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(o),c=this.buildURL(s,i);"timeout"in e&&kr("timeout",e.timeout);const d=e.timeout??this.timeout,u=e.httpAgent??this.httpAgent??fo(c),h=d+1e3;typeof((p=u==null?void 0:u.options)==null?void 0:p.timeout)=="number"&&h>(u.options.timeout??0)&&(u.options.timeout=h),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const m=this.buildHeaders({options:e,headers:a,contentLength:l,retryCount:t});return{req:{method:r,...o&&{body:o},headers:m,...u&&{agent:u},signal:e.signal??null},url:c,timeout:d}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:s}){const i={};r&&(i["content-length"]=r);const a=this.defaultHeaders(e);return Ni(i,a),Ni(i,t),Ti(e.body)&&nn!=="node"&&delete i["content-type"],Bi(a,"x-stainless-retry-count")===void 0&&Bi(t,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),this.validateHeaders(i,t),i}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,r,s){return me.generate(e,t,r,s)}request(e,t=null){return new To(this.makeRequest(e,t))}async makeRequest(e,t){var u,h;const r=await e,s=r.maxRetries??this.maxRetries;t==null&&(t=s),await this.prepareOptions(r);const{req:i,url:a,timeout:o}=this.buildRequest(r,{retryCount:s-t});if(await this.prepareRequest(i,{url:a,options:r}),xt("request",a,r,i.headers),(u=r.signal)!=null&&u.aborted)throw new xe;const l=new AbortController,c=await this.fetchWithTimeout(a,i,o,l).catch(ns);if(c instanceof Error){if((h=r.signal)!=null&&h.aborted)throw new xe;if(t)return this.retryRequest(r,t);throw c.name==="AbortError"?new Rs:new sr({cause:c})}const d=Df(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const g=`retrying, ${t} attempts remaining`;return xt(`response (error; ${g})`,c.status,a,d),this.retryRequest(r,t,d)}const m=await c.text().catch(g=>ns(g).message),f=Wf(m),p=f?void 0:m;throw xt(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,a,d,p),this.makeStatusError(c.status,f,p,d)}return{response:c,options:r,controller:l}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new $f(this,r,e)}buildURL(e,t){const r=Vf(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return Fo(s)||(t={...s,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new L(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,s){const{signal:i,...a}=t||{};i&&i.addEventListener("abort",()=>s.abort());const o=setTimeout(()=>s.abort(),r),l={signal:s.signal,...a};return l.method&&(l.method=l.method.toUpperCase()),this.fetch.call(void 0,e,l).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(s=o)}const a=r==null?void 0:r["retry-after"];if(a&&!s){const o=parseFloat(a);Number.isNaN(o)?s=Date.parse(a)-Date.now():s=o*1e3}if(!(s&&0<=s&&s<60*1e3)){const o=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,o)}return await hn(s),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const i=t-e,a=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${bt}`}},Io=class{constructor(e,t,r,s){bn.set(this,void 0),Nf(this,bn,e,"f"),this.options=s,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new L("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);t.query=void 0,t.path=e.url.toString()}return await Bf(this,bn,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(bn=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}},$f=class extends To{constructor(e,t,r){super(t,async s=>new r(e,s.response,await vo(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}};const Df=n=>new Proxy(Object.fromEntries(n.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),jf={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},pe=n=>typeof n=="object"&&n!==null&&!Fo(n)&&Object.keys(n).every(e=>No(jf,e)),Uf=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bt,"X-Stainless-OS":Ii(Deno.build.os),"X-Stainless-Arch":Mi(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bt,"X-Stainless-OS":Ii(process.platform),"X-Stainless-Arch":Mi(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const n=qf();return n?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${n.browser}`,"X-Stainless-Runtime-Version":n.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function qf(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const r=t.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,a=r[3]||0;return{browser:e,version:`${s}.${i}.${a}`}}}return null}const Mi=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",Ii=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Fi;const Hf=()=>Fi??(Fi=Uf()),Wf=n=>{try{return JSON.parse(n)}catch{return}},Jf=/^[a-z][a-z0-9+.-]*:/i,Vf=n=>Jf.test(n),hn=n=>new Promise(e=>setTimeout(e,n)),kr=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new L(`${n} must be an integer`);if(e<0)throw new L(`${n} must be a positive integer`);return e},ns=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null)try{return new Error(JSON.stringify(n))}catch{}return new Error(n)},Sn=n=>{var e,t,r,s,i;if(typeof process<"u")return((t=(e=process.env)==null?void 0:e[n])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(i=(s=(r=Deno.env)==null?void 0:r.get)==null?void 0:s.call(r,n))==null?void 0:i.trim()};function Fo(n){if(!n)return!0;for(const e in n)return!1;return!0}function No(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ni(n,e){for(const t in e){if(!No(e,t))continue;const r=t.toLowerCase();if(!r)continue;const s=e[t];s===null?delete n[r]:s!==void 0&&(n[r]=s)}}function xt(n,...e){var t;typeof process<"u"&&((t=process==null?void 0:process.env)==null?void 0:t.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${n}`,...e)}const Xf=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)}),zf=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Kf=n=>typeof(n==null?void 0:n.get)=="function",Bi=(n,e)=>{var r;const t=e.toLowerCase();if(Kf(n)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,a,o)=>a+o.toUpperCase());for(const i of[e,t,e.toUpperCase(),s]){const a=n.get(i);if(a)return a}}for(const[s,i]of Object.entries(n))if(s.toLowerCase()===t)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i};function Pr(n){return n!=null&&typeof n=="object"&&!Array.isArray(n)}let Gf=class extends Io{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}};class Me extends Io{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const t=(r=e[e.length-1])==null?void 0:r.id;return t?{params:{after:t}}:null}}let U=class{constructor(e){this._client=e}},Bo=class extends U{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},ks=class extends U{constructor(){super(...arguments),this.completions=new Bo(this._client)}};ks.Completions=Bo;class Lo extends U{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}class $o extends U{create(e,t){return this._client.post("/audio/transcriptions",It({body:e,...t}))}}class Do extends U{create(e,t){return this._client.post("/audio/translations",It({body:e,...t}))}}class mn extends U{constructor(){super(...arguments),this.transcriptions=new $o(this._client),this.translations=new Do(this._client),this.speech=new Lo(this._client)}}mn.Transcriptions=$o;mn.Translations=Do;mn.Speech=Lo;let Ps=class extends U{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return pe(e)?this.list({},e):this._client.getAPIList("/batches",Cs,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}};class Cs extends Me{}Ps.BatchesPage=Cs;class xs extends U{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/assistants/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return pe(e)?this.list({},e):this._client.getAPIList("/assistants",vs,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class vs extends Me{}xs.AssistantsPage=vs;function Li(n){return typeof n.parse=="function"}const vt=n=>(n==null?void 0:n.role)==="assistant",jo=n=>(n==null?void 0:n.role)==="function",Uo=n=>(n==null?void 0:n.role)==="tool";var ke=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},K=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},rs,Nn,Bn,Kt,Gt,Ln,Qt,qe,Yt,Vn,Xn,St,qo;class Ho{constructor(){rs.add(this),this.controller=new AbortController,Nn.set(this,void 0),Bn.set(this,()=>{}),Kt.set(this,()=>{}),Gt.set(this,void 0),Ln.set(this,()=>{}),Qt.set(this,()=>{}),qe.set(this,{}),Yt.set(this,!1),Vn.set(this,!1),Xn.set(this,!1),St.set(this,!1),ke(this,Nn,new Promise((e,t)=>{ke(this,Bn,e,"f"),ke(this,Kt,t,"f")}),"f"),ke(this,Gt,new Promise((e,t)=>{ke(this,Ln,e,"f"),ke(this,Qt,t,"f")}),"f"),K(this,Nn,"f").catch(()=>{}),K(this,Gt,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},K(this,rs,"m",qo).bind(this))},0)}_connected(){this.ended||(K(this,Bn,"f").call(this),this._emit("connect"))}get ended(){return K(this,Yt,"f")}get errored(){return K(this,Vn,"f")}get aborted(){return K(this,Xn,"f")}abort(){this.controller.abort()}on(e,t){return(K(this,qe,"f")[e]||(K(this,qe,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=K(this,qe,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===t);return s>=0&&r.splice(s,1),this}once(e,t){return(K(this,qe,"f")[e]||(K(this,qe,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{ke(this,St,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){ke(this,St,!0,"f"),await K(this,Gt,"f")}_emit(e,...t){if(K(this,Yt,"f"))return;e==="end"&&(ke(this,Yt,!0,"f"),K(this,Ln,"f").call(this));const r=K(this,qe,"f")[e];if(r&&(K(this,qe,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...t))),e==="abort"){const s=t[0];!K(this,St,"f")&&!(r!=null&&r.length)&&Promise.reject(s),K(this,Kt,"f").call(this,s),K(this,Qt,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=t[0];!K(this,St,"f")&&!(r!=null&&r.length)&&Promise.reject(s),K(this,Kt,"f").call(this,s),K(this,Qt,"f").call(this,s),this._emit("end")}}_emitFinal(){}}Nn=new WeakMap,Bn=new WeakMap,Kt=new WeakMap,Gt=new WeakMap,Ln=new WeakMap,Qt=new WeakMap,qe=new WeakMap,Yt=new WeakMap,Vn=new WeakMap,Xn=new WeakMap,St=new WeakMap,rs=new WeakSet,qo=function(e){if(ke(this,Vn,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new xe),e instanceof xe)return ke(this,Xn,!0,"f"),this._emit("abort",e);if(e instanceof L)return this._emit("error",e);if(e instanceof Error){const t=new L(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new L(String(e)))};function Wo(n){return(n==null?void 0:n.$brand)==="auto-parseable-response-format"}function pn(n){return(n==null?void 0:n.$brand)==="auto-parseable-tool"}function Qf(n,e){return!e||!Jo(e)?{...n,choices:n.choices.map(t=>({...t,message:{...t.message,parsed:null,tool_calls:t.message.tool_calls??[]}}))}:Os(n,e)}function Os(n,e){const t=n.choices.map(r=>{var s;if(r.finish_reason==="length")throw new Ao;if(r.finish_reason==="content_filter")throw new Ro;return{...r,message:{...r.message,tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(i=>Zf(e,i)))??[],parsed:r.message.content&&!r.message.refusal?Yf(e,r.message.content):null}}});return{...n,choices:t}}function Yf(n,e){var t,r;return((t=n.response_format)==null?void 0:t.type)!=="json_schema"?null:((r=n.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in n.response_format?n.response_format.$parseRaw(e):JSON.parse(e):null}function Zf(n,e){var r;const t=(r=n.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:pn(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function ed(n,e){var r;if(!n)return!1;const t=(r=n.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return pn(t)||(t==null?void 0:t.function.strict)||!1}function Jo(n){var e;return Wo(n.response_format)?!0:((e=n.tools)==null?void 0:e.some(t=>pn(t)||t.type==="function"&&t.function.strict===!0))??!1}function td(n){for(const e of n??[]){if(e.type!=="function")throw new L(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new L(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var de=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},ae,ss,zn,is,as,os,Vo,ls;const $i=10;class Xo extends Ho{constructor(){super(...arguments),ae.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(r=e.choices[0])==null?void 0:r.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(jo(e)||Uo(e))&&e.content)this._emit("functionCallResult",e.content);else if(vt(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(vt(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new L("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),de(this,ae,"m",ss).call(this)}async finalMessage(){return await this.done(),de(this,ae,"m",zn).call(this)}async finalFunctionCall(){return await this.done(),de(this,ae,"m",is).call(this)}async finalFunctionCallResult(){return await this.done(),de(this,ae,"m",as).call(this)}async totalUsage(){return await this.done(),de(this,ae,"m",os).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=de(this,ae,"m",zn).call(this);t&&this._emit("finalMessage",t);const r=de(this,ae,"m",ss).call(this);r&&this._emit("finalContent",r);const s=de(this,ae,"m",is).call(this);s&&this._emit("finalFunctionCall",s);const i=de(this,ae,"m",as).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",de(this,ae,"m",os).call(this))}async _createChatCompletion(e,t,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),de(this,ae,"m",Vo).call(this,t);const i=await e.chat.completions.create({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Os(i,t))}async _runChatCompletion(e,t,r){for(const s of t.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,t,r)}async _runFunctions(e,t,r){var h;const s="function",{function_call:i="auto",stream:a,...o}=t,l=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:c=$i}=r||{},d={};for(const m of t.functions)d[m.name||m.function.name]=m;const u=t.functions.map(m=>({name:m.name||m.function.name,parameters:m.parameters,description:m.description}));for(const m of t.messages)this._addMessage(m,!1);for(let m=0;m<c;++m){const p=(h=(await this._createChatCompletion(e,{...o,function_call:i,functions:u,messages:[...this.messages]},r)).choices[0])==null?void 0:h.message;if(!p)throw new L("missing message in ChatCompletion response");if(!p.function_call)return;const{name:_,arguments:k}=p.function_call,g=d[_];if(g){if(l&&l!==_){const P=`Invalid function_call: ${JSON.stringify(_)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:s,name:_,content:P});continue}}else{const P=`Invalid function_call: ${JSON.stringify(_)}. Available options are: ${u.map(S=>JSON.stringify(S.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:_,content:P});continue}let E;try{E=Li(g)?await g.parse(k):k}catch(P){this._addMessage({role:s,name:_,content:P instanceof Error?P.message:String(P)});continue}const b=await g.function(E,this),R=de(this,ae,"m",ls).call(this,b);if(this._addMessage({role:s,name:_,content:R}),l)return}}async _runTools(e,t,r){var m,f,p;const s="tool",{tool_choice:i="auto",stream:a,...o}=t,l=typeof i!="string"&&((m=i==null?void 0:i.function)==null?void 0:m.name),{maxChatCompletions:c=$i}=r||{},d=t.tools.map(_=>{if(pn(_)){if(!_.$callback)throw new L("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:_.$callback,name:_.function.name,description:_.function.description||"",parameters:_.function.parameters,parse:_.$parseRaw,strict:!0}}}return _}),u={};for(const _ of d)_.type==="function"&&(u[_.function.name||_.function.function.name]=_.function);const h="tools"in t?d.map(_=>_.type==="function"?{type:"function",function:{name:_.function.name||_.function.function.name,parameters:_.function.parameters,description:_.function.description,strict:_.function.strict}}:_):void 0;for(const _ of t.messages)this._addMessage(_,!1);for(let _=0;_<c;++_){const g=(f=(await this._createChatCompletion(e,{...o,tool_choice:i,tools:h,messages:[...this.messages]},r)).choices[0])==null?void 0:f.message;if(!g)throw new L("missing message in ChatCompletion response");if(!((p=g.tool_calls)!=null&&p.length))return;for(const E of g.tool_calls){if(E.type!=="function")continue;const b=E.id,{name:R,arguments:P}=E.function,S=u[R];if(S){if(l&&l!==R){const v=`Invalid tool_call: ${JSON.stringify(R)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:s,tool_call_id:b,content:v});continue}}else{const v=`Invalid tool_call: ${JSON.stringify(R)}. Available options are: ${Object.keys(u).map(Q=>JSON.stringify(Q)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:b,content:v});continue}let M;try{M=Li(S)?await S.parse(P):P}catch(v){const Q=v instanceof Error?v.message:String(v);this._addMessage({role:s,tool_call_id:b,content:Q});continue}const I=await S.function(M,this),N=de(this,ae,"m",ls).call(this,I);if(this._addMessage({role:s,tool_call_id:b,content:N}),l)return}}}}ae=new WeakSet,ss=function(){return de(this,ae,"m",zn).call(this).content??null},zn=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(vt(t)){const{function_call:r,...s}=t,i={...s,content:t.content??null,refusal:t.refusal??null};return r&&(i.function_call=r),i}}throw new L("stream ended without producing a ChatCompletionMessage with role=assistant")},is=function(){var e,t;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(vt(s)&&(s!=null&&s.function_call))return s.function_call;if(vt(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(t=s.tool_calls.at(-1))==null?void 0:t.function}},as=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(jo(t)&&t.content!=null||Uo(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===t.tool_call_id))}))return t.content}},os=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Vo=function(e){if(e.n!=null&&e.n>1)throw new L("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},ls=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class cn extends Xo{static runFunctions(e,t,r){const s=new cn,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,i)),s}static runTools(e,t,r){const s=new cn,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,i)),s}_addMessage(e,t=!0){super._addMessage(e,t),vt(e)&&e.content&&this._emit("content",e.content)}}const zo=1,Ko=2,Go=4,Qo=8,Yo=16,Zo=32,el=64,tl=128,nl=256,rl=tl|nl,sl=Yo|Zo|rl|el,il=zo|Ko|sl,al=Go|Qo,nd=il|al,te={STR:zo,NUM:Ko,ARR:Go,OBJ:Qo,NULL:Yo,BOOL:Zo,NAN:el,INFINITY:tl,MINUS_INFINITY:nl,INF:rl,SPECIAL:sl,ATOM:il,COLLECTION:al,ALL:nd};class rd extends Error{}class sd extends Error{}function id(n,e=te.ALL){if(typeof n!="string")throw new TypeError(`expecting str, got ${typeof n}`);if(!n.trim())throw new Error(`${n} is empty`);return ad(n.trim(),e)}const ad=(n,e)=>{const t=n.length;let r=0;const s=h=>{throw new rd(`${h} at position ${r}`)},i=h=>{throw new sd(`${h} at position ${r}`)},a=()=>(u(),r>=t&&s("Unexpected end of input"),n[r]==='"'?o():n[r]==="{"?l():n[r]==="["?c():n.substring(r,r+4)==="null"||te.NULL&e&&t-r<4&&"null".startsWith(n.substring(r))?(r+=4,null):n.substring(r,r+4)==="true"||te.BOOL&e&&t-r<4&&"true".startsWith(n.substring(r))?(r+=4,!0):n.substring(r,r+5)==="false"||te.BOOL&e&&t-r<5&&"false".startsWith(n.substring(r))?(r+=5,!1):n.substring(r,r+8)==="Infinity"||te.INFINITY&e&&t-r<8&&"Infinity".startsWith(n.substring(r))?(r+=8,1/0):n.substring(r,r+9)==="-Infinity"||te.MINUS_INFINITY&e&&1<t-r&&t-r<9&&"-Infinity".startsWith(n.substring(r))?(r+=9,-1/0):n.substring(r,r+3)==="NaN"||te.NAN&e&&t-r<3&&"NaN".startsWith(n.substring(r))?(r+=3,NaN):d()),o=()=>{const h=r;let m=!1;for(r++;r<t&&(n[r]!=='"'||m&&n[r-1]==="\\");)m=n[r]==="\\"?!m:!1,r++;if(n.charAt(r)=='"')try{return JSON.parse(n.substring(h,++r-Number(m)))}catch(f){i(String(f))}else if(te.STR&e)try{return JSON.parse(n.substring(h,r-Number(m))+'"')}catch{return JSON.parse(n.substring(h,n.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},l=()=>{r++,u();const h={};try{for(;n[r]!=="}";){if(u(),r>=t&&te.OBJ&e)return h;const m=o();u(),r++;try{const f=a();Object.defineProperty(h,m,{value:f,writable:!0,enumerable:!0,configurable:!0})}catch(f){if(te.OBJ&e)return h;throw f}u(),n[r]===","&&r++}}catch{if(te.OBJ&e)return h;s("Expected '}' at end of object")}return r++,h},c=()=>{r++;const h=[];try{for(;n[r]!=="]";)h.push(a()),u(),n[r]===","&&r++}catch{if(te.ARR&e)return h;s("Expected ']' at end of array")}return r++,h},d=()=>{if(r===0){n==="-"&&te.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n)}catch(m){if(te.NUM&e)try{return n[n.length-1]==="."?JSON.parse(n.substring(0,n.lastIndexOf("."))):JSON.parse(n.substring(0,n.lastIndexOf("e")))}catch{}i(String(m))}}const h=r;for(n[r]==="-"&&r++;n[r]&&!",]}".includes(n[r]);)r++;r==t&&!(te.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(n.substring(h,r))}catch{n.substring(h,r)==="-"&&te.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n.substring(h,n.lastIndexOf("e")))}catch(f){i(String(f))}}},u=()=>{for(;r<t&&` 
\r	`.includes(n[r]);)r++};return a()},Di=n=>id(n,te.ALL^te.NUM);var gt=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},H=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Z,je,_t,Ve,Cr,En,xr,vr,Or,An,Tr,ji;class un extends Xo{constructor(e){super(),Z.add(this),je.set(this,void 0),_t.set(this,void 0),Ve.set(this,void 0),gt(this,je,e,"f"),gt(this,_t,[],"f")}get currentChatCompletionSnapshot(){return H(this,Ve,"f")}static fromReadableStream(e){const t=new un(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){const s=new un(t);return s._run(()=>s._runChatCompletion(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,t,r){var a;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),H(this,Z,"m",Cr).call(this);const i=await e.chat.completions.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const o of i)H(this,Z,"m",xr).call(this,o);if((a=i.controller.signal)!=null&&a.aborted)throw new xe;return this._addChatCompletion(H(this,Z,"m",An).call(this))}async _fromReadableStream(e,t){var a;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),H(this,Z,"m",Cr).call(this),this._connected();const s=ln.fromReadableStream(e,this.controller);let i;for await(const o of s)i&&i!==o.id&&this._addChatCompletion(H(this,Z,"m",An).call(this)),H(this,Z,"m",xr).call(this,o),i=o.id;if((a=s.controller.signal)!=null&&a.aborted)throw new xe;return this._addChatCompletion(H(this,Z,"m",An).call(this))}[(je=new WeakMap,_t=new WeakMap,Ve=new WeakMap,Z=new WeakSet,Cr=function(){this.ended||gt(this,Ve,void 0,"f")},En=function(t){let r=H(this,_t,"f")[t.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},H(this,_t,"f")[t.index]=r,r)},xr=function(t){var s,i,a,o,l,c,d,u,h,m,f,p,_,k,g;if(this.ended)return;const r=H(this,Z,"m",ji).call(this,t);this._emit("chunk",t,r);for(const E of t.choices){const b=r.choices[E.index];E.delta.content!=null&&((s=b.message)==null?void 0:s.role)==="assistant"&&((i=b.message)!=null&&i.content)&&(this._emit("content",E.delta.content,b.message.content),this._emit("content.delta",{delta:E.delta.content,snapshot:b.message.content,parsed:b.message.parsed})),E.delta.refusal!=null&&((a=b.message)==null?void 0:a.role)==="assistant"&&((o=b.message)!=null&&o.refusal)&&this._emit("refusal.delta",{delta:E.delta.refusal,snapshot:b.message.refusal}),((l=E.logprobs)==null?void 0:l.content)!=null&&((c=b.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(d=E.logprobs)==null?void 0:d.content,snapshot:((u=b.logprobs)==null?void 0:u.content)??[]}),((h=E.logprobs)==null?void 0:h.refusal)!=null&&((m=b.message)==null?void 0:m.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(f=E.logprobs)==null?void 0:f.refusal,snapshot:((p=b.logprobs)==null?void 0:p.refusal)??[]});const R=H(this,Z,"m",En).call(this,b);b.finish_reason&&(H(this,Z,"m",Or).call(this,b),R.current_tool_call_index!=null&&H(this,Z,"m",vr).call(this,b,R.current_tool_call_index));for(const P of E.delta.tool_calls??[])R.current_tool_call_index!==P.index&&(H(this,Z,"m",Or).call(this,b),R.current_tool_call_index!=null&&H(this,Z,"m",vr).call(this,b,R.current_tool_call_index)),R.current_tool_call_index=P.index;for(const P of E.delta.tool_calls??[]){const S=(_=b.message.tool_calls)==null?void 0:_[P.index];S!=null&&S.type&&((S==null?void 0:S.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(k=S.function)==null?void 0:k.name,index:P.index,arguments:S.function.arguments,parsed_arguments:S.function.parsed_arguments,arguments_delta:((g=P.function)==null?void 0:g.arguments)??""}):(S==null||S.type,void 0))}}},vr=function(t,r){var a,o,l;if(H(this,Z,"m",En).call(this,t).done_tool_calls.has(r))return;const i=(a=t.message.tool_calls)==null?void 0:a[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const c=(l=(o=H(this,je,"f"))==null?void 0:o.tools)==null?void 0:l.find(d=>d.type==="function"&&d.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:pn(c)?c.$parseRaw(i.function.arguments):c!=null&&c.function.strict?JSON.parse(i.function.arguments):null})}else i.type},Or=function(t){var s,i;const r=H(this,Z,"m",En).call(this,t);if(t.message.content&&!r.content_done){r.content_done=!0;const a=H(this,Z,"m",Tr).call(this);this._emit("content.done",{content:t.message.content,parsed:a?a.$parseRaw(t.message.content):null})}t.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(s=t.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(i=t.logprobs)!=null&&i.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},An=function(){if(this.ended)throw new L("stream has ended, this shouldn't happen");const t=H(this,Ve,"f");if(!t)throw new L("request ended without sending any chunks");return gt(this,Ve,void 0,"f"),gt(this,_t,[],"f"),od(t,H(this,je,"f"))},Tr=function(){var r;const t=(r=H(this,je,"f"))==null?void 0:r.response_format;return Wo(t)?t:null},ji=function(t){var r,s,i,a;let o=H(this,Ve,"f");const{choices:l,...c}=t;o?Object.assign(o,c):o=gt(this,Ve,{...c,choices:[]},"f");for(const{delta:d,finish_reason:u,index:h,logprobs:m=null,...f}of t.choices){let p=o.choices[h];if(p||(p=o.choices[h]={finish_reason:u,index:h,message:{},logprobs:m,...f}),m)if(!p.logprobs)p.logprobs=Object.assign({},m);else{const{content:P,refusal:S,...M}=m;Object.assign(p.logprobs,M),P&&((r=p.logprobs).content??(r.content=[]),p.logprobs.content.push(...P)),S&&((s=p.logprobs).refusal??(s.refusal=[]),p.logprobs.refusal.push(...S))}if(u&&(p.finish_reason=u,H(this,je,"f")&&Jo(H(this,je,"f")))){if(u==="length")throw new Ao;if(u==="content_filter")throw new Ro}if(Object.assign(p,f),!d)continue;const{content:_,refusal:k,function_call:g,role:E,tool_calls:b,...R}=d;if(Object.assign(p.message,R),k&&(p.message.refusal=(p.message.refusal||"")+k),E&&(p.message.role=E),g&&(p.message.function_call?(g.name&&(p.message.function_call.name=g.name),g.arguments&&((i=p.message.function_call).arguments??(i.arguments=""),p.message.function_call.arguments+=g.arguments)):p.message.function_call=g),_&&(p.message.content=(p.message.content||"")+_,!p.message.refusal&&H(this,Z,"m",Tr).call(this)&&(p.message.parsed=Di(p.message.content))),b){p.message.tool_calls||(p.message.tool_calls=[]);for(const{index:P,id:S,type:M,function:I,...N}of b){const v=(a=p.message.tool_calls)[P]??(a[P]={});Object.assign(v,N),S&&(v.id=S),M&&(v.type=M),I&&(v.function??(v.function={name:I.name??"",arguments:""})),I!=null&&I.name&&(v.function.name=I.name),I!=null&&I.arguments&&(v.function.arguments+=I.arguments,ed(H(this,je,"f"),v)&&(v.function.parsed_arguments=Di(v.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("chunk",s=>{const i=t.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,a)=>t.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ln(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function od(n,e){const{id:t,choices:r,created:s,model:i,system_fingerprint:a,...o}=n,l={...o,id:t,choices:r.map(({message:c,finish_reason:d,index:u,logprobs:h,...m})=>{if(!d)throw new L(`missing finish_reason for choice ${u}`);const{content:f=null,function_call:p,tool_calls:_,...k}=c,g=c.role;if(!g)throw new L(`missing role for choice ${u}`);if(p){const{arguments:E,name:b}=p;if(E==null)throw new L(`missing function_call.arguments for choice ${u}`);if(!b)throw new L(`missing function_call.name for choice ${u}`);return{...m,message:{content:f,function_call:{arguments:E,name:b},role:g,refusal:c.refusal??null},finish_reason:d,index:u,logprobs:h}}return _?{...m,index:u,finish_reason:d,logprobs:h,message:{...k,role:g,content:f,refusal:c.refusal??null,tool_calls:_.map((E,b)=>{const{function:R,type:P,id:S,...M}=E,{arguments:I,name:N,...v}=R||{};if(S==null)throw new L(`missing choices[${u}].tool_calls[${b}].id
${Rn(n)}`);if(P==null)throw new L(`missing choices[${u}].tool_calls[${b}].type
${Rn(n)}`);if(N==null)throw new L(`missing choices[${u}].tool_calls[${b}].function.name
${Rn(n)}`);if(I==null)throw new L(`missing choices[${u}].tool_calls[${b}].function.arguments
${Rn(n)}`);return{...M,id:S,type:P,function:{...v,name:N,arguments:I}}})}}:{...m,message:{...k,content:f,role:g,refusal:c.refusal??null},finish_reason:d,index:u,logprobs:h}}),created:s,model:i,object:"chat.completion",...a?{system_fingerprint:a}:{}};return Qf(l,e)}function Rn(n){return JSON.stringify(n)}class Ot extends un{static fromReadableStream(e){const t=new Ot(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,r){const s=new Ot(null),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,i)),s}static runTools(e,t,r){const s=new Ot(t),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,i)),s}}let ol=class extends U{parse(e,t){return td(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>Os(r,e))}runFunctions(e,t){return e.stream?Ot.runFunctions(this._client,e,t):cn.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Ot.runTools(this._client,e,t):cn.runTools(this._client,e,t)}stream(e,t){return un.createChatCompletion(this._client,e,t)}};class ll extends U{constructor(){super(...arguments),this.completions=new ol(this._client)}}(function(n){n.Completions=ol})(ll);class cl extends U{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Ts extends U{constructor(){super(...arguments),this.sessions=new cl(this._client)}}Ts.Sessions=cl;var T=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},ge=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},se,cs,Be,$n,Pe,it,kt,rt,Kn,_e,Dn,jn,rn,Zt,en,Ui,qi,Hi,Wi,Ji,Vi,Xi;class ve extends Ho{constructor(){super(...arguments),se.add(this),cs.set(this,[]),Be.set(this,{}),$n.set(this,{}),Pe.set(this,void 0),it.set(this,void 0),kt.set(this,void 0),rt.set(this,void 0),Kn.set(this,void 0),_e.set(this,void 0),Dn.set(this,void 0),jn.set(this,void 0),rn.set(this,void 0)}[(cs=new WeakMap,Be=new WeakMap,$n=new WeakMap,Pe=new WeakMap,it=new WeakMap,kt=new WeakMap,rt=new WeakMap,Kn=new WeakMap,_e=new WeakMap,Dn=new WeakMap,jn=new WeakMap,rn=new WeakMap,se=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("event",s=>{const i=t.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,a)=>t.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new ve;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var i;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=ln.fromReadableStream(e,this.controller);for await(const a of s)T(this,se,"m",Zt).call(this,a);if((i=s.controller.signal)!=null&&i.aborted)throw new xe;return this._addRun(T(this,se,"m",en).call(this))}toReadableStream(){return new ln(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,r,s,i){const a=new ve;return a._run(()=>a._runToolAssistantStream(e,t,r,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,t,r,s,i){var c;const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},l=await e.submitToolOutputs(t,r,o,{...i,signal:this.controller.signal});this._connected();for await(const d of l)T(this,se,"m",Zt).call(this,d);if((c=l.controller.signal)!=null&&c.aborted)throw new xe;return this._addRun(T(this,se,"m",en).call(this))}static createThreadAssistantStream(e,t,r){const s=new ve;return s._run(()=>s._threadAssistantStream(e,t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,t,r,s){const i=new ve;return i._run(()=>i._runAssistantStream(e,t,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return T(this,Dn,"f")}currentRun(){return T(this,jn,"f")}currentMessageSnapshot(){return T(this,Pe,"f")}currentRunStepSnapshot(){return T(this,rn,"f")}async finalRunSteps(){return await this.done(),Object.values(T(this,Be,"f"))}async finalMessages(){return await this.done(),Object.values(T(this,$n,"f"))}async finalRun(){if(await this.done(),!T(this,it,"f"))throw Error("Final run was not received.");return T(this,it,"f")}async _createThreadAssistantStream(e,t,r){var o;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...t,stream:!0},a=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const l of a)T(this,se,"m",Zt).call(this,l);if((o=a.controller.signal)!=null&&o.aborted)throw new xe;return this._addRun(T(this,se,"m",en).call(this))}async _createAssistantStream(e,t,r,s){var l;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const a={...r,stream:!0},o=await e.create(t,a,{...s,signal:this.controller.signal});this._connected();for await(const c of o)T(this,se,"m",Zt).call(this,c);if((l=o.controller.signal)!=null&&l.aborted)throw new xe;return this._addRun(T(this,se,"m",en).call(this))}static accumulateDelta(e,t){for(const[r,s]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(Pr(i)&&Pr(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(a=>typeof a=="string"||typeof a=="number")){i.push(...s);continue}for(const a of s){if(!Pr(a))throw new Error(`Expected array delta entry to be an object but got: ${a}`);const o=a.index;if(o==null)throw console.error(a),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const l=i[o];l==null?i.push(a):i[o]=this.accumulateDelta(l,a)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,t,r){return await this._createThreadAssistantStream(t,e,r)}async _runAssistantStream(e,t,r,s){return await this._createAssistantStream(t,e,r,s)}async _runToolAssistantStream(e,t,r,s,i){return await this._createToolAssistantStream(r,e,t,s,i)}}Zt=function(e){if(!this.ended)switch(ge(this,Dn,e,"f"),T(this,se,"m",Hi).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":T(this,se,"m",Xi).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":T(this,se,"m",qi).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":T(this,se,"m",Ui).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},en=function(){if(this.ended)throw new L("stream has ended, this shouldn't happen");if(!T(this,it,"f"))throw Error("Final run has not been received");return T(this,it,"f")},Ui=function(e){const[t,r]=T(this,se,"m",Ji).call(this,e,T(this,Pe,"f"));ge(this,Pe,t,"f"),T(this,$n,"f")[t.id]=t;for(const s of r){const i=t.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,a=t.content[s.index];if(a&&a.type=="text")this._emit("textDelta",i,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=T(this,kt,"f")){if(T(this,rt,"f"))switch(T(this,rt,"f").type){case"text":this._emit("textDone",T(this,rt,"f").text,T(this,Pe,"f"));break;case"image_file":this._emit("imageFileDone",T(this,rt,"f").image_file,T(this,Pe,"f"));break}ge(this,kt,s.index,"f")}ge(this,rt,t.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(T(this,kt,"f")!==void 0){const s=e.data.content[T(this,kt,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,T(this,Pe,"f"));break;case"text":this._emit("textDone",s.text,T(this,Pe,"f"));break}}T(this,Pe,"f")&&this._emit("messageDone",e.data),ge(this,Pe,void 0,"f")}},qi=function(e){const t=T(this,se,"m",Wi).call(this,e);switch(ge(this,rn,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==T(this,Kn,"f")?this._emit("toolCallDelta",i,t.step_details.tool_calls[i.index]):(T(this,_e,"f")&&this._emit("toolCallDone",T(this,_e,"f")),ge(this,Kn,i.index,"f"),ge(this,_e,t.step_details.tool_calls[i.index],"f"),T(this,_e,"f")&&this._emit("toolCallCreated",T(this,_e,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ge(this,rn,void 0,"f"),e.data.step_details.type=="tool_calls"&&T(this,_e,"f")&&(this._emit("toolCallDone",T(this,_e,"f")),ge(this,_e,void 0,"f")),this._emit("runStepDone",e.data,t);break}},Hi=function(e){T(this,cs,"f").push(e),this._emit("event",e)},Wi=function(e){switch(e.event){case"thread.run.step.created":return T(this,Be,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=T(this,Be,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=ve.accumulateDelta(t,r.delta);T(this,Be,"f")[e.data.id]=s}return T(this,Be,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":T(this,Be,"f")[e.data.id]=e.data;break}if(T(this,Be,"f")[e.data.id])return T(this,Be,"f")[e.data.id];throw new Error("No snapshot available")},Ji=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in t.content){let a=t.content[i.index];t.content[i.index]=T(this,se,"m",Vi).call(this,i,a)}else t.content[i.index]=i,r.push(i);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Vi=function(e,t){return ve.accumulateDelta(t,e)},Xi=function(e){switch(ge(this,jn,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":ge(this,it,e.data,"f"),T(this,_e,"f")&&(this._emit("toolCallDone",T(this,_e,"f")),ge(this,_e,void 0,"f"));break}};let Ms=class extends U{create(e,t,r){return this._client.post(`/threads/${e}/messages`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,s){return this._client.post(`/threads/${e}/messages/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},r){return pe(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,Is,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}};class Is extends Me{}Ms.MessagesPage=Is;class Fs extends U{retrieve(e,t,r,s={},i){return pe(s)?this.retrieve(e,t,r,{},s):this._client.get(`/threads/${e}/runs/${t}/steps/${r}`,{query:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,t,r={},s){return pe(r)?this.list(e,t,{},r):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,Ns,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class Ns extends Me{}Fs.RunStepsPage=Ns;class gn extends U{constructor(){super(...arguments),this.steps=new Fs(this._client)}create(e,t,r){const{include:s,...i}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:i,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:t.stream??!1})}retrieve(e,t,r){return this._client.get(`/threads/${e}/runs/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,s){return this._client.post(`/threads/${e}/runs/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},r){return pe(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,Bs,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t,r);return await this.poll(e,s.id,r)}createAndStream(e,t,r){return ve.createAssistantStream(e,this._client.beta.threads.runs,t,r)}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,t,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await hn(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,t,r){return ve.createAssistantStream(e,this._client.beta.threads.runs,t,r)}submitToolOutputs(e,t,r,s){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,t,r,s){const i=await this.submitToolOutputs(e,t,r,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,t,r,s){return ve.createToolAssistantStream(e,t,this._client.beta.threads.runs,r,s)}}class Bs extends Me{}gn.RunsPage=Bs;gn.Steps=Fs;gn.RunStepsPage=Ns;class Bt extends U{constructor(){super(...arguments),this.runs=new gn(this._client),this.messages=new Ms(this._client)}create(e={},t){return pe(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/threads/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const r=await this.createAndRun(e,t);return await this.runs.poll(r.thread_id,r.id,t)}createAndRunStream(e,t){return ve.createThreadAssistantStream(e,this._client.beta.threads,t)}}Bt.Runs=gn;Bt.RunsPage=Bs;Bt.Messages=Ms;Bt.MessagesPage=Is;const ld=async n=>{const e=await Promise.allSettled(n),t=e.filter(s=>s.status==="rejected");if(t.length){for(const s of t)console.error(s.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};let Ls=class extends U{create(e,t,r){return this._client.post(`/vector_stores/${e}/files`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,t={},r){return pe(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,or,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t,r);return await this.poll(e,s.id,r)}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,t,{...r,headers:s}).withResponse(),a=i.data;switch(a.status){case"in_progress":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const l=i.response.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await hn(o);break;case"failed":case"completed":return a}}}async upload(e,t,r){const s=await this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,t,r){const s=await this.upload(e,t,r);return await this.poll(e,s.id,r)}};class or extends Me{}Ls.VectorStoreFilesPage=or;class ul extends U{create(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t);return await this.poll(e,s.id,r)}listFiles(e,t,r={},s){return pe(r)?this.listFiles(e,t,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,or,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,t,{...r,headers:s}).withResponse();switch(i.status){case"in_progress":let o=5e3;if(r!=null&&r.pollIntervalMs)o=r.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await hn(o);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:t,fileIds:r=[]},s){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(s==null?void 0:s.maxConcurrency)??5,a=Math.min(i,t.length),o=this._client,l=t.values(),c=[...r];async function d(h){for(let m of h){const f=await o.files.create({file:m,purpose:"assistants"},s);c.push(f.id)}}const u=Array(a).fill(l).map(d);return await ld(u),await this.createAndPoll(e,{file_ids:c})}}class Lt extends U{constructor(){super(...arguments),this.files=new Ls(this._client),this.fileBatches=new ul(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/vector_stores/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return pe(e)?this.list({},e):this._client.getAPIList("/vector_stores",$s,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class $s extends Me{}Lt.VectorStoresPage=$s;Lt.Files=Ls;Lt.VectorStoreFilesPage=or;Lt.FileBatches=ul;let Ze=class extends U{constructor(){super(...arguments),this.realtime=new Ts(this._client),this.vectorStores=new Lt(this._client),this.chat=new ll(this._client),this.assistants=new xs(this._client),this.threads=new Bt(this._client)}};Ze.Realtime=Ts;Ze.VectorStores=Lt;Ze.VectorStoresPage=$s;Ze.Assistants=xs;Ze.AssistantsPage=vs;Ze.Threads=Bt;let fl=class extends U{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}};class dl extends U{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}class Ds extends U{create(e,t){return this._client.post("/files",It({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return pe(e)?this.list({},e):this._client.getAPIList("/files",js,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let a=await this.retrieve(e);for(;!a.status||!s.has(a.status);)if(await hn(t),a=await this.retrieve(e),Date.now()-i>r)throw new Rs({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return a}}class js extends Me{}Ds.FileObjectsPage=js;class Us extends U{list(e,t={},r){return pe(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,qs,{query:t,...r})}}class qs extends Me{}Us.FineTuningJobCheckpointsPage=qs;class $t extends U{constructor(){super(...arguments),this.checkpoints=new Us(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return pe(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Hs,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return pe(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Ws,{query:t,...r})}}class Hs extends Me{}class Ws extends Me{}$t.FineTuningJobsPage=Hs;$t.FineTuningJobEventsPage=Ws;$t.Checkpoints=Us;$t.FineTuningJobCheckpointsPage=qs;class _n extends U{constructor(){super(...arguments),this.jobs=new $t(this._client)}}_n.Jobs=$t;_n.FineTuningJobsPage=Hs;_n.FineTuningJobEventsPage=Ws;class hl extends U{createVariation(e,t){return this._client.post("/images/variations",It({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",It({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}let Js=class extends U{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Vs,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}};class Vs extends Gf{}Js.ModelsPage=Vs;class ml extends U{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class pl extends U{create(e,t,r){return this._client.post(`/uploads/${e}/parts`,It({body:t,...r}))}}class Xs extends U{constructor(){super(...arguments),this.parts=new pl(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,r){return this._client.post(`/uploads/${e}/complete`,{body:t,...r})}}Xs.Parts=pl;var gl;class $ extends Lf{constructor({baseURL:e=Sn("OPENAI_BASE_URL"),apiKey:t=Sn("OPENAI_API_KEY"),organization:r=Sn("OPENAI_ORG_ID")??null,project:s=Sn("OPENAI_PROJECT_ID")??null,...i}={}){if(t===void 0)throw new L("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:t,organization:r,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&zf())throw new L(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new fl(this),this.chat=new ks(this),this.embeddings=new dl(this),this.files=new Ds(this),this.images=new hl(this),this.audio=new mn(this),this.moderations=new ml(this),this.models=new Js(this),this.fineTuning=new _n(this),this.beta=new Ze(this),this.batches=new Ps(this),this.uploads=new Xs(this),this._options=a,this.apiKey=t,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return bf(e,{arrayFormat:"brackets"})}}gl=$;$.OpenAI=gl;$.DEFAULT_TIMEOUT=6e5;$.OpenAIError=L;$.APIError=me;$.APIConnectionError=sr;$.APIConnectionTimeoutError=Rs;$.APIUserAbortError=xe;$.NotFoundError=yo;$.ConflictError=wo;$.RateLimitError=So;$.BadRequestError=po;$.AuthenticationError=go;$.InternalServerError=Eo;$.PermissionDeniedError=_o;$.UnprocessableEntityError=bo;$.toFile=xo;$.fileFromPath=ho;$.Completions=fl;$.Chat=ks;$.Embeddings=dl;$.Files=Ds;$.FileObjectsPage=js;$.Images=hl;$.Audio=mn;$.Moderations=ml;$.Models=Js;$.ModelsPage=Vs;$.FineTuning=_n;$.Beta=Ze;$.Batches=Ps;$.BatchesPage=Cs;$.Uploads=Xs;const Et="0.33.1";let zi=!1,sn,_l,us,yl,wl,bl;function cd(n,e={auto:!1}){if(zi)throw new Error(`you must \`import '@anthropic-ai/sdk/shims/${n.kind}'\` before importing anything else from @anthropic-ai/sdk`);if(sn)throw new Error(`can't \`import '@anthropic-ai/sdk/shims/${n.kind}'\` after \`import '@anthropic-ai/sdk/shims/${sn}'\``);zi=e.auto,sn=n.kind,_l=n.fetch,us=n.File,yl=n.ReadableStream,wl=n.getDefaultAgent,bl=n.fileFromPath}class ud{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function fd({manuallyImported:n}={}){const e=n?"You may need to use polyfills":"Add one of these imports before your first `import … from '@anthropic-ai/sdk'`:\n- `import '@anthropic-ai/sdk/shims/node'` (if you're running on Node)\n- `import '@anthropic-ai/sdk/shims/web'` (otherwise)\n";let t,r,s,i;try{t=fetch,r=Request,s=Response,i=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:t,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new ud(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/anthropics/anthropic-sdk-typescript#file-uploads")},isFsReadStream:a=>!1}}sn||cd(fd(),{auto:!0});class z extends Error{}class le extends z{constructor(e,t,r,s){super(`${le.makeMessage(e,t,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["request-id"],this.error=t}static makeMessage(e,t,r){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,r,s){if(!e||!s)return new lr({message:r,cause:fs(t)});const i=t;return e===400?new El(e,i,r,s):e===401?new Al(e,i,r,s):e===403?new Rl(e,i,r,s):e===404?new kl(e,i,r,s):e===409?new Pl(e,i,r,s):e===422?new Cl(e,i,r,s):e===429?new xl(e,i,r,s):e>=500?new vl(e,i,r,s):new le(e,i,r,s)}}class at extends le{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class lr extends le{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Sl extends lr{constructor({message:e}={}){super({message:e??"Request timed out."})}}class El extends le{}class Al extends le{}class Rl extends le{}class kl extends le{}class Pl extends le{}class Cl extends le{}class xl extends le{}class vl extends le{}class Ye{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const r=Ye.NEWLINE_CHARS.has(t[t.length-1]||"");let s=t.split(Ye.NEWLINE_REGEXP);return r&&s.pop(),s.length===1&&!r?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),r||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new z(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new z(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new z("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Ye.NEWLINE_CHARS=new Set([`
`,"\r"]);Ye.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class ze{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const a of dd(e,t)){if(a.event==="completion")try{yield JSON.parse(a.data)}catch(o){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),o}if(a.event==="message_start"||a.event==="message_delta"||a.event==="message_stop"||a.event==="content_block_start"||a.event==="content_block_delta"||a.event==="content_block_stop")try{yield JSON.parse(a.data)}catch(o){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),o}if(a.event!=="ping"&&a.event==="error")throw le.generate(void 0,`SSE Error: ${a.data}`,a.data,Ml(e.headers))}i=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{i||t.abort()}}return new ze(s,t)}static fromReadableStream(e,t){let r=!1;async function*s(){const a=new Ye,o=zs(e);for await(const l of o)for(const c of a.decode(l))yield c;for(const l of a.flush())yield l}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(const o of s())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||t.abort()}}return new ze(i,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const a=r.next();e.push(a),t.push(a)}return i.shift()}});return[new ze(()=>s(e),this.controller),new ze(()=>s(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new yl({async start(){t=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:a}=await t.next();if(a)return s.close();const o=r.encode(JSON.stringify(i)+`
`);s.enqueue(o)}catch(i){s.error(i)}},async cancel(){var s;await((s=t.return)==null?void 0:s.call(t))}})}}async function*dd(n,e){if(!n.body)throw e.abort(),new z("Attempted to iterate over a response with no body");const t=new pd,r=new Ye,s=zs(n.body);for await(const i of hd(s))for(const a of r.decode(i)){const o=t.decode(a);o&&(yield o)}for(const i of r.flush()){const a=t.decode(i);a&&(yield a)}}async function*hd(n){let e=new Uint8Array;for await(const t of n){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=md(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}function md(n){for(let r=0;r<n.length-2;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}class pd{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,s]=gd(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function gd(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}function zs(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const _d=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function",yd=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&cr(n),cr=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function";async function wd(n,e,t){var s;if(n=await n,yd(n))return n;if(_d(n)){const i=await n.blob();e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=cr(i)?[await i.arrayBuffer()]:[i];return new us(a,e,t)}const r=await bd(n);if(e||(e=Ed(n)??"unknown_file"),!(t!=null&&t.type)){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(t={...t,type:i})}return new us(r,e,t)}async function bd(n){var t;let e=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)e.push(n);else if(cr(n))e.push(await n.arrayBuffer());else if(Ad(n))for await(const r of n)e.push(r);else throw new Error(`Unexpected data type: ${typeof n}; constructor: ${(t=n==null?void 0:n.constructor)==null?void 0:t.name}; props: ${Sd(n)}`);return e}function Sd(n){return`[${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}function Ed(n){var e;return Mr(n.name)||Mr(n.filename)||((e=Mr(n.path))==null?void 0:e.split(/[\\/]/).pop())}const Mr=n=>{if(typeof n=="string")return n;if(typeof Buffer<"u"&&n instanceof Buffer)return String(n)},Ad=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function",Ki=n=>n&&typeof n=="object"&&n.body&&n[Symbol.toStringTag]==="MultipartBody";var Rd=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},kd=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},kn;async function Ol(n){const{response:e}=n;if(n.options.stream)return Tt("response",e.status,e.url,e.headers,e.body),n.options.__streamClass?n.options.__streamClass.fromSSEResponse(e,n.controller):ze.fromSSEResponse(e,n.controller);if(e.status===204)return null;if(n.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const i=await e.json();return Tt("response",e.status,e.url,e.headers,i),Tl(i,e)}const s=await e.text();return Tt("response",e.status,e.url,e.headers,s),s}function Tl(n,e){return!n||typeof n!="object"||Array.isArray(n)?n:Object.defineProperty(n,"_request_id",{value:e.headers.get("request-id"),enumerable:!1})}class ur extends Promise{constructor(e,t=Ol){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new ur(this.responsePromise,async t=>Tl(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Pd{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=Ir("maxRetries",t),this.timeout=Ir("timeout",r),this.httpAgent=s,this.fetch=i??_l}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Md(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Ld()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&cr(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:t,...s,body:i}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var p;const{method:r,path:s,query:i,headers:a={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:Ki(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(o),c=this.buildURL(s,i);"timeout"in e&&Ir("timeout",e.timeout);const d=e.timeout??this.timeout,u=e.httpAgent??this.httpAgent??wl(c),h=d+1e3;typeof((p=u==null?void 0:u.options)==null?void 0:p.timeout)=="number"&&h>(u.options.timeout??0)&&(u.options.timeout=h),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const m=this.buildHeaders({options:e,headers:a,contentLength:l,retryCount:t});return{req:{method:r,...o&&{body:o},headers:m,...u&&{agent:u},signal:e.signal??null},url:c,timeout:d}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:s}){const i={};r&&(i["content-length"]=r);const a=this.defaultHeaders(e);return Zi(i,a),Zi(i,t),Ki(e.body)&&sn!=="node"&&delete i["content-type"],ea(a,"x-stainless-retry-count")===void 0&&ea(t,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),this.validateHeaders(i,t),i}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,r,s){return le.generate(e,t,r,s)}request(e,t=null){return new ur(this.makeRequest(e,t))}async makeRequest(e,t){var u,h;const r=await e,s=r.maxRetries??this.maxRetries;t==null&&(t=s),await this.prepareOptions(r);const{req:i,url:a,timeout:o}=this.buildRequest(r,{retryCount:s-t});if(await this.prepareRequest(i,{url:a,options:r}),Tt("request",a,r,i.headers),(u=r.signal)!=null&&u.aborted)throw new at;const l=new AbortController,c=await this.fetchWithTimeout(a,i,o,l).catch(fs);if(c instanceof Error){if((h=r.signal)!=null&&h.aborted)throw new at;if(t)return this.retryRequest(r,t);throw c.name==="AbortError"?new Sl:new lr({cause:c})}const d=Ml(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const g=`retrying, ${t} attempts remaining`;return Tt(`response (error; ${g})`,c.status,a,d),this.retryRequest(r,t,d)}const m=await c.text().catch(g=>fs(g).message),f=Id(m),p=f?void 0:m;throw Tt(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,a,d,p),this.makeStatusError(c.status,f,p,d)}return{response:c,options:r,controller:l}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new xd(this,r,e)}buildURL(e,t){const r=Nd(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return Gn(s)||(t={...s,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new z(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,s){const{signal:i,...a}=t||{};i&&i.addEventListener("abort",()=>s.abort());const o=setTimeout(()=>s.abort(),r);return this.fetch.call(void 0,e,{signal:s.signal,...a}).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(s=o)}const a=r==null?void 0:r["retry-after"];if(a&&!s){const o=parseFloat(a);Number.isNaN(o)?s=Date.parse(a)-Date.now():s=o*1e3}if(!(s&&0<=s&&s<60*1e3)){const o=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,o)}return await Bd(s),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const i=t-e,a=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Et}`}}class Cd{constructor(e,t,r,s){kn.set(this,void 0),Rd(this,kn,e,"f"),this.options=s,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new z("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);t.query=void 0,t.path=e.url.toString()}return await kd(this,kn,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(kn=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class xd extends ur{constructor(e,t,r){super(t,async s=>new r(e,s.response,await Ol(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const Ml=n=>new Proxy(Object.fromEntries(n.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),vd={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},ot=n=>typeof n=="object"&&n!==null&&!Gn(n)&&Object.keys(n).every(e=>Il(vd,e)),Od=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Et,"X-Stainless-OS":Qi(Deno.build.os),"X-Stainless-Arch":Gi(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Et,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Et,"X-Stainless-OS":Qi(process.platform),"X-Stainless-Arch":Gi(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const n=Td();return n?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Et,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${n.browser}`,"X-Stainless-Runtime-Version":n.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Et,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Td(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const r=t.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,a=r[3]||0;return{browser:e,version:`${s}.${i}.${a}`}}}return null}const Gi=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",Qi=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Yi;const Md=()=>Yi??(Yi=Od()),Id=n=>{try{return JSON.parse(n)}catch{return}},Fd=/^[a-z][a-z0-9+.-]*:/i,Nd=n=>Fd.test(n),Bd=n=>new Promise(e=>setTimeout(e,n)),Ir=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new z(`${n} must be an integer`);if(e<0)throw new z(`${n} must be a positive integer`);return e},fs=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null)try{return new Error(JSON.stringify(n))}catch{}return new Error(String(n))},Fr=n=>{var e,t,r,s,i;if(typeof process<"u")return((t=(e=process.env)==null?void 0:e[n])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(i=(s=(r=Deno.env)==null?void 0:r.get)==null?void 0:s.call(r,n))==null?void 0:i.trim()};function Gn(n){if(!n)return!0;for(const e in n)return!1;return!0}function Il(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Zi(n,e){for(const t in e){if(!Il(e,t))continue;const r=t.toLowerCase();if(!r)continue;const s=e[t];s===null?delete n[r]:s!==void 0&&(n[r]=s)}}function Tt(n,...e){var t;typeof process<"u"&&((t=process==null?void 0:process.env)==null?void 0:t.DEBUG)==="true"&&console.log(`Anthropic:DEBUG:${n}`,...e)}const Ld=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)}),$d=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Dd=n=>typeof(n==null?void 0:n.get)=="function",ea=(n,e)=>{var r;const t=e.toLowerCase();if(Dd(n)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,a,o)=>a+o.toUpperCase());for(const i of[e,t,e.toUpperCase(),s]){const a=n.get(i);if(a)return a}}for(const[s,i]of Object.entries(n))if(s.toLowerCase()===t)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i};class fr extends Cd{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.has_more=r.has_more||!1,this.first_id=r.first_id||null,this.last_id=r.last_id||null}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var t;if((t=this.options.query)!=null&&t.before_id){const r=this.first_id;return r?{params:{before_id:r}}:null}const e=this.last_id;return e?{params:{after_id:e}}:null}}class et{constructor(e){this._client=e}}let Ks=class extends et{retrieve(e,t){return this._client.get(`/v1/models/${e}?beta=true`,t)}list(e={},t){return ot(e)?this.list({},e):this._client.getAPIList("/v1/models?beta=true",Gs,{query:e,...t})}};class Gs extends fr{}Ks.BetaModelInfosPage=Gs;class dr{constructor(e,t){this.iterator=e,this.controller=t}async*decoder(){const e=new Ye;for await(const t of this.iterator)for(const r of e.decode(t))yield JSON.parse(r);for(const t of e.flush())yield JSON.parse(t)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(e,t){if(!e.body)throw t.abort(),new z("Attempted to iterate over a response with no body");return new dr(zs(e.body),t)}}let Qs=class extends et{create(e,t){const{betas:r,...s}=e;return this._client.post("/v1/messages/batches?beta=true",{body:s,...t,headers:{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),...t==null?void 0:t.headers}})}retrieve(e,t={},r){if(ot(t))return this.retrieve(e,{},t);const{betas:s}=t;return this._client.get(`/v1/messages/batches/${e}?beta=true`,{...r,headers:{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString(),...r==null?void 0:r.headers}})}list(e={},t){if(ot(e))return this.list({},e);const{betas:r,...s}=e;return this._client.getAPIList("/v1/messages/batches?beta=true",Ys,{query:s,...t,headers:{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),...t==null?void 0:t.headers}})}cancel(e,t={},r){if(ot(t))return this.cancel(e,{},t);const{betas:s}=t;return this._client.post(`/v1/messages/batches/${e}/cancel?beta=true`,{...r,headers:{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString(),...r==null?void 0:r.headers}})}async results(e,t={},r){if(ot(t))return this.results(e,{},t);const s=await this.retrieve(e);if(!s.results_url)throw new z(`No batch \`results_url\`; Has it finished processing? ${s.processing_status} - ${s.id}`);const{betas:i}=t;return this._client.get(s.results_url,{...r,headers:{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString(),...r==null?void 0:r.headers},__binaryResponse:!0})._thenUnwrap((a,o)=>dr.fromResponse(o.response,o.controller))}};class Ys extends fr{}Qs.BetaMessageBatchesPage=Ys;let hr=class extends et{constructor(){super(...arguments),this.batches=new Qs(this._client)}create(e,t){const{betas:r,...s}=e;return this._client.post("/v1/messages?beta=true",{body:s,timeout:this._client._options.timeout??6e5,...t,headers:{...(r==null?void 0:r.toString())!=null?{"anthropic-beta":r==null?void 0:r.toString()}:void 0,...t==null?void 0:t.headers},stream:e.stream??!1})}countTokens(e,t){const{betas:r,...s}=e;return this._client.post("/v1/messages/count_tokens?beta=true",{body:s,...t,headers:{"anthropic-beta":[...r??[],"token-counting-2024-11-01"].toString(),...t==null?void 0:t.headers}})}};hr.Batches=Qs;hr.BetaMessageBatchesPage=Ys;class yn extends et{constructor(){super(...arguments),this.models=new Ks(this._client),this.messages=new hr(this._client)}}yn.Models=Ks;yn.BetaModelInfosPage=Gs;yn.Messages=hr;class Fl extends et{create(e,t){return this._client.post("/v1/complete",{body:e,timeout:this._client._options.timeout??6e5,...t,stream:e.stream??!1})}}class Zs extends et{create(e,t){return this._client.post("/v1/messages/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/v1/messages/batches/${e}`,t)}list(e={},t){return ot(e)?this.list({},e):this._client.getAPIList("/v1/messages/batches",ei,{query:e,...t})}cancel(e,t){return this._client.post(`/v1/messages/batches/${e}/cancel`,t)}async results(e,t){const r=await this.retrieve(e);if(!r.results_url)throw new z(`No batch \`results_url\`; Has it finished processing? ${r.processing_status} - ${r.id}`);return this._client.get(r.results_url,{...t,__binaryResponse:!0})._thenUnwrap((s,i)=>dr.fromResponse(i.response,i.controller))}}class ei extends fr{}Zs.MessageBatchesPage=ei;const jd=n=>{let e=0,t=[];for(;e<n.length;){let r=n[e];if(r==="\\"){e++;continue}if(r==="{"){t.push({type:"brace",value:"{"}),e++;continue}if(r==="}"){t.push({type:"brace",value:"}"}),e++;continue}if(r==="["){t.push({type:"paren",value:"["}),e++;continue}if(r==="]"){t.push({type:"paren",value:"]"}),e++;continue}if(r===":"){t.push({type:"separator",value:":"}),e++;continue}if(r===","){t.push({type:"delimiter",value:","}),e++;continue}if(r==='"'){let o="",l=!1;for(r=n[++e];r!=='"';){if(e===n.length){l=!0;break}if(r==="\\"){if(e++,e===n.length){l=!0;break}o+=r+n[e],r=n[++e]}else o+=r,r=n[++e]}r=n[++e],l||t.push({type:"string",value:o});continue}if(r&&/\s/.test(r)){e++;continue}let i=/[0-9]/;if(r&&i.test(r)||r==="-"||r==="."){let o="";for(r==="-"&&(o+=r,r=n[++e]);r&&i.test(r)||r===".";)o+=r,r=n[++e];t.push({type:"number",value:o});continue}let a=/[a-z]/i;if(r&&a.test(r)){let o="";for(;r&&a.test(r)&&e!==n.length;)o+=r,r=n[++e];if(o=="true"||o=="false"||o==="null")t.push({type:"name",value:o});else{e++;continue}continue}e++}return t},At=n=>{if(n.length===0)return n;let e=n[n.length-1];switch(e.type){case"separator":return n=n.slice(0,n.length-1),At(n);case"number":let t=e.value[e.value.length-1];if(t==="."||t==="-")return n=n.slice(0,n.length-1),At(n);case"string":let r=n[n.length-2];if((r==null?void 0:r.type)==="delimiter")return n=n.slice(0,n.length-1),At(n);if((r==null?void 0:r.type)==="brace"&&r.value==="{")return n=n.slice(0,n.length-1),At(n);break;case"delimiter":return n=n.slice(0,n.length-1),At(n)}return n},Ud=n=>{let e=[];return n.map(t=>{t.type==="brace"&&(t.value==="{"?e.push("}"):e.splice(e.lastIndexOf("}"),1)),t.type==="paren"&&(t.value==="["?e.push("]"):e.splice(e.lastIndexOf("]"),1))}),e.length>0&&e.reverse().map(t=>{t==="}"?n.push({type:"brace",value:"}"}):t==="]"&&n.push({type:"paren",value:"]"})}),n},qd=n=>{let e="";return n.map(t=>{switch(t.type){case"string":e+='"'+t.value+'"';break;default:e+=t.value;break}}),e},Hd=n=>JSON.parse(qd(Ud(At(jd(n)))));var fe=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},B=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},be,Xe,Pn,Cn,Wt,Jt,xn,Vt,Ue,Xt,vn,On,yt,Nr,ta,Br,Lr,$r,Dr,na;const ra="__json_buf";class Qn{constructor(){be.add(this),this.messages=[],this.receivedMessages=[],Xe.set(this,void 0),this.controller=new AbortController,Pn.set(this,void 0),Cn.set(this,()=>{}),Wt.set(this,()=>{}),Jt.set(this,void 0),xn.set(this,()=>{}),Vt.set(this,()=>{}),Ue.set(this,{}),Xt.set(this,!1),vn.set(this,!1),On.set(this,!1),yt.set(this,!1),Br.set(this,e=>{if(fe(this,vn,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new at),e instanceof at)return fe(this,On,!0,"f"),this._emit("abort",e);if(e instanceof z)return this._emit("error",e);if(e instanceof Error){const t=new z(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new z(String(e)))}),fe(this,Pn,new Promise((e,t)=>{fe(this,Cn,e,"f"),fe(this,Wt,t,"f")}),"f"),fe(this,Jt,new Promise((e,t)=>{fe(this,xn,e,"f"),fe(this,Vt,t,"f")}),"f"),B(this,Pn,"f").catch(()=>{}),B(this,Jt,"f").catch(()=>{})}static fromReadableStream(e){const t=new Qn;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,r){const s=new Qn;for(const i of t.messages)s._addMessageParam(i);return s._run(()=>s._createMessage(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},B(this,Br,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,r){var a;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),B(this,be,"m",Lr).call(this);const i=await e.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const o of i)B(this,be,"m",$r).call(this,o);if((a=i.controller.signal)!=null&&a.aborted)throw new at;B(this,be,"m",Dr).call(this)}_connected(){this.ended||(B(this,Cn,"f").call(this),this._emit("connect"))}get ended(){return B(this,Xt,"f")}get errored(){return B(this,vn,"f")}get aborted(){return B(this,On,"f")}abort(){this.controller.abort()}on(e,t){return(B(this,Ue,"f")[e]||(B(this,Ue,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=B(this,Ue,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===t);return s>=0&&r.splice(s,1),this}once(e,t){return(B(this,Ue,"f")[e]||(B(this,Ue,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{fe(this,yt,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){fe(this,yt,!0,"f"),await B(this,Jt,"f")}get currentMessage(){return B(this,Xe,"f")}async finalMessage(){return await this.done(),B(this,be,"m",Nr).call(this)}async finalText(){return await this.done(),B(this,be,"m",ta).call(this)}_emit(e,...t){if(B(this,Xt,"f"))return;e==="end"&&(fe(this,Xt,!0,"f"),B(this,xn,"f").call(this));const r=B(this,Ue,"f")[e];if(r&&(B(this,Ue,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...t))),e==="abort"){const s=t[0];!B(this,yt,"f")&&!(r!=null&&r.length)&&Promise.reject(s),B(this,Wt,"f").call(this,s),B(this,Vt,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=t[0];!B(this,yt,"f")&&!(r!=null&&r.length)&&Promise.reject(s),B(this,Wt,"f").call(this,s),B(this,Vt,"f").call(this,s),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",B(this,be,"m",Nr).call(this))}async _fromReadableStream(e,t){var i;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),B(this,be,"m",Lr).call(this),this._connected();const s=ze.fromReadableStream(e,this.controller);for await(const a of s)B(this,be,"m",$r).call(this,a);if((i=s.controller.signal)!=null&&i.aborted)throw new at;B(this,be,"m",Dr).call(this)}[(Xe=new WeakMap,Pn=new WeakMap,Cn=new WeakMap,Wt=new WeakMap,Jt=new WeakMap,xn=new WeakMap,Vt=new WeakMap,Ue=new WeakMap,Xt=new WeakMap,vn=new WeakMap,On=new WeakMap,yt=new WeakMap,Br=new WeakMap,be=new WeakSet,Nr=function(){if(this.receivedMessages.length===0)throw new z("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},ta=function(){if(this.receivedMessages.length===0)throw new z("stream ended without producing a Message with role=assistant");const t=this.receivedMessages.at(-1).content.filter(r=>r.type==="text").map(r=>r.text);if(t.length===0)throw new z("stream ended without producing a content block with type=text");return t.join(" ")},Lr=function(){this.ended||fe(this,Xe,void 0,"f")},$r=function(t){if(this.ended)return;const r=B(this,be,"m",na).call(this,t);switch(this._emit("streamEvent",t,r),t.type){case"content_block_delta":{const s=r.content.at(-1);t.delta.type==="text_delta"&&s.type==="text"?this._emit("text",t.delta.text,s.text||""):t.delta.type==="input_json_delta"&&s.type==="tool_use"&&s.input&&this._emit("inputJson",t.delta.partial_json,s.input);break}case"message_stop":{this._addMessageParam(r),this._addMessage(r,!0);break}case"content_block_stop":{this._emit("contentBlock",r.content.at(-1));break}case"message_start":{fe(this,Xe,r,"f");break}}},Dr=function(){if(this.ended)throw new z("stream has ended, this shouldn't happen");const t=B(this,Xe,"f");if(!t)throw new z("request ended without sending any chunks");return fe(this,Xe,void 0,"f"),t},na=function(t){let r=B(this,Xe,"f");if(t.type==="message_start"){if(r)throw new z(`Unexpected event order, got ${t.type} before receiving "message_stop"`);return t.message}if(!r)throw new z(`Unexpected event order, got ${t.type} before "message_start"`);switch(t.type){case"message_stop":return r;case"message_delta":return r.stop_reason=t.delta.stop_reason,r.stop_sequence=t.delta.stop_sequence,r.usage.output_tokens=t.usage.output_tokens,r;case"content_block_start":return r.content.push(t.content_block),r;case"content_block_delta":{const s=r.content.at(t.index);if((s==null?void 0:s.type)==="text"&&t.delta.type==="text_delta")s.text+=t.delta.text;else if((s==null?void 0:s.type)==="tool_use"&&t.delta.type==="input_json_delta"){let i=s[ra]||"";i+=t.delta.partial_json,Object.defineProperty(s,ra,{value:i,enumerable:!1,writable:!0}),i&&(s.input=Hd(i))}return r}case"content_block_stop":return r}},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("streamEvent",s=>{const i=t.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const i of t)i.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,a)=>t.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ze(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class mr extends et{constructor(){super(...arguments),this.batches=new Zs(this._client)}create(e,t){return e.model in sa&&console.warn(`The model '${e.model}' is deprecated and will reach end-of-life on ${sa[e.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`),this._client.post("/v1/messages",{body:e,timeout:this._client._options.timeout??6e5,...t,stream:e.stream??!1})}stream(e,t){return Qn.createMessage(this,e,t)}countTokens(e,t){return this._client.post("/v1/messages/count_tokens",{body:e,...t})}}const sa={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024"};mr.Batches=Zs;mr.MessageBatchesPage=ei;class ti extends et{retrieve(e,t){return this._client.get(`/v1/models/${e}`,t)}list(e={},t){return ot(e)?this.list({},e):this._client.getAPIList("/v1/models",ni,{query:e,...t})}}class ni extends fr{}ti.ModelInfosPage=ni;var Nl;class V extends Pd{constructor({baseURL:e=Fr("ANTHROPIC_BASE_URL"),apiKey:t=Fr("ANTHROPIC_API_KEY")??null,authToken:r=Fr("ANTHROPIC_AUTH_TOKEN")??null,...s}={}){const i={apiKey:t,authToken:r,...s,baseURL:e||"https://api.anthropic.com"};if(!i.dangerouslyAllowBrowser&&$d())throw new z(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Anthropic({ apiKey, dangerouslyAllowBrowser: true });
`);super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new Fl(this),this.messages=new mr(this),this.models=new ti(this),this.beta=new yn(this),this._options=i,this.apiKey=t,this.authToken=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01",...this._options.defaultHeaders}}validateHeaders(e,t){if(!(this.apiKey&&e["x-api-key"])&&t["x-api-key"]!==null&&!(this.authToken&&e.authorization)&&t.authorization!==null)throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}authHeaders(e){const t=this.apiKeyAuth(e),r=this.bearerAuth(e);return t!=null&&!Gn(t)?t:r!=null&&!Gn(r)?r:{}}apiKeyAuth(e){return this.apiKey==null?{}:{"X-Api-Key":this.apiKey}}bearerAuth(e){return this.authToken==null?{}:{Authorization:`Bearer ${this.authToken}`}}}Nl=V;V.Anthropic=Nl;V.HUMAN_PROMPT=`

Human:`;V.AI_PROMPT=`

Assistant:`;V.DEFAULT_TIMEOUT=6e5;V.AnthropicError=z;V.APIError=le;V.APIConnectionError=lr;V.APIConnectionTimeoutError=Sl;V.APIUserAbortError=at;V.NotFoundError=kl;V.ConflictError=Pl;V.RateLimitError=xl;V.BadRequestError=El;V.AuthenticationError=Al;V.InternalServerError=vl;V.PermissionDeniedError=Rl;V.UnprocessableEntityError=Cl;V.toFile=wd;V.fileFromPath=bl;V.Completions=Fl;V.Messages=mr;V.Models=ti;V.ModelInfosPage=ni;V.Beta=yn;function ia(n){let e,t,r,s,i,a,o=n[8]&&aa();return{c(){e=C("div"),t=C("div"),r=ie(n[7]),s=O(),o&&o.c(),x(t,"max-height","250px"),x(t,"overflow-y","auto"),x(t,"margin-top","10px"),x(t,"white-space","pre-wrap"),x(t,"line-height","1.3"),x(t,"scrollbar-width","thin"),x(e,"width","94%"),x(e,"padding","3%"),x(e,"align-self","center"),x(e,"background","var(--b3-card-background)")},m(l,c){J(l,e,c),y(e,t),y(t,r),n[14](t),y(e,s),o&&o.m(e,null),a=!0},p(l,c){(!a||c&128)&&Oe(r,l[7]),l[8]?o||(o=aa(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},i(l){a||(l&&We(()=>{a&&(i||(i=Ke(e,Qe,{duration:200},!0)),i.run(1))}),a=!0)},o(l){l&&(i||(i=Ke(e,Qe,{duration:200},!1)),i.run(0)),a=!1},d(l){l&&q(e),n[14](null),o&&o.d(),l&&i&&i.end()}}}function aa(n){let e;return{c(){e=C("div"),e.innerHTML='<span style="color: var(--b3-theme-primary);">生成中...</span>',x(e,"width","100%"),x(e,"text-align","center"),x(e,"border-top","1px solid var(--b3-border-color)")},m(t,r){J(t,e,r)},d(t){t&&q(e)}}}function oa(n){let e,t,r;return t=new ro({props:{group:"custom",settingStorage:n[0],display:!0}}),t.$on("changed",n[22]),{c(){e=C("div"),Ce(t.$$.fragment),x(e,"margin-top","10px"),x(e,"padding","10px"),x(e,"background","none"),x(e,"border-radius","4px"),x(e,"border","1px solid var(--b3-border-color)")},m(s,i){J(s,e,i),Se(t,e,null),r=!0},p(s,i){const a={};i&1&&(a.settingStorage=s[0]),t.$set(a)},i(s){r||(j(t.$$.fragment,s),r=!0)},o(s){W(t.$$.fragment,s),r=!1},d(s){s&&q(e),Ee(t)}}}function Wd(n){let e,t,r,s,i,a,o,l,c,d,u,h,m,f,p,_,k,g=n[6]&&ia(n);function E(P){n[19](P)}let b={type:"select",key:"modelSelections",fnSize:!1,options:n[0].get("modelSelections").options,style:"margin-right: 5px;font-size: 12px; padding: 2px 4px; border-radius: 4px; border: 1px solid #ddd; height: 2em; background: transparent;"};n[5]!==void 0&&(b.value=n[5]),a=new Ta({props:b}),Mt.push(()=>Oa(a,"value",E)),a.$on("changed",n[20]);let R=n[4]&&oa(n);return{c(){e=C("div"),g&&g.c(),t=O(),r=C("div"),s=C("input"),i=O(),Ce(a.$$.fragment),l=O(),c=C("button"),c.textContent="超参数",d=O(),u=C("button"),u.innerHTML='<svg width="20" height="20" viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" class="svelte-sx9euk"></path></svg>',m=O(),f=C("div"),R&&R.c(),A(s,"type","text"),A(s,"placeholder","输入 AI 指令... "),A(s,"class",".b3-text-field fn__block fn__flex-center"),x(s,"width","calc(100% - 120px)"),x(s,"height","3em"),x(s,"white-space","normal"),x(s,"background","transparent"),x(s,"border","0"),x(s,"outline","none"),x(s,"margin-left","0.5em"),A(c,"type","button"),A(c,"class","ai-instruction-params-button svelte-sx9euk"),x(c,"font-size","12px"),x(c,"color","#666"),x(c,"text-decoration","none"),x(c,"background","none"),x(c,"border","none"),x(c,"padding","0"),x(c,"cursor","pointer"),x(c,"margin-right","35px"),x(c,"white-space","nowrap"),A(u,"type","button"),A(u,"class","ai-instruction-submit-button svelte-sx9euk"),x(u,"position","absolute"),x(u,"right","10px"),x(u,"top","50%"),x(u,"transform","translateY(-50%)"),x(u,"opacity","0.6"),x(u,"cursor","pointer"),x(u,"background","none"),x(u,"border","none"),x(u,"padding","0"),x(r,"width","100%"),x(r,"height","100%"),x(r,"display","flex"),x(r,"position","relative"),x(r,"align-items","center"),x(f,"width","100%"),x(e,"width","100%")},m(P,S){J(P,e,S),g&&g.m(e,null),y(e,t),y(e,r),y(r,s),n[15](s),ne(s,n[1]),y(r,i),Se(a,r,null),y(r,l),y(r,c),y(r,d),y(r,u),y(e,m),y(e,f),R&&R.m(f,null),p=!0,_||(k=[D(s,"input",n[16]),D(s,"keydown",n[11]),D(s,"focus",n[17]),D(s,"blur",n[18]),D(c,"click",n[21]),D(u,"click",n[10]),D(u,"keydown",n[11])],_=!0)},p(P,[S]){P[6]?g?(g.p(P,S),S&64&&j(g,1)):(g=ia(P),g.c(),j(g,1),g.m(e,t)):g&&(ct(),W(g,1,1,()=>{g=null}),ut()),S&2&&s.value!==P[1]&&ne(s,P[1]);const M={};S&1&&(M.options=P[0].get("modelSelections").options),!o&&S&32&&(o=!0,M.value=P[5],Pa(()=>o=!1)),a.$set(M),P[4]?R?(R.p(P,S),S&16&&j(R,1)):(R=oa(P),R.c(),j(R,1),R.m(f,null)):R&&(ct(),W(R,1,1,()=>{R=null}),ut())},i(P){p||(j(g),j(a.$$.fragment,P),P&&We(()=>{p&&(h||(h=Ke(r,Qe,{duration:200},!0)),h.run(1))}),j(R),p=!0)},o(P){W(g),W(a.$$.fragment,P),P&&(h||(h=Ke(r,Qe,{duration:200},!1)),h.run(0)),W(R),p=!1},d(P){P&&q(e),g&&g.d(),n[15](null),Ee(a),P&&h&&h.end(),R&&R.d(),_=!1,re(k)}}}function Jd(n,e,t){let{openai:r}=e,{claude:s}=e,{settingStorage:i}=e,a="",o=!1,l,c=!1,d=i.getValue("modelSelections"),u=!1,h="",m=!1,f;function p(){const v=fc();let Q=[];if(v.trim())Q.push({role:"user",content:`文本:${v}

指令:${a}`});else if(i.getValue("isPageContent")){const{title:X,content:ce}=dc();Q.push({role:"user",content:`标题:${X}

内容:${ce}

${a}`})}else Q.push({role:"user",content:`${a}`});k(r,s,d,i,Q)}function _(v){v.key==="Enter"?p():v.key==="Escape"&&console.debug("ai指令取消")}async function k(v,Q,X,ce,Je){var dt,Dt,ht,jt,mt,Ut;t(6,u=!0),t(8,m=!0),t(7,h="");try{if(X.includes("claude")){const tt=await Q.messages.stream({model:X,max_tokens:(dt=ce.get("maxOutputLength"))==null?void 0:dt.value,messages:Je});for await(const Ae of tt)if(Ae.type==="content_block_delta"){const nt="text"in Ae.delta?Ae.delta.text:Ae.delta.toString();t(7,h+=nt),f&&t(9,f.scrollTop=f.scrollHeight,f)}return}const we=await v.chat.completions.create({model:X,max_tokens:(Dt=ce.get("maxOutputLength"))==null?void 0:Dt.value,temperature:(ht=ce.get("temperature"))==null?void 0:ht.value,stream:!0,messages:Je});for await(const tt of we)if((Ut=(mt=(jt=tt.choices)==null?void 0:jt[0])==null?void 0:mt.delta)!=null&&Ut.content){const Ae=tt.choices[0].delta.content;t(7,h+=Ae),f&&t(9,f.scrollTop=f.scrollHeight,f)}}catch(we){console.error("生成回答时出错:",we),t(7,h+=`
生成回答时出错: `+we.message)}finally{await navigator.clipboard.writeText(h),pa("生成内容已自动复制到剪贴板"),t(8,m=!1)}}ws(()=>{l.focus()});function g(v){Mt[v?"unshift":"push"](()=>{f=v,t(9,f)})}function E(v){Mt[v?"unshift":"push"](()=>{l=v,t(3,l)})}function b(){a=this.value,t(1,a)}const R=()=>t(2,o=!0),P=()=>t(2,o=!1);function S(v){d=v,t(5,d)}const M=({detail:v})=>{i.setValue(v.key,v.value),i.save()},I=()=>{t(4,c=!c),c&&i.save()},N=({detail:v})=>{i.setValue(v.key,v.value),i.save()};return n.$$set=v=>{"openai"in v&&t(12,r=v.openai),"claude"in v&&t(13,s=v.claude),"settingStorage"in v&&t(0,i=v.settingStorage)},[i,a,o,l,c,d,u,h,m,f,p,_,r,s,g,E,b,R,P,S,M,I,N]}class Vd extends De{constructor(e){super(),$e(this,e,Jd,Wd,Le,{openai:12,claude:13,settingStorage:0})}}function Xd(n,e,t){const r=new Rt.Dialog({title:"",content:'<div id="ai-instruction""></div>',width:"40%",hideCloseIcon:!0});new Vd({target:r.element.querySelector("#ai-instruction"),props:{openai:e,claude:t,settingStorage:n}})}function zd(n){let e,t,r,s,i,a=[{type:"button"},n[4],{class:r=["b3-button",n[3],n[2]].join(" ")},{style:n[1]}],o={};for(let l=0;l<a.length;l+=1)o=Un(o,a[l]);return{c(){e=C("button"),t=ie(n[0]),ii(e,o)},m(l,c){J(l,e,c),y(e,t),e.autofocus&&e.focus(),s||(i=D(e,"click",n[8]),s=!0)},p(l,[c]){c&1&&Kl(t,l[0],o.contenteditable),ii(e,o=lc(a,[{type:"button"},c&16&&l[4],c&12&&r!==(r=["b3-button",l[3],l[2]].join(" "))&&{class:r},c&2&&{style:l[1]}]))},i:ue,o:ue,d(l){l&&q(e),s=!1,i()}}}function Kd(n,e,t){let r,s,i,{text:a=!1}=e,{outline:o=!1}=e,{backgroundColor:l=void 0}=e,{label:c=""}=e;function d(u){tc.call(this,n,u)}return n.$$set=u=>{t(4,e=Un(Un({},e),si(u))),"text"in u&&t(5,a=u.text),"outline"in u&&t(6,o=u.outline),"backgroundColor"in u&&t(7,l=u.backgroundColor),"label"in u&&t(0,c=u.label)},n.$$.update=()=>{n.$$.dirty&64&&t(3,r=o?"b3-button--outline":""),n.$$.dirty&32&&t(2,s=a?"b3-button--text":""),n.$$.dirty&128&&t(1,i=l?`background-color: ${l}`:"")},e=si(e),[c,i,s,r,e,a,o,l,d]}class la extends De{constructor(e){super(),$e(this,e,Kd,zd,Le,{text:5,outline:6,backgroundColor:7,label:0})}}function Gd(n){let e,t,r,s,i,a,o,l,c,d,u,h,m,f,p,_,k,g,E,b,R,P,S;return{c(){e=C("div"),t=C("h2"),t.textContent="token",r=O(),s=C("p"),s.textContent=`token
        是模型用来表示自然语言文本的基本单位，可以直观的理解为“字”或“词”；通常 1
        个中文词语、1 个英文单词、1 个数字或 1 个符号计为 1 个 token。`,i=O(),a=C("h2"),a.textContent="Temperature 设置",o=O(),l=C("p"),l.innerHTML=`​<span data-type="code">temperature</span>​ 参数默认为
        1.0。建议您根据如下表格，按使用场景设置
        <span data-type="code">temperature</span>​。`,c=O(),d=C("table"),d.innerHTML="<thead><tr><th>场景</th> <th>温度</th></tr></thead> <tbody><tr><td>代码生成/数学解题</td> <td>0.0</td></tr> <tr><td>数据抽取/分析</td> <td>1.0</td></tr> <tr><td>通用对话</td> <td>1.3</td></tr> <tr><td>翻译</td> <td>1.3</td></tr> <tr><td>创意类写作/诗歌创作</td> <td>1.5</td></tr></tbody>",u=O(),h=C("h2"),h.textContent="model",m=O(),f=C("p"),f.textContent="扣减费用 = token 消耗量 × 模型单价，对应的费用将直接余额中进行扣减。",p=O(),_=C("table"),_.innerHTML='<thead><tr><th>模型</th> <th>上下文长度</th> <th>最大输出长度</th> <th>输入价格<br/></th> <th>输出价格</th></tr></thead> <tbody><tr><td><span data-type="strong">deepseek-chat</span></td> <td>64K</td> <td>8K</td> <td>1元/百万tokens</td> <td>2元/百万tokens</td></tr> <tr><td>qwen-max</td> <td>32,768</td> <td>8,192</td> <td>20元/百万tokens</td> <td>60元/百万tokens</td></tr> <tr><td>qwen-plus</td> <td>129,024</td> <td>8,192</td> <td>0.8元/百万tokens</td> <td>2元/百万tokens</td></tr> <tr><td>qwen-turbo</td> <td>1,000,000</td> <td>8,192</td> <td>0.3元/百万tokens</td> <td>0.6元/百万tokens</td></tr> <tr><td>qwen-long</td> <td>10,000,000</td> <td>6,000</td> <td>0.25元/百万tokens</td> <td>1元/百万tokens</td></tr> <tr><td><span data-type="s">gpt-3.5-turbo</span></td> <td></td> <td></td> <td><span data-type="s">6元/百万tokens</span></td> <td><span data-type="s">18元/百万tokens</span></td></tr> <tr><td>gpt-4o-mini</td> <td></td> <td></td> <td>1.8元/百万tokens</td> <td>7.2元/百万tokens</td></tr> <tr><td>gpt-4o</td> <td></td> <td></td> <td>30元/百万tokens</td> <td>120元/百万tokens</td></tr> <tr><td><span data-type="strong text" style="color: var(--b3-font-color8);">gpt-4-turbo</span></td> <td></td> <td></td> <td>120元/百万tokens</td> <td>360元/百万tokens</td></tr> <tr><td>claude-3-5-haiku</td> <td></td> <td></td> <td>12元/百万tokens</td> <td>60元/百万tokens</td></tr> <tr><td>claude-3-5-sonnet</td> <td></td> <td></td> <td>36元/百万tokens</td> <td>180元/百万tokens</td></tr> <tr><td><span data-type="strong text" style="color: var(--b3-font-color8);">claude-3-opus</span></td> <td></td> <td></td> <td>180元/百万tokens</td> <td>900元/百万tokens</td></tr> <tr><td>gemini-1.5-flash</td> <td></td> <td></td> <td>0.896元/百万tokens</td> <td>3.6元/百万tokens</td></tr> <tr><td>gemini-1.5-pro</td> <td></td> <td></td> <td>15元/百万tokens</td> <td>60元/百万tokens</td></tr></tbody>',k=O(),g=C("h3"),g.textContent="排行榜",E=O(),b=C("p"),b.innerHTML='<a href="https://www.datalearner.com/ai-models/leaderboard/datalearner-llm-leaderboard">大模型综合能力排行榜</a>',R=O(),P=C("p"),P.innerHTML='<a href="https://www.datalearner.com/ai-models/leaderboard/datalearner-llm-coding-leaderboard#google_vignette">大模型编程能力排行榜</a>',A(e,"class",S="b3-typography "+n[0]),x(e,"margin","10px auto"),x(e,"max-height","80vh"),x(e,"overflow-y","auto"),x(e,"width","95%"),x(e,"max-width","1200px")},m(M,I){J(M,e,I),y(e,t),y(e,r),y(e,s),y(e,i),y(e,a),y(e,o),y(e,l),y(e,c),y(e,d),y(e,u),y(e,h),y(e,m),y(e,f),y(e,p),y(e,_),y(e,k),y(e,g),y(e,E),y(e,b),y(e,R),y(e,P)},p(M,[I]){I&1&&S!==(S="b3-typography "+M[0])&&A(e,"class",S)},i:ue,o:ue,d(M){M&&q(e)}}}function Qd(n,e,t){let r,{display:s=!0}=e;return n.$$set=i=>{"display"in i&&t(1,s=i.display)},n.$$.update=()=>{n.$$.dirty&2&&t(0,r=s?"":"fn__none")},[r,s]}let Yd=class extends De{constructor(e){super(),$e(this,e,Qd,Gd,Le,{display:1})}};function Zd(n){let e,t,r,s,i,a,o,l,c,d,u,h,m,f,p,_,k,g,E,b,R,P,S,M,I,N,v,Q,X,ce,Je,dt,Dt,ht,jt,mt,Ut,we,tt,Ae;return{c(){e=C("div"),t=C("h1"),t.textContent="功能介绍",r=O(),s=C("h2"),s.textContent="指令模式",i=O(),a=C("p"),a.textContent="快捷键：option + command + k",o=O(),l=C("div"),l.innerHTML='<img src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/yyy.jpg" alt=""/>',c=O(),d=C("h3"),d.textContent="设置超参数",u=O(),h=C("div"),h.innerHTML='<img src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/xx.jpg" alt=""/>',m=O(),f=C("h3"),f.textContent="选择模型",p=O(),_=C("div"),_.innerHTML='<img src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/WechatIMG252.jpg" alt=""/>',k=O(),g=C("h3"),g.textContent="无中生有",E=O(),b=C("p"),b.textContent="当前文档中没有写入任何内容，直接通过指令让大模型帮助生成内容。",R=O(),P=C("div"),P.innerHTML=`<video controls="" src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/%E6%97%A0%E4%B8%AD%E7%94%9F%E6%9C%89.mp4" data-src=""><track kind="captions" label="中文字幕" src="" default=""/>
            不支持视频播放。</video>`,S=O(),M=C("h3"),M.textContent="修改润色",I=O(),N=C("div"),N.innerHTML=`<video controls="" src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/%E6%80%BB%E7%BB%93%E6%96%87%E6%A1%A3.mp4" data-src=""><track kind="captions" label="中文字幕" src="" default=""/>
            不支持视频播放。</video>`,v=O(),Q=C("h3"),Q.textContent="扩写",X=O(),ce=C("div"),ce.innerHTML=`<video controls="" src="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/%E6%89%A9%E5%86%99.mp4" data-src=""><track kind="captions" label="中文字幕" src="" default=""/>
            不支持视频播放。</video>`,Je=O(),dt=C("h2"),dt.textContent="聊天模式",Dt=O(),ht=C("p"),ht.textContent="开发中...",jt=O(),mt=C("h2"),mt.textContent="来提意见",Ut=O(),we=C("img"),A(a,"id","20250116161508-2ifhw0n"),A(l,"class","iframe"),A(h,"class","iframe"),A(_,"class","iframe"),A(P,"class","iframe"),A(N,"class","iframe"),A(ce,"class","iframe"),Dl(we.src,tt="https://pub-a4fc15e05e5b45ae93e81825f01bfb69.r2.dev/file-repository/files/%E5%BD%92%E6%A1%A3_1737019531739/WechatIMG6765.jpg")||A(we,"src",tt),A(we,"alt",""),x(we,"width","50%"),x(we,"height","auto"),A(e,"class",Ae="b3-typography "+n[0]),x(e,"max-width","800px"),x(e,"margin","0 auto")},m(nt,pr){J(nt,e,pr),y(e,t),y(e,r),y(e,s),y(e,i),y(e,a),y(e,o),y(e,l),y(e,c),y(e,d),y(e,u),y(e,h),y(e,m),y(e,f),y(e,p),y(e,_),y(e,k),y(e,g),y(e,E),y(e,b),y(e,R),y(e,P),y(e,S),y(e,M),y(e,I),y(e,N),y(e,v),y(e,Q),y(e,X),y(e,ce),y(e,Je),y(e,dt),y(e,Dt),y(e,ht),y(e,jt),y(e,mt),y(e,Ut),y(e,we)},p(nt,[pr]){pr&1&&Ae!==(Ae="b3-typography "+nt[0])&&A(e,"class",Ae)},i:ue,o:ue,d(nt){nt&&q(e)}}}function eh(n,e,t){let r,{display:s=!0}=e;return n.$$set=i=>{"display"in i&&t(1,s=i.display)},n.$$.update=()=>{n.$$.dirty&2&&t(0,r=s?"":"fn__none")},[r,s]}let th=class extends De{constructor(e){super(),$e(this,e,eh,Zd,Le,{display:1})}};function ca(n,e,t){const r=n.slice();return r[17]=e[t],r}function ua(n,e){let t,r,s,i=e[17].title+"",a,o,l,c=(e[17].content.length>50?e[17].content.slice(0,50)+"...":e[17].content)+"",d,u,h,m,f,p,_,k;function g(){return e[12](e[17])}function E(){return e[13](e[17])}return{key:n,first:null,c(){t=C("div"),r=C("div"),s=C("h3"),a=ie(i),o=O(),l=C("p"),d=ie(c),u=O(),h=C("button"),h.textContent="删除",m=O(),A(s,"class","svelte-pscmju"),A(l,"class","svelte-pscmju"),A(r,"class","content svelte-pscmju"),A(h,"class","delete-btn svelte-pscmju"),A(t,"class","prompt-item svelte-pscmju"),this.first=t},m(b,R){J(b,t,R),y(t,r),y(r,s),y(s,a),y(r,o),y(r,l),y(l,d),y(t,u),y(t,h),y(t,m),p=!0,_||(k=[D(r,"click",g),D(h,"click",E)],_=!0)},p(b,R){e=b,(!p||R&16)&&i!==(i=e[17].title+"")&&Oe(a,i),(!p||R&16)&&c!==(c=(e[17].content.length>50?e[17].content.slice(0,50)+"...":e[17].content)+"")&&Oe(d,c)},i(b){p||(b&&We(()=>{p&&(f||(f=Ke(t,Qe,{},!0)),f.run(1))}),p=!0)},o(b){b&&(f||(f=Ke(t,Qe,{},!1)),f.run(0)),p=!1},d(b){b&&q(t),b&&f&&f.end(),_=!1,re(k)}}}function fa(n){let e,t,r,s=n[2].id?"编辑提示词":"新增提示词",i,a,o,l,c,d,u,h,m,f,p,_,k,g;return{c(){e=C("div"),t=C("div"),r=C("h2"),i=ie(s),a=O(),o=C("input"),l=O(),c=C("textarea"),d=O(),u=C("div"),h=C("button"),h.textContent="取消",m=O(),f=C("button"),f.textContent="保存",A(o,"type","text"),A(o,"placeholder","标题"),A(o,"class","svelte-pscmju"),A(c,"placeholder","内容"),A(c,"class","svelte-pscmju"),A(h,"class","svelte-pscmju"),A(f,"class","svelte-pscmju"),A(u,"class","buttons svelte-pscmju"),A(t,"class","edit-content svelte-pscmju"),A(e,"class","edit-panel svelte-pscmju")},m(E,b){J(E,e,b),y(e,t),y(t,r),y(r,i),y(t,a),y(t,o),ne(o,n[2].title),y(t,l),y(t,c),ne(c,n[2].content),y(t,d),y(t,u),y(u,h),y(u,m),y(u,f),_=!0,k||(g=[D(o,"input",n[14]),D(c,"input",n[15]),D(h,"click",n[16]),D(f,"click",n[6])],k=!0)},p(E,b){(!_||b&4)&&s!==(s=E[2].id?"编辑提示词":"新增提示词")&&Oe(i,s),b&4&&o.value!==E[2].title&&ne(o,E[2].title),b&4&&ne(c,E[2].content)},i(E){_||(E&&We(()=>{_&&(p||(p=Ke(e,Qe,{},!0)),p.run(1))}),_=!0)},o(E){E&&(p||(p=Ke(e,Qe,{},!1)),p.run(0)),_=!1},d(E){E&&q(e),E&&p&&p.end(),k=!1,re(g)}}}function nh(n){let e,t,r,s,i,a,o,l=[],c=new Map,d,u,h,m,f,p=Ge(n[4]);const _=g=>g[17].id;for(let g=0;g<p.length;g+=1){let E=ca(n,p,g),b=_(E);c.set(b,l[g]=ua(b,E))}let k=n[1]&&fa(n);return{c(){e=C("div"),t=C("div"),r=C("input"),s=O(),i=C("button"),i.textContent="+",a=O(),o=C("div");for(let g=0;g<l.length;g+=1)l[g].c();d=O(),k&&k.c(),A(r,"type","text"),A(r,"placeholder","搜索提示词..."),A(r,"class","svelte-pscmju"),A(i,"class","svelte-pscmju"),A(t,"class","search-bar svelte-pscmju"),A(o,"class","prompt-list svelte-pscmju"),A(e,"class",u="b3-typography "+n[3]+" svelte-pscmju")},m(g,E){J(g,e,E),y(e,t),y(t,r),ne(r,n[0]),y(t,s),y(t,i),y(e,a),y(e,o);for(let b=0;b<l.length;b+=1)l[b]&&l[b].m(o,null);y(e,d),k&&k.m(e,null),h=!0,m||(f=[D(r,"input",n[10]),D(i,"click",n[11])],m=!0)},p(g,[E]){E&1&&r.value!==g[0]&&ne(r,g[0]),E&176&&(p=Ge(g[4]),ct(),l=va(l,E,_,1,g,p,c,o,xa,ua,null,ca),ut()),g[1]?k?(k.p(g,E),E&2&&j(k,1)):(k=fa(g),k.c(),j(k,1),k.m(e,null)):k&&(ct(),W(k,1,1,()=>{k=null}),ut()),(!h||E&8&&u!==(u="b3-typography "+g[3]+" svelte-pscmju"))&&A(e,"class",u)},i(g){if(!h){for(let E=0;E<p.length;E+=1)j(l[E]);j(k),h=!0}},o(g){for(let E=0;E<l.length;E+=1)W(l[E]);W(k),h=!1},d(g){g&&q(e);for(let E=0;E<l.length;E+=1)l[E].d();k&&k.d(),m=!1,re(f)}}}function rh(n,e,t){let r,s,{display:i=!1}=e,a=[],o="",l=!1,c={id:"",title:"",content:""};function d(b){b?t(2,c={...b}):t(2,c={id:crypto.randomUUID(),title:"",content:""}),t(1,l=!0)}function u(){const b=a.findIndex(R=>R.id===c.id);b===-1?t(9,a=[...a,c]):(t(9,a[b]=c,a),t(9,a=[...a])),t(1,l=!1)}function h(b){t(9,a=a.filter(R=>R.id!==b))}console.log("PromptPanel mounted"),ws(()=>{console.log("PromptPanel mounted")});function m(){o=this.value,t(0,o)}const f=()=>d(),p=b=>d(b),_=b=>h(b.id);function k(){c.title=this.value,t(2,c)}function g(){c.content=this.value,t(2,c)}const E=()=>t(1,l=!1);return n.$$set=b=>{"display"in b&&t(8,i=b.display)},n.$$.update=()=>{n.$$.dirty&513&&t(4,r=a.filter(b=>b.title.toLowerCase().includes(o.toLowerCase())||b.content.toLowerCase().includes(o.toLowerCase()))),n.$$.dirty&256&&t(3,s=i?"":"fn__none")},[o,l,c,s,r,d,u,h,i,a,m,f,p,_,k,g,E]}let sh=class extends De{constructor(e){super(),$e(this,e,rh,nh,Le,{display:8})}};function da(n,e,t){const r=n.slice();return r[8]=e[t],r}function ha(n){let e,t,r,s,i;function a(){return n[4](n[8])}return{c(){e=C("li"),t=C("span"),t.textContent=`${n[8]}`,r=O(),A(t,"class","b3-list-item__text"),A(e,"data-name","editor"),A(e,"class","b3-list-item"),G(e,"b3-list-item--focus",n[8]===n[2])},m(o,l){J(o,e,l),y(e,t),y(e,r),s||(i=[D(e,"click",a),D(e,"keydown",ah)],s=!0)},p(o,l){n=o,l&12&&G(e,"b3-list-item--focus",n[8]===n[2])},d(o){o&&q(e),s=!1,re(i)}}}function ih(n){let e,t,r,s,i,a,o,l,c,d,u,h,m,f,p,_,k,g,E,b,R=Ge(n[3]),P=[];for(let S=0;S<R.length;S+=1)P[S]=ha(da(n,R,S));return i=new ro({props:{group:n[3][0],settingStorage:n[0],display:n[2]===n[3][0]}}),i.$on("changed",n[5]),o=new sh({props:{display:n[2]===n[3][1]}}),c=new Yd({props:{display:n[2]===n[3][2]}}),u=new th({props:{display:n[2]===n[3][3]}}),f=new la({props:{label:"取消",text:!0,outline:!0}}),f.$on("click",n[6]),g=new la({props:{label:"确认",text:!1,outline:!1}}),g.$on("click",n[7]),{c(){e=C("div"),t=C("ul");for(let S=0;S<P.length;S+=1)P[S].c();r=O(),s=C("div"),Ce(i.$$.fragment),a=O(),Ce(o.$$.fragment),l=O(),Ce(c.$$.fragment),d=O(),Ce(u.$$.fragment),h=O(),m=C("div"),Ce(f.$$.fragment),p=O(),_=C("div"),k=O(),Ce(g.$$.fragment),A(t,"class","b3-tab-bar b3-list b3-list--background"),A(_,"class","fn__space"),A(m,"class",E="b3-dialog__action "+(n[2]==n[3][0]?"":"fn__none")),A(s,"class","config__tab-wrap"),A(e,"class","fn__flex-1 fn__flex config__panel")},m(S,M){J(S,e,M),y(e,t);for(let I=0;I<P.length;I+=1)P[I]&&P[I].m(t,null);y(e,r),y(e,s),Se(i,s,null),y(s,a),Se(o,s,null),y(s,l),Se(c,s,null),y(s,d),Se(u,s,null),y(s,h),y(s,m),Se(f,m,null),y(m,p),y(m,_),y(m,k),Se(g,m,null),b=!0},p(S,[M]){if(M&12){R=Ge(S[3]);let X;for(X=0;X<R.length;X+=1){const ce=da(S,R,X);P[X]?P[X].p(ce,M):(P[X]=ha(ce),P[X].c(),P[X].m(t,null))}for(;X<P.length;X+=1)P[X].d(1);P.length=R.length}const I={};M&1&&(I.settingStorage=S[0]),M&4&&(I.display=S[2]===S[3][0]),i.$set(I);const N={};M&4&&(N.display=S[2]===S[3][1]),o.$set(N);const v={};M&4&&(v.display=S[2]===S[3][2]),c.$set(v);const Q={};M&4&&(Q.display=S[2]===S[3][3]),u.$set(Q),(!b||M&4&&E!==(E="b3-dialog__action "+(S[2]==S[3][0]?"":"fn__none")))&&A(m,"class",E)},i(S){b||(j(i.$$.fragment,S),j(o.$$.fragment,S),j(c.$$.fragment,S),j(u.$$.fragment,S),j(f.$$.fragment,S),j(g.$$.fragment,S),b=!0)},o(S){W(i.$$.fragment,S),W(o.$$.fragment,S),W(c.$$.fragment,S),W(u.$$.fragment,S),W(f.$$.fragment,S),W(g.$$.fragment,S),b=!1},d(S){S&&q(e),Ea(P,S),Ee(i),Ee(o),Ee(c),Ee(u),Ee(f),Ee(g)}}}const ah=()=>{};function oh(n,e,t){let r=["🌈 设置","💡 prompt","💬 公告","✨ 功能"],s=r[0],{settingStorage:i}=e,{dialog:a}=e;const o=u=>{t(2,s=u)},l=({detail:u})=>{i.setValue(u.key,u.value)},c=()=>{i.load(),a.destroy()},d=()=>{i.save(),a.destroy()};return n.$$set=u=>{"settingStorage"in u&&t(0,i=u.settingStorage),"dialog"in u&&t(1,a=u.dialog)},[i,a,s,r,o,l,c,d]}class lh extends De{constructor(e){super(),$e(this,e,oh,ih,Le,{settingStorage:0,dialog:1})}}const ch=`<symbol id="iconFace" viewBox="0 0 32 32">
<path d="M13.667 17.333c0 0.92-0.747 1.667-1.667 1.667s-1.667-0.747-1.667-1.667 0.747-1.667 1.667-1.667 1.667 0.747 1.667 1.667zM20 15.667c-0.92 0-1.667 0.747-1.667 1.667s0.747 1.667 1.667 1.667 1.667-0.747 1.667-1.667-0.747-1.667-1.667-1.667zM29.333 16c0 7.36-5.973 13.333-13.333 13.333s-13.333-5.973-13.333-13.333 5.973-13.333 13.333-13.333 13.333 5.973 13.333 13.333zM14.213 5.493c1.867 3.093 5.253 5.173 9.12 5.173 0.613 0 1.213-0.067 1.787-0.16-1.867-3.093-5.253-5.173-9.12-5.173-0.613 0-1.213 0.067-1.787 0.16zM5.893 12.627c2.28-1.293 4.040-3.4 4.88-5.92-2.28 1.293-4.040 3.4-4.88 5.92zM26.667 16c0-1.040-0.16-2.040-0.44-2.987-0.933 0.2-1.893 0.32-2.893 0.32-4.173 0-7.893-1.92-10.347-4.92-1.4 3.413-4.187 6.093-7.653 7.4 0.013 0.053 0 0.12 0 0.187 0 5.88 4.787 10.667 10.667 10.667s10.667-4.787 10.667-10.667z"></path>
</symbol>`,uh=`<symbol id="iconSaving" viewBox="0 0 32 32">
<path d="M20 13.333c0-0.733 0.6-1.333 1.333-1.333s1.333 0.6 1.333 1.333c0 0.733-0.6 1.333-1.333 1.333s-1.333-0.6-1.333-1.333zM10.667 12h6.667v-2.667h-6.667v2.667zM29.333 10v9.293l-3.76 1.253-2.24 7.453h-7.333v-2.667h-2.667v2.667h-7.333c0 0-3.333-11.28-3.333-15.333s3.28-7.333 7.333-7.333h6.667c1.213-1.613 3.147-2.667 5.333-2.667 1.107 0 2 0.893 2 2 0 0.28-0.053 0.533-0.16 0.773-0.187 0.453-0.347 0.973-0.427 1.533l3.027 3.027h2.893zM26.667 12.667h-1.333l-4.667-4.667c0-0.867 0.12-1.72 0.347-2.547-1.293 0.333-2.347 1.293-2.787 2.547h-8.227c-2.573 0-4.667 2.093-4.667 4.667 0 2.507 1.627 8.867 2.68 12.667h2.653v-2.667h8v2.667h2.68l2.067-6.867 3.253-1.093v-4.707z"></path>
</symbol>`;class fh extends Rt.Plugin{constructor(t){super(t);Re(this,"_isMobile");Re(this,"_settingStorage");Re(this,"_openai");Re(this,"_claude");this._settingStorage=new of(this,Kr),this._isMobile=Rt.getFrontend()==="mobile"||Rt.getFrontend()==="browser-mobile"}async onload(){console.log("onload...."),this._settingStorage.load().then(()=>{const t=this._settingStorage.getValue("apiKey");this._openai=new $({baseURL:`${ki}/v1`,apiKey:t,dangerouslyAllowBrowser:!0}),this._claude=new V({baseURL:`${ki}/claude`,apiKey:t,dangerouslyAllowBrowser:!0})}),this.addIcons(ch),this.addIcons(uh),this.addCommand({langKey:"getSelectedText",hotkey:"⌥⌘K",callback:()=>Xd(this._settingStorage,this._openai,this._claude)}),console.log("onload....end")}onLayoutReady(){}uninstall(){this.removeData(Kr),$l("数据已清除，思源AI插件卸载成功！")}openSetting(){if(!this._settingStorage)return;if(this._isMobile){pa("请在桌面端使用");return}let t=new Rt.Dialog({title:"思源AI设置",width:"70%",height:"60%",content:'<div class="b3-dialog__content" id="AISettingPanel" ></div>'});new lh({target:t.element.querySelector("#AISettingPanel"),props:{settingStorage:this._settingStorage,dialog:t}})}}module.exports=fh;
